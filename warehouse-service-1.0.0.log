{"level":"warn","ts":1687324683.1654809,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"info","ts":1687324683.165741,"caller":"server/server.go:47","msg":"http server started on http://localhost:80"}
{"level":"warn","ts":1687324727.8668869,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"info","ts":1687324727.867223,"caller":"server/server.go:47","msg":"http server started on http://localhost:80"}
{"level":"warn","ts":1687325201.5285828,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"info","ts":1687325201.5289102,"caller":"server/server.go:47","msg":"http server started on http://localhost:80"}
{"level":"warn","ts":1687325551.779408,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"info","ts":1687325551.779756,"caller":"server/server.go:47","msg":"http server started on http://localhost:80"}
{"level":"warn","ts":1687325690.5330749,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"info","ts":1687325690.533325,"caller":"server/server.go:47","msg":"http server started on http://localhost:80"}
{"level":"warn","ts":1687325707.031057,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"info","ts":1687325707.0312881,"caller":"server/server.go:47","msg":"http server started on http://localhost:80"}
{"level":"warn","ts":1687325860.3500328,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"info","ts":1687325860.350334,"caller":"server/server.go:47","msg":"http server started on http://localhost:80"}
{"level":"warn","ts":1687325996.8328261,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"info","ts":1687325996.83315,"caller":"server/server.go:47","msg":"http server started on http://localhost:80"}
{"level":"warn","ts":1687326034.980285,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"info","ts":1687326034.9805582,"caller":"server/server.go:47","msg":"http server started on http://localhost:80"}
{"level":"warn","ts":1687327655.331131,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"error","ts":1687327655.33142,"caller":"app/app.go:42","msg":"ERR_INIT_REPOSITORY","error":"sql: undefined data source name ","stacktrace":"warehouse-service/internal/app.Run\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/internal/app/app.go:42\nmain.main\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/main.go:8\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:250"}
{"level":"warn","ts":1687328781.879193,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"error","ts":1687328781.882082,"caller":"app/app.go:42","msg":"ERR_INIT_REPOSITORY","error":"dial tcp [::1]:5432: connect: connection refused","stacktrace":"warehouse-service/internal/app.Run\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/internal/app/app.go:42\nmain.main\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/main.go:8\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:250"}
{"level":"warn","ts":1687328827.656665,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"error","ts":1687328827.709973,"caller":"app/app.go:42","msg":"ERR_INIT_REPOSITORY","error":"pq: database \"database\" does not exist","stacktrace":"warehouse-service/internal/app.Run\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/internal/app/app.go:42\nmain.main\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/main.go:8\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:250"}
{"level":"warn","ts":1687328831.8535979,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"error","ts":1687328831.8892999,"caller":"app/app.go:42","msg":"ERR_INIT_REPOSITORY","error":"pq: database \"database\" does not exist","stacktrace":"warehouse-service/internal/app.Run\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/internal/app/app.go:42\nmain.main\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/main.go:8\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:250"}
{"level":"warn","ts":1687328922.265384,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"error","ts":1687328922.307538,"caller":"app/app.go:42","msg":"ERR_INIT_REPOSITORY","error":"pq: database \"database\" does not exist","stacktrace":"warehouse-service/internal/app.Run\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/internal/app/app.go:42\nmain.main\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/main.go:8\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:250"}
{"level":"warn","ts":1687329011.346576,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"error","ts":1687329011.370773,"caller":"app/app.go:42","msg":"ERR_INIT_REPOSITORY","error":"pq: database \"database\" does not exist","stacktrace":"warehouse-service/internal/app.Run\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/internal/app/app.go:42\nmain.main\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/main.go:8\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:250"}
{"level":"warn","ts":1687329335.380003,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"error","ts":1687329335.442741,"caller":"app/app.go:42","msg":"ERR_INIT_REPOSITORY","error":"pq: syntax error at or near \"-\"","stacktrace":"warehouse-service/internal/app.Run\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/internal/app/app.go:42\nmain.main\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/main.go:8\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:250"}
{"level":"warn","ts":1687329388.677851,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"error","ts":1687329416.282791,"caller":"app/app.go:42","msg":"ERR_INIT_REPOSITORY","error":"pq: syntax error at or near \"-\"","stacktrace":"warehouse-service/internal/app.Run\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/internal/app/app.go:42\nmain.main\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/main.go:8\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:250"}
{"level":"warn","ts":1687329431.175998,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"error","ts":1687329449.835278,"caller":"app/app.go:42","msg":"ERR_INIT_REPOSITORY","error":"pq: syntax error at or near \"-\"","stacktrace":"warehouse-service/internal/app.Run\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/internal/app/app.go:42\nmain.main\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/main.go:8\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:250"}
{"level":"warn","ts":1687329482.646025,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"error","ts":1687329482.8104692,"caller":"app/app.go:42","msg":"ERR_INIT_REPOSITORY","error":"migration failed: syntax error at or near \"rating\" (column 5) in line 34: -- EXTENSIONS --\n\nCREATE EXTENSION IF NOT EXISTS pgcrypto;\n\n-- TABLES --\n\nCREATE TABLE IF NOT EXISTS inventories (\n    id                  SERIAL PRIMARY KEY,\n    created_at          TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,\n    updated_at          TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,\n    inventory_id        VARCHAR NOT NULL UNIQUE,\n    product_id          VARCHAR NOT NULL,\n    merchant_id         VARCHAR NOT NULL,\n    store_id            VARCHAR NOT NULL,\n    quantity            VARCHAR NOT NULL,\n    quantity_min_step   NUMERIC NOT NULL,\n    weight_avg          NUMERIC NULL,\n    weight_min          NUMERIC NULL,\n    weight_max          NUMERIC NULL,\n    price_actual        NUMERIC NOT NULL,\n    price_special       NUMERIC NULL,\n    price_previous      NUMERIC NULL,\n    is_available        BOOLEAN NOT NULL DEFAULT TRUE\n);\n\nCREATE TABLE IF NOT EXISTS stores (\n    id                  SERIAL PRIMARY KEY,\n    created_at          TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,\n    updated_at          TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,\n    merchant_id         VARCHAR NOT NULL UNIQUE,\n    name                VARCHAR NOT NULL,\n    location            VARCHAR NOT NULL,\n    is_active BOOLEAN NOT NULL DEFAULT TRUE\n    rating              DECIMAL,\n    city_id VARCHAR(255),\n    schedule_id VARCHAR(255),\n    delivery_is_active BOOLEAN NOT NULL DEFAULT TRUE\n    delivery_currency_id VARCHAR(255),\n    currency_id VARCHAR(255),\n    PRIMARY KEY (id),\n    FOREIGN KEY (city_id) REFERENCES city(id),\n    FOREIGN KEY (schedule_id) REFERENCES schedule(id),\n    FOREIGN KEY (delivery_currency_id) REFERENCES currency(id),\n    FOREIGN KEY (currency_id) REFERENCES currency(id)\n\n);\n\n\n\nCREATE TABLE currency (\n  id VARCHAR(255),\n  sign VARCHAR(255),\n  decimal INT,\n  prefix BOOLEAN,\n  PRIMARY KEY (id)\n);\n\nCREATE TABLE delivery (\n  entity_id VARCHAR(255),\n  is_active BOOLEAN,\n  currency_id VARCHAR(255),\n  PRIMARY KEY (entity_id),\n  FOREIGN KEY (entity_id) REFERENCES entity(id),\n  FOREIGN KEY (currency_id) REFERENCES currency(id)\n);\n\nCREATE TABLE periods (\n  schedule_id VARCHAR(255),\n  day VARCHAR(255),\n  from_time VARCHAR(255),\n  to_time VARCHAR(255),\n  FOREIGN KEY (schedule_id) REFERENCES schedule(id)\n);\n\nCREATE TABLE city (\n  id VARCHAR(255),\n  name VARCHAR(255),\n  geo_center VARCHAR(255),\n  PRIMARY KEY (id)\n);\n\nCREATE TABLE schedule (\n  id VARCHAR(255),\n  is_active BOOLEAN,\n  PRIMARY KEY (id)\n);\n\n\n (details: pq: syntax error at or near \"rating\")","stacktrace":"warehouse-service/internal/app.Run\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/internal/app/app.go:42\nmain.main\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/main.go:8\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:250"}
{"level":"warn","ts":1687329552.1504269,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"error","ts":1687329552.239375,"caller":"app/app.go:42","msg":"ERR_INIT_REPOSITORY","error":"Dirty database version 1. Fix and force version.","stacktrace":"warehouse-service/internal/app.Run\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/internal/app/app.go:42\nmain.main\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/main.go:8\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:250"}
{"level":"warn","ts":1687329570.6823921,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"error","ts":1687329570.771841,"caller":"app/app.go:42","msg":"ERR_INIT_REPOSITORY","error":"Dirty database version 1. Fix and force version.","stacktrace":"warehouse-service/internal/app.Run\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/internal/app/app.go:42\nmain.main\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/main.go:8\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:250"}
{"level":"warn","ts":1687329876.716653,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"error","ts":1687329876.7951539,"caller":"app/app.go:42","msg":"ERR_INIT_REPOSITORY","error":"Dirty database version 1. Fix and force version.","stacktrace":"warehouse-service/internal/app.Run\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/internal/app/app.go:42\nmain.main\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/main.go:8\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:250"}
{"level":"warn","ts":1687330583.498027,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"error","ts":1687330583.583112,"caller":"app/app.go:42","msg":"ERR_INIT_REPOSITORY","error":"Dirty database version 1. Fix and force version.","stacktrace":"warehouse-service/internal/app.Run\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/internal/app/app.go:42\nmain.main\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/main.go:8\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:250"}
{"level":"warn","ts":1687330772.405123,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"error","ts":1687330772.495606,"caller":"app/app.go:42","msg":"ERR_INIT_REPOSITORY","error":"Dirty database version 1. Fix and force version.","stacktrace":"warehouse-service/internal/app.Run\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/internal/app/app.go:42\nmain.main\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/main.go:8\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:250"}
{"level":"warn","ts":1687330910.433429,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"error","ts":1687330910.550805,"caller":"app/app.go:42","msg":"ERR_INIT_REPOSITORY","error":"migration failed: syntax error at or near \"rating\" (column 5) in line 16: -- EXTENSIONS --\n\nCREATE EXTENSION IF NOT EXISTS pgcrypto;\n\n-- TABLES --\n\n\nCREATE TABLE IF NOT EXISTS stores (\n    id                  SERIAL PRIMARY KEY,\n    created_at          TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,\n    updated_at          TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,\n    merchant_id         VARCHAR NOT NULL UNIQUE,\n    name                VARCHAR NOT NULL,\n    location            VARCHAR NOT NULL,\n    is_active BOOLEAN NOT NULL DEFAULT TRUE\n    rating              DECIMAL,\n    city_id VARCHAR,\n    schedule_id VARCHAR,\n    delivery_is_active BOOLEAN NOT NULL DEFAULT TRUE\n    delivery_currency_id VARCHAR,\n    currency_id VARCHAR,\n    PRIMARY KEY (id),\n    FOREIGN KEY (city_id) REFERENCES city(id),\n    FOREIGN KEY (schedule_id) REFERENCES schedule(id),\n    FOREIGN KEY (delivery_currency_id) REFERENCES currency(id),\n    FOREIGN KEY (currency_id) REFERENCES currency(id)\n\n);\n\n\n\nCREATE TABLE currency (\n  id VARCHAR,\n  sign VARCHAR,\n  decimal INT,\n  prefix BOOLEAN NOT NULL DEFAULT TRUE,\n  PRIMARY KEY (id)\n);\n\nCREATE TABLE delivery (\n  entity_id VARCHAR,\n  is_active BOOLEAN NOT NULL DEFAULT TRUE,\n  currency_id VARCHAR,\n  PRIMARY KEY (entity_id),\n  FOREIGN KEY (entity_id) REFERENCES entity(id),\n  FOREIGN KEY (currency_id) REFERENCES currency(id)\n);\n\nCREATE TABLE periods (\n  schedule_id VARCHAR,\n  day VARCHAR,\n  from_time VARCHAR,\n  to_time VARCHAR,\n  FOREIGN KEY (schedule_id) REFERENCES schedule(id)\n);\n\nCREATE TABLE city (\n  id VARCHAR,\n  name VARCHAR,\n  geo_center VARCHAR,\n  PRIMARY KEY (id)\n);\n\nCREATE TABLE schedule (\n  id VARCHAR,\n  is_active BOOLEAN NOT NULL DEFAULT TRUE,\n  PRIMARY KEY (id)\n);\n\n\n (details: pq: syntax error at or near \"rating\")","stacktrace":"warehouse-service/internal/app.Run\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/internal/app/app.go:42\nmain.main\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/main.go:8\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:250"}
{"level":"warn","ts":1687330944.275261,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"error","ts":1687330944.376488,"caller":"app/app.go:42","msg":"ERR_INIT_REPOSITORY","error":"migration failed: syntax error at or near \"rating\" (column 5) in line 16: -- EXTENSIONS --\n\nCREATE EXTENSION IF NOT EXISTS pgcrypto;\n\n-- TABLES --\n\n\nCREATE TABLE IF NOT EXISTS stores (\n    id                  SERIAL PRIMARY KEY,\n    created_at          TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,\n    updated_at          TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,\n    merchant_id         VARCHAR NOT NULL UNIQUE,\n    name                VARCHAR NOT NULL,\n    location            VARCHAR NOT NULL,\n    is_active BOOLEAN NOT NULL DEFAULT TRUE\n    rating              DECIMAL,\n    city_id VARCHAR,\n    schedule_id VARCHAR,\n    delivery_is_active BOOLEAN NOT NULL DEFAULT TRUE\n    delivery_currency_id VARCHAR,\n    currency_id VARCHAR,\n    PRIMARY KEY (id),\n    FOREIGN KEY (city_id) REFERENCES city(id),\n    FOREIGN KEY (schedule_id) REFERENCES schedule(id),\n    FOREIGN KEY (delivery_currency_id) REFERENCES currency(id),\n    FOREIGN KEY (currency_id) REFERENCES currency(id)\n\n);\n\n\n\nCREATE TABLE currency (\n  id VARCHAR,\n  sign VARCHAR,\n  decimal INT,\n  prefix BOOLEAN NOT NULL DEFAULT TRUE,\n  PRIMARY KEY (id)\n);\n\nCREATE TABLE delivery (\n  entity_id VARCHAR,\n  is_active BOOLEAN NOT NULL DEFAULT TRUE,\n  currency_id VARCHAR,\n  PRIMARY KEY (entity_id),\n  FOREIGN KEY (entity_id) REFERENCES entity(id),\n  FOREIGN KEY (currency_id) REFERENCES currency(id)\n);\n\nCREATE TABLE periods (\n  schedule_id VARCHAR,\n  day VARCHAR,\n  from_time VARCHAR,\n  to_time VARCHAR,\n  FOREIGN KEY (schedule_id) REFERENCES schedule(id)\n);\n\nCREATE TABLE city (\n  id VARCHAR,\n  name VARCHAR,\n  geo_center VARCHAR,\n  PRIMARY KEY (id)\n);\n\nCREATE TABLE schedule (\n  id VARCHAR,\n  is_active BOOLEAN NOT NULL DEFAULT TRUE,\n  PRIMARY KEY (id)\n);\n\n\n (details: pq: syntax error at or near \"rating\")","stacktrace":"warehouse-service/internal/app.Run\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/internal/app/app.go:42\nmain.main\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/main.go:8\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:250"}
{"level":"warn","ts":1687330994.808137,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"error","ts":1687330994.903986,"caller":"app/app.go:42","msg":"ERR_INIT_REPOSITORY","error":"Dirty database version 1. Fix and force version.","stacktrace":"warehouse-service/internal/app.Run\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/internal/app/app.go:42\nmain.main\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/main.go:8\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:250"}
{"level":"warn","ts":1687331028.002769,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"error","ts":1687331028.093141,"caller":"app/app.go:42","msg":"ERR_INIT_REPOSITORY","error":"Dirty database version 1. Fix and force version.","stacktrace":"warehouse-service/internal/app.Run\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/internal/app/app.go:42\nmain.main\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/main.go:8\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:250"}
{"level":"warn","ts":1687331057.5416698,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"error","ts":1687331057.645138,"caller":"app/app.go:42","msg":"ERR_INIT_REPOSITORY","error":"migration failed: multiple primary keys for table \"stores\" are not allowed (column 5) in line 22: -- EXTENSIONS --\n\nCREATE EXTENSION IF NOT EXISTS pgcrypto;\n\n-- TABLES --\n\n\nCREATE TABLE IF NOT EXISTS stores (\n    id                  SERIAL PRIMARY KEY,\n    created_at          TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,\n    updated_at          TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,\n    merchant_id         VARCHAR NOT NULL UNIQUE,\n    name                VARCHAR NOT NULL,\n    location            VARCHAR NOT NULL,\n    is_active BOOLEAN   NOT NULL DEFAULT TRUE,\n    rating              DECIMAL,\n    city_id VARCHAR,\n    schedule_id VARCHAR,\n    delivery_is_active BOOLEAN NOT NULL DEFAULT TRUE,\n    delivery_currency_id VARCHAR,\n    currency_id VARCHAR,\n    PRIMARY KEY (id),\n    FOREIGN KEY (city_id) REFERENCES city(id),\n    FOREIGN KEY (schedule_id) REFERENCES schedule(id),\n    FOREIGN KEY (delivery_currency_id) REFERENCES currency(id),\n    FOREIGN KEY (currency_id) REFERENCES currency(id)\n\n);\n\n\n\nCREATE TABLE currency (\n  id VARCHAR,\n  sign VARCHAR,\n  decimal INT,\n  prefix BOOLEAN NOT NULL DEFAULT TRUE,\n  PRIMARY KEY (id)\n);\n\nCREATE TABLE delivery (\n  entity_id VARCHAR,\n  is_active BOOLEAN NOT NULL DEFAULT TRUE,\n  currency_id VARCHAR,\n  PRIMARY KEY (entity_id),\n  FOREIGN KEY (entity_id) REFERENCES entity(id),\n  FOREIGN KEY (currency_id) REFERENCES currency(id)\n);\n\nCREATE TABLE periods (\n  schedule_id VARCHAR,\n  day VARCHAR,\n  from_time VARCHAR,\n  to_time VARCHAR,\n  FOREIGN KEY (schedule_id) REFERENCES schedule(id)\n);\n\nCREATE TABLE city (\n  id VARCHAR,\n  name VARCHAR,\n  geo_center VARCHAR,\n  PRIMARY KEY (id)\n);\n\nCREATE TABLE schedule (\n  id VARCHAR,\n  is_active BOOLEAN NOT NULL DEFAULT TRUE,\n  PRIMARY KEY (id)\n);\n\n\n (details: pq: multiple primary keys for table \"stores\" are not allowed)","stacktrace":"warehouse-service/internal/app.Run\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/internal/app/app.go:42\nmain.main\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/main.go:8\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:250"}
{"level":"warn","ts":1687331620.503276,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"error","ts":1687331620.613788,"caller":"app/app.go:42","msg":"ERR_INIT_REPOSITORY","error":"migration failed: syntax error at or near \"VARCHAR\" (column 19) in line 55: -- EXTENSIONS --\n\nCREATE EXTENSION IF NOT EXISTS pgcrypto;\n\n-- TABLES --\n\n\nCREATE TABLE IF NOT EXISTS stores (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    merchant_id         VARCHAR NOT NULL UNIQUE,\n    name                VARCHAR NOT NULL,\n    location            VARCHAR NOT NULL,\n    is_active BOOLEAN   NOT NULL DEFAULT TRUE,\n    rating               DECIMAL,\n    city_id             VARCHAR NULL,\n    schedule_id         VARCHAR NULL,\n    delivery_is_active BOOLEAN NOT NULL DEFAULT TRUE,\n    delivery_currency_id VARCHAR NULL,\n    currency_id VARCHAR NULL,\n    FOREIGN KEY (city_id) REFERENCES city(id),\n    FOREIGN KEY (schedule_id) REFERENCES schedule(id),\n    FOREIGN KEY (delivery_currency_id) REFERENCES currency(id),\n    FOREIGN KEY (currency_id) REFERENCES currency(id)\n);\n\n\n\nCREATE TABLE currency (\n  created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n  updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n  id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n  sign VARCHAR NULL,\n  decimal VARCHAR NULL,\n  prefix BOOLEAN NOT NULL DEFAULT TRUE,\n  PRIMARY KEY (id)\n);\n\nCREATE TABLE delivery (\n  created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n  updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n  id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n  entity_id VARCHAR NULL,\n  is_active BOOLEAN NOT NULL DEFAULT TRUE,\n  currency_id VARCHAR NULL,\n  FOREIGN KEY (entity_id) REFERENCES entity(id),\n  FOREIGN KEY (currency_id) REFERENCES currency(id)\n);\n\nCREATE TABLE periods (\n  created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n  updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n  id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n  schedule     id VARCHAR NULL,\n  day VARCHAR NULL,\n  from_time VARCHAR NULL,\n  to_time VARCHAR NULL,\n  FOREIGN KEY (schedule_id) REFERENCES schedule(id)\n);\n\nCREATE TABLE city (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n  name VARCHAR NULL,\n  geo_center VARCHAR NULL,\n);\n\nCREATE TABLE schedule (\n  created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n  updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n  id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n  is_active BOOLEAN NOT NULL DEFAULT TRUE,\n);\n\n\n (details: pq: syntax error at or near \"VARCHAR\")","stacktrace":"warehouse-service/internal/app.Run\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/internal/app/app.go:42\nmain.main\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/main.go:8\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:250"}
{"level":"warn","ts":1687331660.3502421,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"error","ts":1687331660.444355,"caller":"app/app.go:42","msg":"ERR_INIT_REPOSITORY","error":"Dirty database version 1. Fix and force version.","stacktrace":"warehouse-service/internal/app.Run\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/internal/app/app.go:42\nmain.main\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/main.go:8\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:250"}
{"level":"warn","ts":1687331674.427603,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"error","ts":1687331674.52288,"caller":"app/app.go:42","msg":"ERR_INIT_REPOSITORY","error":"Dirty database version 1. Fix and force version.","stacktrace":"warehouse-service/internal/app.Run\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/internal/app/app.go:42\nmain.main\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/main.go:8\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:250"}
{"level":"warn","ts":1687336681.7844648,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"error","ts":1687336681.86732,"caller":"app/app.go:42","msg":"ERR_INIT_REPOSITORY","error":"Dirty database version 1. Fix and force version.","stacktrace":"warehouse-service/internal/app.Run\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/internal/app/app.go:42\nmain.main\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/main.go:8\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:250"}
{"level":"warn","ts":1687336683.92046,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"error","ts":1687336683.9892192,"caller":"app/app.go:42","msg":"ERR_INIT_REPOSITORY","error":"Dirty database version 1. Fix and force version.","stacktrace":"warehouse-service/internal/app.Run\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/internal/app/app.go:42\nmain.main\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/main.go:8\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:250"}
{"level":"warn","ts":1687336703.2790022,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"error","ts":1687336703.3657799,"caller":"app/app.go:42","msg":"ERR_INIT_REPOSITORY","error":"no migration found for version 0: read down for version 0 .: file does not exist","stacktrace":"warehouse-service/internal/app.Run\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/internal/app/app.go:42\nmain.main\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/main.go:8\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:250"}
{"level":"warn","ts":1687336730.487436,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"info","ts":1687336730.577899,"caller":"server/server.go:47","msg":"http server started on http://localhost:80"}
{"level":"warn","ts":1687336770.162118,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"error","ts":1687336770.260799,"caller":"app/app.go:42","msg":"ERR_INIT_REPOSITORY","error":"migration failed: syntax error at or near \"VARCHAR\" (column 19) in line 55: -- EXTENSIONS --\n\nCREATE EXTENSION IF NOT EXISTS pgcrypto;\n\n-- TABLES --\n\n\nCREATE TABLE IF NOT EXISTS stores (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    merchant_id         VARCHAR NOT NULL UNIQUE,\n    name                VARCHAR NOT NULL,\n    location            VARCHAR NOT NULL,\n    is_active BOOLEAN   NOT NULL DEFAULT TRUE,\n    rating               DECIMAL,\n    city_id             VARCHAR NULL,\n    schedule_id         VARCHAR NULL,\n    delivery_is_active BOOLEAN NOT NULL DEFAULT TRUE,\n    delivery_currency_id VARCHAR NULL,\n    currency_id VARCHAR NULL,\n    FOREIGN KEY (city_id) REFERENCES city(id),\n    FOREIGN KEY (schedule_id) REFERENCES schedule(id),\n    FOREIGN KEY (delivery_currency_id) REFERENCES currency(id),\n    FOREIGN KEY (currency_id) REFERENCES currency(id)\n);\n\n\n\nCREATE TABLE currency (\n  created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n  updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n  id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n  sign VARCHAR NULL,\n  decimal VARCHAR NULL,\n  prefix BOOLEAN NOT NULL DEFAULT TRUE,\n  PRIMARY KEY (id)\n);\n\nCREATE TABLE delivery (\n  created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n  updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n  id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n  entity_id VARCHAR NULL,\n  is_active BOOLEAN NOT NULL DEFAULT TRUE,\n  currency_id VARCHAR NULL,\n  FOREIGN KEY (entity_id) REFERENCES entity(id),\n  FOREIGN KEY (currency_id) REFERENCES currency(id)\n);\n\nCREATE TABLE periods (\n  created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n  updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n  id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n  schedule     id VARCHAR NULL,\n  day VARCHAR NULL,\n  from_time VARCHAR NULL,\n  to_time VARCHAR NULL,\n  FOREIGN KEY (schedule_id) REFERENCES schedule(id)\n);\n\nCREATE TABLE city (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n  name VARCHAR NULL,\n  geo_center VARCHAR NULL,\n);\n\nCREATE TABLE schedule (\n  created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n  updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n  id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n  is_active BOOLEAN NOT NULL DEFAULT TRUE,\n);\n\n\n (details: pq: syntax error at or near \"VARCHAR\")","stacktrace":"warehouse-service/internal/app.Run\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/internal/app/app.go:42\nmain.main\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/main.go:8\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:250"}
{"level":"warn","ts":1687336909.891841,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"error","ts":1687336910.010397,"caller":"app/app.go:42","msg":"ERR_INIT_REPOSITORY","error":"migration failed: relation \"city\" does not exist in line 0: -- EXTENSIONS --\nCREATE EXTENSION IF NOT EXISTS pgcrypto;\n\n-- TABLES --\nCREATE TABLE IF NOT EXISTS stores (\n    created_at           TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at           TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id                   UUID DEFAULT gen_random_uuid() PRIMARY KEY,\n    merchant_id          VARCHAR NOT NULL UNIQUE,\n    name                 VARCHAR NOT NULL,\n    location             VARCHAR NOT NULL,\n    is_active            BOOLEAN NOT NULL DEFAULT TRUE,\n    rating               DECIMAL,\n    city_id              UUID,\n    schedule_id          UUID,\n    delivery_is_active   BOOLEAN NOT NULL DEFAULT TRUE,\n    delivery_currency_id UUID,\n    currency_id          UUID,\n    FOREIGN KEY (city_id) REFERENCES city (id),\n    FOREIGN KEY (schedule_id) REFERENCES schedule (id),\n    FOREIGN KEY (delivery_currency_id) REFERENCES currency (id),\n    FOREIGN KEY (currency_id) REFERENCES currency (id)\n);\n\nCREATE TABLE currency (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID DEFAULT gen_random_uuid() PRIMARY KEY,\n    sign        VARCHAR,\n    decimal     INT,\n    prefix      BOOLEAN NOT NULL DEFAULT TRUE\n);\n\nCREATE TABLE delivery (\n    created_at    TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at    TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id            UUID DEFAULT gen_random_uuid() PRIMARY KEY,\n    entity_id     UUID,\n    is_active     BOOLEAN NOT NULL DEFAULT TRUE,\n    currency_id   UUID,\n    FOREIGN KEY (entity_id) REFERENCES stores (id),\n    FOREIGN KEY (currency_id) REFERENCES currency (id)\n);\n\nCREATE TABLE periods (\n    created_at    TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at    TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id            UUID DEFAULT gen_random_uuid() PRIMARY KEY,\n    schedule_id   UUID,\n    day           VARCHAR,\n    from_time     VARCHAR,\n    to_time       VARCHAR,\n    FOREIGN KEY (schedule_id) REFERENCES schedule (id)\n);\n\nCREATE TABLE city (\n    created_at    TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at    TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id            UUID DEFAULT gen_random_uuid() PRIMARY KEY,\n    name          VARCHAR,\n    geo_center    VARCHAR\n);\n\nCREATE TABLE schedule (\n    created_at    TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at    TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id            UUID DEFAULT gen_random_uuid() PRIMARY KEY,\n    is_active     BOOLEAN NOT NULL DEFAULT TRUE\n);\n (details: pq: relation \"city\" does not exist)","stacktrace":"warehouse-service/internal/app.Run\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/internal/app/app.go:42\nmain.main\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/main.go:8\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:250"}
{"level":"warn","ts":1687337180.100904,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"error","ts":1687337180.193918,"caller":"app/app.go:42","msg":"ERR_INIT_REPOSITORY","error":"Dirty database version 1. Fix and force version.","stacktrace":"warehouse-service/internal/app.Run\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/internal/app/app.go:42\nmain.main\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/main.go:8\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:250"}
{"level":"warn","ts":1687337218.0654001,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"error","ts":1687337218.19603,"caller":"app/app.go:42","msg":"ERR_INIT_REPOSITORY","error":"migration failed: relation \"stores\" does not exist in line 0: -- EXTENSIONS --\nCREATE EXTENSION IF NOT EXISTS pgcrypto;\n\n-- TABLES --\nCREATE TABLE city (\n    created_at    TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at    TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id            UUID DEFAULT gen_random_uuid() PRIMARY KEY,\n    name          VARCHAR,\n    geo_center    VARCHAR\n);\n\nCREATE TABLE schedule (\n    created_at    TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at    TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id            UUID DEFAULT gen_random_uuid() PRIMARY KEY,\n    is_active     BOOLEAN NOT NULL DEFAULT TRUE\n);\n\nCREATE TABLE currency (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID DEFAULT gen_random_uuid() PRIMARY KEY,\n    sign        VARCHAR,\n    decimal     INT,\n    prefix      BOOLEAN NOT NULL DEFAULT TRUE\n);\n\nCREATE TABLE delivery (\n    created_at    TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at    TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id            UUID DEFAULT gen_random_uuid() PRIMARY KEY,\n    entity_id     UUID,\n    is_active     BOOLEAN NOT NULL DEFAULT TRUE,\n    currency_id   UUID,\n    FOREIGN KEY (entity_id) REFERENCES stores (id),\n    FOREIGN KEY (currency_id) REFERENCES currency (id)\n);\n\nCREATE TABLE periods (\n    created_at    TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at    TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id            UUID DEFAULT gen_random_uuid() PRIMARY KEY,\n    schedule_id   UUID,\n    day           VARCHAR,\n    from_time     VARCHAR,\n    to_time       VARCHAR,\n    FOREIGN KEY (schedule_id) REFERENCES schedule (id)\n);\n\nCREATE TABLE stores (\n    created_at           TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at           TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id                   UUID DEFAULT gen_random_uuid() PRIMARY KEY,\n    merchant_id          VARCHAR NOT NULL UNIQUE,\n    name                 VARCHAR NOT NULL,\n    location             VARCHAR NOT NULL,\n    is_active            BOOLEAN NOT NULL DEFAULT TRUE,\n    rating               DECIMAL,\n    city_id              UUID,\n    schedule_id          UUID,\n    delivery_is_active   BOOLEAN NOT NULL DEFAULT TRUE,\n    delivery_currency_id UUID,\n    currency_id          UUID,\n    FOREIGN KEY (city_id) REFERENCES city (id),\n    FOREIGN KEY (schedule_id) REFERENCES schedule (id),\n    FOREIGN KEY (delivery_currency_id) REFERENCES currency (id),\n    FOREIGN KEY (currency_id) REFERENCES currency (id)\n);\n (details: pq: relation \"stores\" does not exist)","stacktrace":"warehouse-service/internal/app.Run\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/internal/app/app.go:42\nmain.main\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/main.go:8\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:250"}
{"level":"warn","ts":1687337382.117762,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"error","ts":1687337382.199622,"caller":"app/app.go:42","msg":"ERR_INIT_REPOSITORY","error":"Dirty database version 1. Fix and force version.","stacktrace":"warehouse-service/internal/app.Run\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/internal/app/app.go:42\nmain.main\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/main.go:8\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:250"}
{"level":"warn","ts":1687337401.0898979,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"info","ts":1687337401.1822321,"caller":"server/server.go:47","msg":"http server started on http://localhost:80"}
{"level":"warn","ts":1687337444.994619,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"error","ts":1687337445.1147032,"caller":"app/app.go:42","msg":"ERR_INIT_REPOSITORY","error":"migration failed: relation \"stores\" does not exist in line 0: -- EXTENSIONS --\nCREATE EXTENSION IF NOT EXISTS pgcrypto;\n\n-- TABLES --\nCREATE TABLE city (\n    created_at    TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at    TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id            UUID DEFAULT gen_random_uuid() PRIMARY KEY,\n    name          VARCHAR,\n    geo_center    VARCHAR\n);\n\nCREATE TABLE schedule (\n    created_at    TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at    TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id            UUID DEFAULT gen_random_uuid() PRIMARY KEY,\n    is_active     BOOLEAN NOT NULL DEFAULT TRUE\n);\n\nCREATE TABLE currency (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID DEFAULT gen_random_uuid() PRIMARY KEY,\n    sign        VARCHAR,\n    decimal     INT,\n    prefix      BOOLEAN NOT NULL DEFAULT TRUE\n);\n\nCREATE TABLE delivery (\n    created_at    TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at    TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id            UUID DEFAULT gen_random_uuid() PRIMARY KEY,\n    entity_id     UUID,\n    is_active     BOOLEAN NOT NULL DEFAULT TRUE,\n    currency_id   UUID,\n    FOREIGN KEY (entity_id) REFERENCES stores (id),\n    FOREIGN KEY (currency_id) REFERENCES currency (id)\n);\n\nCREATE TABLE stores (\n    created_at           TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at           TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id                   UUID DEFAULT gen_random_uuid() PRIMARY KEY,\n    merchant_id          VARCHAR NOT NULL UNIQUE,\n    name                 VARCHAR NOT NULL,\n    location             VARCHAR NOT NULL,\n    is_active            BOOLEAN NOT NULL DEFAULT TRUE,\n    rating               DECIMAL,\n    city_id              UUID,\n    schedule_id          UUID,\n    delivery_is_active   BOOLEAN NOT NULL DEFAULT TRUE,\n    delivery_currency_id UUID,\n    currency_id          UUID,\n    FOREIGN KEY (city_id) REFERENCES city (id),\n    FOREIGN KEY (schedule_id) REFERENCES schedule (id),\n    FOREIGN KEY (delivery_currency_id) REFERENCES currency (id),\n    FOREIGN KEY (currency_id) REFERENCES currency (id)\n);\n\nCREATE TABLE periods (\n    created_at    TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at    TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id            UUID DEFAULT gen_random_uuid() PRIMARY KEY,\n    schedule_id   UUID,\n    day           VARCHAR,\n    from_time     VARCHAR,\n    to_time       VARCHAR,\n    FOREIGN KEY (schedule_id) REFERENCES schedule (id)\n);\n (details: pq: relation \"stores\" does not exist)","stacktrace":"warehouse-service/internal/app.Run\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/internal/app/app.go:42\nmain.main\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/main.go:8\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:250"}
{"level":"warn","ts":1687338591.421458,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"info","ts":1687338591.54724,"caller":"server/server.go:47","msg":"http server started on http://localhost:80"}
{"level":"warn","ts":1687339114.783631,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"info","ts":1687339114.8817978,"caller":"server/server.go:47","msg":"http server started on http://localhost:80"}
{"level":"warn","ts":1687339171.7872949,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"info","ts":1687339171.9261491,"caller":"server/server.go:47","msg":"http server started on http://localhost:80"}
{"level":"warn","ts":1687339260.869926,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"info","ts":1687339260.93396,"caller":"server/server.go:47","msg":"http server started on http://localhost:80"}
{"level":"warn","ts":1687339330.282549,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"info","ts":1687339330.360707,"caller":"server/server.go:47","msg":"http server started on http://localhost:80"}
{"level":"warn","ts":1687339368.3321862,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"info","ts":1687339368.393856,"caller":"server/server.go:47","msg":"http server started on http://localhost:80"}
{"level":"warn","ts":1687340233.413561,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"info","ts":1687340233.5053902,"caller":"server/server.go:47","msg":"http server started on http://localhost:80"}
{"level":"warn","ts":1687340346.9856708,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"info","ts":1687340346.986416,"caller":"server/server.go:47","msg":"http server started on http://localhost:80"}
{"level":"warn","ts":1687341006.049214,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"info","ts":1687341006.0497642,"caller":"server/server.go:47","msg":"http server started on http://localhost:80"}
{"level":"warn","ts":1687341190.530081,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"info","ts":1687341190.632891,"caller":"server/server.go:47","msg":"http server started on http://localhost:80"}
{"level":"warn","ts":1687341675.146444,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"info","ts":1687341675.216523,"caller":"server/server.go:47","msg":"http server started on http://localhost:80"}
{"level":"warn","ts":1687341712.741558,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"info","ts":1687341712.880544,"caller":"server/server.go:47","msg":"http server started on http://localhost:80"}
{"level":"warn","ts":1687341840.491652,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"info","ts":1687341840.5861309,"caller":"server/server.go:47","msg":"http server started on http://localhost:80"}
{"level":"warn","ts":1687341888.933179,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"info","ts":1687341889.051269,"caller":"server/server.go:47","msg":"http server started on http://localhost:80"}
{"level":"warn","ts":1687342059.11083,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"info","ts":1687342059.192811,"caller":"server/server.go:47","msg":"http server started on http://localhost:80"}
{"level":"warn","ts":1687342118.684598,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"info","ts":1687342118.765547,"caller":"server/server.go:47","msg":"http server started on http://localhost:80"}
{"level":"warn","ts":1687342132.247872,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"error","ts":1687342132.36791,"caller":"app/app.go:44","msg":"ERR_INIT_REPOSITORY","error":"migration failed: foreign key constraint \"stores_city_id_fkey\" cannot be implemented, Key columns \"city_id\" and \"id\" are of incompatible types: character varying and uuid. in line 0: -- EXTENSIONS --\nCREATE EXTENSION IF NOT EXISTS pgcrypto;\n\n-- TABLES --\n\nCREATE TABLE city (\n    created_at    TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at    TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id            UUID DEFAULT gen_random_uuid() PRIMARY KEY,\n    name          VARCHAR,\n    geo_center    VARCHAR\n);\n\nCREATE TABLE schedule (\n    created_at    TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at    TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id            UUID DEFAULT gen_random_uuid() PRIMARY KEY,\n    is_active     BOOLEAN NOT NULL DEFAULT TRUE\n);\n\nCREATE TABLE currency (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID DEFAULT gen_random_uuid() PRIMARY KEY,\n    sign        VARCHAR,\n    decimal     INT,\n    prefix      BOOLEAN NOT NULL DEFAULT TRUE\n);\n\nCREATE TABLE stores (\n    created_at           TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at           TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id                   UUID DEFAULT gen_random_uuid() PRIMARY KEY,\n    merchant_id          VARCHAR NOT NULL UNIQUE,\n    name                 VARCHAR NOT NULL,\n    location             VARCHAR NOT NULL,\n    is_active            BOOLEAN NOT NULL DEFAULT TRUE,\n    rating               DECIMAL,\n    city_id              VARCHAR,\n    schedule_id          VARCHAR,\n    delivery_is_active   BOOLEAN NOT NULL DEFAULT TRUE,\n    delivery_currency_id VARCHAR,\n    currency_id          VARCHAR,\n    FOREIGN KEY (city_id) REFERENCES city (id),\n    FOREIGN KEY (schedule_id) REFERENCES schedule (id),\n    FOREIGN KEY (delivery_currency_id) REFERENCES currency (id),\n    FOREIGN KEY (currency_id) REFERENCES currency (id)\n);\n\nCREATE TABLE delivery (\n    created_at    TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at    TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id            UUID DEFAULT gen_random_uuid() PRIMARY KEY,\n    entity_id     UUID,\n    is_active     BOOLEAN NOT NULL DEFAULT TRUE,\n    currency_id   UUID,\n    FOREIGN KEY (entity_id) REFERENCES stores (id),\n    FOREIGN KEY (currency_id) REFERENCES currency (id)\n);\n\nCREATE TABLE periods (\n    created_at    TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at    TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id            UUID DEFAULT gen_random_uuid() PRIMARY KEY,\n    schedule_id   UUID,\n    day           VARCHAR,\n    from_time     VARCHAR,\n    to_time       VARCHAR,\n    FOREIGN KEY (schedule_id) REFERENCES schedule (id)\n);\n (details: pq: foreign key constraint \"stores_city_id_fkey\" cannot be implemented)","stacktrace":"warehouse-service/internal/app.Run\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/internal/app/app.go:44\nmain.main\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/main.go:8\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:250"}
{"level":"warn","ts":1687342430.771172,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"error","ts":1687342430.896118,"caller":"app/app.go:44","msg":"ERR_INIT_REPOSITORY","error":"migration failed: foreign key constraint \"stores_city_id_fkey\" cannot be implemented, Key columns \"city_id\" and \"id\" are of incompatible types: character varying and uuid. in line 0: -- EXTENSIONS --\nCREATE EXTENSION IF NOT EXISTS pgcrypto;\n\n-- TABLES --\n\nCREATE TABLE city (\n    created_at    TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at    TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id            UUID DEFAULT gen_random_uuid() PRIMARY KEY,\n    name          VARCHAR,\n    geo_center    VARCHAR\n);\n\nCREATE TABLE schedule (\n    created_at    TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at    TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id            UUID DEFAULT gen_random_uuid() PRIMARY KEY,\n    is_active     BOOLEAN NOT NULL DEFAULT TRUE\n);\n\nCREATE TABLE currency (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID DEFAULT gen_random_uuid() PRIMARY KEY,\n    sign        VARCHAR,\n    decimal     INT,\n    prefix      BOOLEAN NOT NULL DEFAULT TRUE\n);\n\nCREATE TABLE stores (\n    created_at           TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at           TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id                   UUID DEFAULT gen_random_uuid() PRIMARY KEY,\n    merchant_id          VARCHAR NOT NULL UNIQUE,\n    name                 VARCHAR NOT NULL,\n    location             VARCHAR NOT NULL,\n    is_active            BOOLEAN NOT NULL DEFAULT TRUE,\n    rating               DECIMAL,\n    city_id              VARCHAR,\n    schedule_id          UUID,\n    delivery_is_active   BOOLEAN NOT NULL DEFAULT TRUE,\n    delivery_currency_id VARCHAR,\n    currency_id          VARCHAR,\n    FOREIGN KEY (city_id) REFERENCES city (id),\n    FOREIGN KEY (schedule_id) REFERENCES schedule (id),\n    FOREIGN KEY (delivery_currency_id) REFERENCES currency (id),\n    FOREIGN KEY (currency_id) REFERENCES currency (id)\n);\n\nCREATE TABLE delivery (\n    created_at    TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at    TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id            UUID DEFAULT gen_random_uuid() PRIMARY KEY,\n    entity_id     UUID,\n    is_active     BOOLEAN NOT NULL DEFAULT TRUE,\n    currency_id   UUID,\n    FOREIGN KEY (entity_id) REFERENCES stores (id),\n    FOREIGN KEY (currency_id) REFERENCES currency (id)\n);\n\nCREATE TABLE periods (\n    created_at    TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at    TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id            UUID DEFAULT gen_random_uuid() PRIMARY KEY,\n    schedule_id   UUID,\n    day           VARCHAR,\n    from_time     VARCHAR,\n    to_time       VARCHAR,\n    FOREIGN KEY (schedule_id) REFERENCES schedule (id)\n);\n (details: pq: foreign key constraint \"stores_city_id_fkey\" cannot be implemented)","stacktrace":"warehouse-service/internal/app.Run\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/internal/app/app.go:44\nmain.main\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/main.go:8\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:250"}
{"level":"warn","ts":1687342488.795079,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"error","ts":1687342488.91695,"caller":"app/app.go:44","msg":"ERR_INIT_REPOSITORY","error":"migration failed: foreign key constraint \"stores_delivery_currency_id_fkey\" cannot be implemented, Key columns \"delivery_currency_id\" and \"id\" are of incompatible types: character varying and uuid. in line 0: -- EXTENSIONS --\nCREATE EXTENSION IF NOT EXISTS pgcrypto;\n\n-- TABLES --\n\nCREATE TABLE city (\n    created_at    TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at    TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id            UUID DEFAULT gen_random_uuid() PRIMARY KEY,\n    name          VARCHAR,\n    geo_center    VARCHAR\n);\n\nCREATE TABLE schedule (\n    created_at    TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at    TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id            UUID DEFAULT gen_random_uuid() PRIMARY KEY,\n    is_active     BOOLEAN NOT NULL DEFAULT TRUE\n);\n\nCREATE TABLE currency (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID DEFAULT gen_random_uuid() PRIMARY KEY,\n    sign        VARCHAR,\n    decimal     INT,\n    prefix      BOOLEAN NOT NULL DEFAULT TRUE\n);\n\nCREATE TABLE stores (\n    created_at           TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at           TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id                   UUID DEFAULT gen_random_uuid() PRIMARY KEY,\n    merchant_id          VARCHAR NOT NULL UNIQUE,\n    name                 VARCHAR NOT NULL,\n    location             VARCHAR NOT NULL,\n    is_active            BOOLEAN NOT NULL DEFAULT TRUE,\n    rating               DECIMAL,\n    city_id              UUID,\n    schedule_id          UUID,\n    delivery_is_active   BOOLEAN NOT NULL DEFAULT TRUE,\n    delivery_currency_id VARCHAR,\n    currency_id          VARCHAR,\n    FOREIGN KEY (city_id) REFERENCES city (id),\n    FOREIGN KEY (schedule_id) REFERENCES schedule (id),\n    FOREIGN KEY (delivery_currency_id) REFERENCES currency (id),\n    FOREIGN KEY (currency_id) REFERENCES currency (id)\n);\n\n\nCREATE TABLE delivery (\n    created_at    TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at    TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id            UUID DEFAULT gen_random_uuid() PRIMARY KEY,\n    entity_id     UUID,\n    is_active     BOOLEAN NOT NULL DEFAULT TRUE,\n    currency_id   UUID,\n    FOREIGN KEY (entity_id) REFERENCES stores (id),\n    FOREIGN KEY (currency_id) REFERENCES currency (id)\n);\n\nCREATE TABLE periods (\n    created_at    TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at    TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id            UUID DEFAULT gen_random_uuid() PRIMARY KEY,\n    schedule_id   UUID,\n    day           VARCHAR,\n    from_time     VARCHAR,\n    to_time       VARCHAR,\n    FOREIGN KEY (schedule_id) REFERENCES schedule (id)\n);\n (details: pq: foreign key constraint \"stores_delivery_currency_id_fkey\" cannot be implemented)","stacktrace":"warehouse-service/internal/app.Run\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/internal/app/app.go:44\nmain.main\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/main.go:8\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:250"}
{"level":"warn","ts":1687342582.978535,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"info","ts":1687342583.089663,"caller":"server/server.go:47","msg":"http server started on http://localhost:80"}
{"level":"warn","ts":1687344230.2937129,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"info","ts":1687344230.4281201,"caller":"server/server.go:47","msg":"http server started on http://localhost:80"}
{"level":"warn","ts":1687347598.033261,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"info","ts":1687347598.163933,"caller":"server/server.go:47","msg":"http server started on http://localhost:80"}
{"level":"warn","ts":1687347870.064244,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"error","ts":1687347870.111707,"caller":"app/app.go:44","msg":"ERR_INIT_REPOSITORY","error":"pq: password authentication failed for user \"postgress\"","stacktrace":"warehouse-service/internal/app.Run\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/internal/app/app.go:44\nmain.main\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/main.go:8\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:250"}
{"level":"warn","ts":1687347893.63408,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"info","ts":1687347893.7327292,"caller":"server/server.go:47","msg":"http server started on http://localhost:80"}
{"level":"warn","ts":1687429421.41596,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"error","ts":1687429421.518442,"caller":"app/app.go:44","msg":"ERR_INIT_REPOSITORY","error":"migration failed: syntax error at or near \"name\" (column 5) in line 38: -- EXTENSIONS --\nCREATE EXTENSION IF NOT EXISTS pgcrypto;\n\n-- TABLES --\nCREATE TABLE IF NOT EXISTS countries (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    name        VARCHAR NOT NULL\n);\n\nCREATE TABLE IF NOT EXISTS cities (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n\t\tcountry_id  VARCHAR NOT NULL,\n    name        VARCHAR NOT NULL,\n    latitude    NUMERIC NOT NULL,\n    longitude   NUMERIC NOT NULL\n);\n\nCREATE TABLE IF NOT EXISTS currencies (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    sign        VARCHAR NOT NULL,\n    decimals    INTEGER NOT NULL,\n    prefix      BOOLEAN NOT NULL DEFAULT FALSE\n);\n\n\nCREATE TABLE IF NOT EXISTS stores (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    merchant_id VARCHAR NOT NULL,\n    city_id     VARCHAR NOT NULL\n    name        VARCHAR NOT NULL,\n\t\taddress     VARCHAR NOT NULL,\n    location    VARCHAR NOT NULL,\n\t\trating      NUMERIC NOT NULL DEFAULT 0,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE\n);\n\nCREATE TABLE IF NOT EXISTS schedules (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    store_id    VARCHAR NOT NULL UNIQUE,\n    periods     JSONB NOT NULL,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE\n);\n\nCREATE TABLE IF NOT EXISTS deliveries (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    store_id    VARCHAR NOT NULL UNIQUE,\n    periods     JSONB NOT NULL,\n    areas       JSONB NOT NULL,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE\n); (details: pq: syntax error at or near \"name\")","stacktrace":"warehouse-service/internal/app.Run\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/internal/app/app.go:44\nmain.main\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/main.go:8\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:250"}
{"level":"warn","ts":1687429721.0363169,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"info","ts":1687429721.1630201,"caller":"server/server.go:47","msg":"http server started on http://localhost:80"}
{"level":"warn","ts":1687430201.936655,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"info","ts":1687430202.0462332,"caller":"server/server.go:47","msg":"http server started on http://localhost:80"}
{"level":"warn","ts":1687431161.543503,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"info","ts":1687431161.63295,"caller":"server/server.go:47","msg":"http server started on http://localhost:80"}
{"level":"warn","ts":1687431200.9517848,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"info","ts":1687431201.020462,"caller":"server/server.go:47","msg":"http server started on http://localhost:80"}
{"level":"warn","ts":1687432419.930312,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"info","ts":1687432420.017612,"caller":"server/server.go:47","msg":"http server started on http://localhost:80"}
{"level":"warn","ts":1687432581.309317,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"info","ts":1687432581.366682,"caller":"server/server.go:47","msg":"http server started on http://localhost:80"}
{"level":"warn","ts":1687432911.9409,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"info","ts":1687432912.0782452,"caller":"server/server.go:47","msg":"http server started on http://localhost:80"}
{"level":"warn","ts":1687434876.175296,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"info","ts":1687434876.1763031,"caller":"server/server.go:47","msg":"http server started on http://localhost:80"}
{"level":"warn","ts":1687434928.383717,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"info","ts":1687434928.3839848,"caller":"server/server.go:47","msg":"http server started on http://localhost:80"}
{"level":"warn","ts":1687434940.384604,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"info","ts":1687434940.385092,"caller":"server/server.go:47","msg":"http server started on http://localhost:80"}
{"level":"warn","ts":1687434988.049262,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"info","ts":1687434988.050035,"caller":"server/server.go:47","msg":"http server started on http://localhost:80"}
{"level":"warn","ts":1687517360.052945,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"info","ts":1687517360.054471,"caller":"server/server.go:47","msg":"http server started on http://localhost:80"}
{"level":"warn","ts":1687517388.9047182,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"info","ts":1687517388.905053,"caller":"server/server.go:47","msg":"http server started on http://localhost:80"}
{"level":"warn","ts":1687518569.625665,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"info","ts":1687518569.6266282,"caller":"server/server.go:47","msg":"http server started on http://localhost:80"}
{"level":"warn","ts":1687518608.120791,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"info","ts":1687518608.121505,"caller":"server/server.go:47","msg":"http server started on http://localhost:80"}
{"level":"warn","ts":1687519655.647282,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"info","ts":1687519655.6478841,"caller":"server/server.go:47","msg":"http server started on http://localhost:80"}
{"level":"warn","ts":1687521593.933717,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"info","ts":1687521593.934728,"caller":"server/server.go:47","msg":"http server started on http://localhost:80"}
{"level":"warn","ts":1687521832.435508,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"info","ts":1687521832.435746,"caller":"server/server.go:47","msg":"http server started on http://localhost:80"}
{"level":"warn","ts":1687837235.796862,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"info","ts":1687837235.797523,"caller":"server/server.go:47","msg":"http server started on http://localhost:80"}
{"level":"warn","ts":1687837255.2971048,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"info","ts":1687837255.29744,"caller":"server/server.go:47","msg":"http server started on http://localhost:80"}
{"level":"warn","ts":1687837281.137221,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"error","ts":1687837281.140817,"caller":"app/app.go:44","msg":"ERR_INIT_REPOSITORY","error":"dial tcp [::1]:5432: connect: connection refused","stacktrace":"warehouse-service/internal/app.Run\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/internal/app/app.go:44\nmain.main\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/main.go:8\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:250"}
{"level":"warn","ts":1687837300.575335,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"info","ts":1687837300.69971,"caller":"server/server.go:47","msg":"http server started on http://localhost:80"}
{"level":"warn","ts":1687838404.41872,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"info","ts":1687838404.516334,"caller":"server/server.go:47","msg":"http server started on http://localhost:80"}
{"level":"warn","ts":1687838424.698427,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"error","ts":1687838424.823169,"caller":"app/app.go:44","msg":"ERR_INIT_REPOSITORY","error":"migration failed: syntax error at or near \"VARCHAR\" (column 17) in line 26: -- EXTENSIONS --\nCREATE EXTENSION IF NOT EXISTS pgcrypto;\n\n-- TABLES --\nCREATE TABLE IF NOT EXISTS countries (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n    name        VARCHAR NOT NULL\n);\n\nCREATE TABLE IF NOT EXISTS cities (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n\tcountry_id  VARCHAR NOT NULL,\n    name        VARCHAR NOT NULL,\n    geocenter   NUMERIC NOT NULL,\n    FOREIGN KEY (country_id) REFERENCES countries (id)\n);\n\nCREATE TABLE IF NOT EXISTS currencies (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n    country id  VARCHAR NOT NULL,\n    sign        VARCHAR NOT NULL,\n    decimals    INTEGER NOT NULL,\n    prefix      BOOLEAN NOT NULL DEFAULT FALSE\n    FOREIGN KEY (country_id) REFERENCES countries (id)\n);\n\n\nCREATE TABLE IF NOT EXISTS stores (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n    merchantID  VARCHAR NOT NULL,\n    city_id     VARCHAR NOT NULL,\n    name        VARCHAR NOT NULL,\n\taddress     VARCHAR NOT NULL,\n    location    VARCHAR NOT NULL,\n\trating      NUMERIC NOT NULL DEFAULT 0,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (city_id) REFERENCES stores (id)\n\n);\n\nCREATE TABLE IF NOT EXISTS schedules (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n    store_id    VARCHAR NOT NULL UNIQUE,\n    periods     JSONB NOT NULL,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (store_id) REFERENCES stores (id)\n);\n\nCREATE TABLE IF NOT EXISTS deliveries (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n    store_id    VARCHAR NOT NULL UNIQUE,\n    periods     JSONB NOT NULL,\n    areas       JSONB NOT NULL,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (store_id) REFERENCES stores (id)\n\n);\n\n (details: pq: syntax error at or near \"VARCHAR\")","stacktrace":"warehouse-service/internal/app.Run\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/internal/app/app.go:44\nmain.main\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/main.go:8\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:250"}
{"level":"warn","ts":1687838617.231831,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"error","ts":1687838617.3342159,"caller":"app/app.go:44","msg":"ERR_INIT_REPOSITORY","error":"migration failed: syntax error at or near \"FOREIGN\" (column 5) in line 30: -- EXTENSIONS --\nCREATE EXTENSION IF NOT EXISTS pgcrypto;\n\n-- TABLES --\nCREATE TABLE IF NOT EXISTS countries (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n    name        VARCHAR NOT NULL\n);\n\nCREATE TABLE IF NOT EXISTS cities (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n\tcountry_id  VARCHAR NOT NULL,\n    name        VARCHAR NOT NULL,\n    geocenter   NUMERIC NOT NULL,\n    FOREIGN KEY (country_id) REFERENCES countries (id)\n);\n\nCREATE TABLE IF NOT EXISTS currencies (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n    country_id  VARCHAR NOT NULL,\n    sign        VARCHAR NOT NULL,\n    decimals    INTEGER NOT NULL,\n    prefix      BOOLEAN NOT NULL DEFAULT FALSE\n    FOREIGN KEY (country_id) REFERENCES countries (id)\n);\n\n\nCREATE TABLE IF NOT EXISTS stores (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n    merchantID  VARCHAR NOT NULL,\n    city_id     VARCHAR NOT NULL,\n    name        VARCHAR NOT NULL,\n\taddress     VARCHAR NOT NULL,\n    location    VARCHAR NOT NULL,\n\trating      NUMERIC NOT NULL DEFAULT 0,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (city_id) REFERENCES stores (id)\n\n);\n\nCREATE TABLE IF NOT EXISTS schedules (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n    store_id    VARCHAR NOT NULL UNIQUE,\n    periods     JSONB NOT NULL,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (store_id) REFERENCES stores (id)\n);\n\nCREATE TABLE IF NOT EXISTS deliveries (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n    store_id    VARCHAR NOT NULL UNIQUE,\n    periods     JSONB NOT NULL,\n    areas       JSONB NOT NULL,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (store_id) REFERENCES stores (id)\n\n);\n\n (details: pq: syntax error at or near \"FOREIGN\")","stacktrace":"warehouse-service/internal/app.Run\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/internal/app/app.go:44\nmain.main\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/main.go:8\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:250"}
{"level":"warn","ts":1687838914.694248,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"error","ts":1687838914.803207,"caller":"app/app.go:44","msg":"ERR_INIT_REPOSITORY","error":"migration failed: foreign key constraint \"cities_country_id_fkey\" cannot be implemented, Key columns \"country_id\" and \"id\" are of incompatible types: character varying and uuid. in line 0: -- EXTENSIONS --\nCREATE EXTENSION IF NOT EXISTS pgcrypto;\n\n-- TABLES --\nCREATE TABLE IF NOT EXISTS countries (\ncreated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\nupdated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\nid          UUID PRIMARY KEY DEFAULT gen_random_uuid(),\nname        VARCHAR NOT NULL\n);\n\nCREATE TABLE IF NOT EXISTS cities (\ncreated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\nupdated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\nid          UUID PRIMARY KEY DEFAULT gen_random_uuid(),\ncountry_id  VARCHAR NOT NULL,\nname        VARCHAR NOT NULL,\ngeocenter   NUMERIC NOT NULL,\nFOREIGN KEY (country_id) REFERENCES countries (id)\n);\n\nCREATE TABLE IF NOT EXISTS currencies (\ncreated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\nupdated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\nid          UUID PRIMARY KEY DEFAULT gen_random_uuid(),\ncountry_id  VARCHAR NOT NULL,\nsign        VARCHAR NOT NULL,\ndecimals    INTEGER NOT NULL,\nprefix      BOOLEAN NOT NULL DEFAULT FALSE,\nFOREIGN KEY (country_id) REFERENCES countries (id)\n);\n\nCREATE TABLE IF NOT EXISTS stores (\ncreated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\nupdated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\nid          UUID PRIMARY KEY DEFAULT gen_random_uuid(),\nmerchantID  VARCHAR NOT NULL,\ncity_id     VARCHAR NOT NULL,\nname        VARCHAR NOT NULL,\naddress     VARCHAR NOT NULL,\nlocation    VARCHAR NOT NULL,\nrating      NUMERIC NOT NULL DEFAULT 0,\nis_active   BOOLEAN NOT NULL DEFAULT FALSE,\nFOREIGN KEY (city_id) REFERENCES cities (id)\n\n);\n\nCREATE TABLE IF NOT EXISTS schedules (\ncreated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\nupdated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\nid          UUID PRIMARY KEY DEFAULT gen_random_uuid(),\nstore_id    VARCHAR NOT NULL UNIQUE,\nperiods     JSONB NOT NULL,\nis_active   BOOLEAN NOT NULL DEFAULT FALSE,\nFOREIGN KEY (store_id) REFERENCES stores (id)\n);\n\nCREATE TABLE IF NOT EXISTS deliveries (\ncreated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\nupdated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\nid          UUID PRIMARY KEY DEFAULT gen_random_uuid(),\nstore_id    VARCHAR NOT NULL UNIQUE,\nperiods     JSONB NOT NULL,\nareas       JSONB NOT NULL,\nis_active   BOOLEAN NOT NULL DEFAULT FALSE,\nFOREIGN KEY (store_id) REFERENCES stores (id)\n\n); (details: pq: foreign key constraint \"cities_country_id_fkey\" cannot be implemented)","stacktrace":"warehouse-service/internal/app.Run\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/internal/app/app.go:44\nmain.main\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/main.go:8\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:250"}
{"level":"warn","ts":1687838965.10511,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"error","ts":1687838965.1866071,"caller":"app/app.go:44","msg":"ERR_INIT_REPOSITORY","error":"Dirty database version 1. Fix and force version.","stacktrace":"warehouse-service/internal/app.Run\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/internal/app/app.go:44\nmain.main\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/main.go:8\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:250"}
{"level":"warn","ts":1687838999.42669,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"error","ts":1687838999.520063,"caller":"app/app.go:44","msg":"ERR_INIT_REPOSITORY","error":"migration failed: foreign key constraint \"cities_country_id_fkey\" cannot be implemented, Key columns \"country_id\" and \"id\" are of incompatible types: character varying and uuid. in line 0: -- EXTENSIONS --\nCREATE EXTENSION IF NOT EXISTS pgcrypto;\n\n-- TABLES --\nCREATE TABLE IF NOT EXISTS countries (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n    name        VARCHAR NOT NULL\n);\n\nCREATE TABLE IF NOT EXISTS cities (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n\tcountry_id  VARCHAR NOT NULL,\n    name        VARCHAR NOT NULL,\n    geocenter   NUMERIC NOT NULL,\n    FOREIGN KEY (country_id) REFERENCES countries (id)\n);\n\nCREATE TABLE IF NOT EXISTS currencies (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n    country_id  VARCHAR NOT NULL,\n    sign        VARCHAR NOT NULL,\n    decimals    INTEGER NOT NULL,\n    prefix      BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (country_id) REFERENCES countries (id)\n);\n\n\nCREATE TABLE IF NOT EXISTS stores (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n    merchantID  VARCHAR NOT NULL,\n    city_id     VARCHAR NOT NULL,\n    name        VARCHAR NOT NULL,\n\taddress     VARCHAR NOT NULL,\n    location    VARCHAR NOT NULL,\n\trating      NUMERIC NOT NULL DEFAULT 0,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (city_id) REFERENCES stores (id)\n\n);\n\nCREATE TABLE IF NOT EXISTS schedules (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n    store_id    VARCHAR NOT NULL UNIQUE,\n    periods     JSONB NOT NULL,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (store_id) REFERENCES stores (id)\n);\n\nCREATE TABLE IF NOT EXISTS deliveries (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n    store_id    VARCHAR NOT NULL UNIQUE,\n    periods     JSONB NOT NULL,\n    areas       JSONB NOT NULL,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (store_id) REFERENCES stores (id)\n\n);\n\n (details: pq: foreign key constraint \"cities_country_id_fkey\" cannot be implemented)","stacktrace":"warehouse-service/internal/app.Run\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/internal/app/app.go:44\nmain.main\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/main.go:8\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:250"}
{"level":"warn","ts":1687839296.769865,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"error","ts":1687839296.8929532,"caller":"app/app.go:44","msg":"ERR_INIT_REPOSITORY","error":"migration failed: foreign key constraint \"stores_city_id_fkey\" cannot be implemented, Key columns \"city_id\" and \"id\" are of incompatible types: character varying and uuid. in line 0: -- EXTENSIONS --\nCREATE EXTENSION IF NOT EXISTS pgcrypto;\n\n-- TABLES --\nCREATE TABLE IF NOT EXISTS countries (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n    name        VARCHAR NOT NULL\n);\n\nCREATE TABLE IF NOT EXISTS cities (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n\tcountry_id  UUID NOT NULL,\n    name        VARCHAR NOT NULL,\n    geocenter   NUMERIC NOT NULL,\n    FOREIGN KEY (country_id) REFERENCES countries (id)\n);\n\nCREATE TABLE IF NOT EXISTS currencies (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n    country_id  UUID NOT NULL,\n    sign        VARCHAR NOT NULL,\n    decimals    INTEGER NOT NULL,\n    prefix      BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (country_id) REFERENCES countries (id)\n);\n\n\nCREATE TABLE IF NOT EXISTS stores (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n    merchantID  VARCHAR NOT NULL,\n    city_id     VARCHAR NOT NULL,\n    name        VARCHAR NOT NULL,\n\taddress     VARCHAR NOT NULL,\n    location    VARCHAR NOT NULL,\n\trating      NUMERIC NOT NULL DEFAULT 0,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (city_id) REFERENCES stores (id)\n\n);\n\nCREATE TABLE IF NOT EXISTS schedules (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n    store_id    UUID NOT NULL UNIQUE,\n    periods     JSONB NOT NULL,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (store_id) REFERENCES stores (id)\n);\n\nCREATE TABLE IF NOT EXISTS deliveries (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n    store_id    UUID NOT NULL UNIQUE,\n    periods     JSONB NOT NULL,\n    areas       JSONB NOT NULL,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (store_id) REFERENCES stores (id)\n\n);\n\n (details: pq: foreign key constraint \"stores_city_id_fkey\" cannot be implemented)","stacktrace":"warehouse-service/internal/app.Run\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/internal/app/app.go:44\nmain.main\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/main.go:8\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:250"}
{"level":"warn","ts":1687839603.46735,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"info","ts":1687839603.600163,"caller":"server/server.go:47","msg":"http server started on http://localhost:80"}
{"level":"warn","ts":1687840239.9111512,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"info","ts":1687840240.008095,"caller":"server/server.go:47","msg":"http server started on http://localhost:80"}
{"level":"warn","ts":1687840289.5675552,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"info","ts":1687840289.6498828,"caller":"server/server.go:47","msg":"http server started on http://localhost:80"}
{"level":"warn","ts":1687840634.2663949,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"error","ts":1687840634.385213,"caller":"app/app.go:44","msg":"ERR_INIT_REPOSITORY","error":"migration failed: foreign key constraint \"cities_country_id_fkey\" cannot be implemented, Key columns \"country_id\" and \"id\" are of incompatible types: character varying and uuid. in line 0: -- EXTENSIONS --\nCREATE EXTENSION IF NOT EXISTS pgcrypto;\n\n-- TABLES --\nCREATE TABLE IF NOT EXISTS countries (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    name        VARCHAR NOT NULL UNIQUE\n);\n\nCREATE TABLE IF NOT EXISTS cities (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n\tcountry_id  VARCHAR NOT NULL,\n    name        VARCHAR NOT NULL UNIQUE,\n    geocenter   NUMERIC NOT NULL,\n    FOREIGN KEY (country_id) REFERENCES countries (id)\n);\n\nCREATE TABLE IF NOT EXISTS currencies (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    country_id  VARCHAR NOT NULL,\n    sign        VARCHAR NOT NULL UNIQUE,\n    decimals    INTEGER NOT NULL,\n    prefix      BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (country_id) REFERENCES cities (id)\n);\n\n\nCREATE TABLE IF NOT EXISTS stores (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    merchant_id VARCHAR NOT NULL,\n    city_id     VARCHAR NOT NULL,\n    name        VARCHAR NOT NULL,\n\taddress     VARCHAR NOT NULL,\n    location    VARCHAR NOT NULL,\n\trating      NUMERIC NOT NULL DEFAULT 0,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (city_id) REFERENCES cities (id)\n\n);\n\nCREATE TABLE IF NOT EXISTS schedules (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    store_id    VARCHAR NOT NULL UNIQUE,\n    periods     JSONB NOT NULL,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (store_id) REFERENCES stores (id)\n);\n\nCREATE TABLE IF NOT EXISTS deliveries (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    store_id    VARCHAR NOT NULL UNIQUE,\n    periods     JSONB NOT NULL,\n    areas       JSONB NOT NULL,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (store_id) REFERENCES stores (id)\n);\n\n (details: pq: foreign key constraint \"cities_country_id_fkey\" cannot be implemented)","stacktrace":"warehouse-service/internal/app.Run\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/internal/app/app.go:44\nmain.main\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/main.go:8\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:250"}
{"level":"warn","ts":1687840708.540992,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"error","ts":1687840708.6491032,"caller":"app/app.go:44","msg":"ERR_INIT_REPOSITORY","error":"migration failed: foreign key constraint \"currencies_country_id_fkey\" cannot be implemented, Key columns \"country_id\" and \"id\" are of incompatible types: character varying and uuid. in line 0: -- EXTENSIONS --\nCREATE EXTENSION IF NOT EXISTS pgcrypto;\n\n-- TABLES --\nCREATE TABLE IF NOT EXISTS countries (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    name        VARCHAR NOT NULL UNIQUE\n);\n\nCREATE TABLE IF NOT EXISTS cities (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n\tcountry_id  UUID NOT NULL,\n    name        VARCHAR NOT NULL UNIQUE,\n    geocenter   NUMERIC NOT NULL,\n    FOREIGN KEY (country_id) REFERENCES countries (id)\n);\n\nCREATE TABLE IF NOT EXISTS currencies (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    country_id  VARCHAR NOT NULL,\n    sign        VARCHAR NOT NULL UNIQUE,\n    decimals    INTEGER NOT NULL,\n    prefix      BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (country_id) REFERENCES cities (id)\n);\n\n\nCREATE TABLE IF NOT EXISTS stores (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    merchant_id VARCHAR NOT NULL,\n    city_id     VARCHAR NOT NULL,\n    name        VARCHAR NOT NULL,\n\taddress     VARCHAR NOT NULL,\n    location    VARCHAR NOT NULL,\n\trating      NUMERIC NOT NULL DEFAULT 0,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (city_id) REFERENCES cities (id)\n\n);\n\nCREATE TABLE IF NOT EXISTS schedules (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    store_id    VARCHAR NOT NULL UNIQUE,\n    periods     JSONB NOT NULL,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (store_id) REFERENCES stores (id)\n);\n\nCREATE TABLE IF NOT EXISTS deliveries (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    store_id    VARCHAR NOT NULL UNIQUE,\n    periods     JSONB NOT NULL,\n    areas       JSONB NOT NULL,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (store_id) REFERENCES stores (id)\n);\n\n (details: pq: foreign key constraint \"currencies_country_id_fkey\" cannot be implemented)","stacktrace":"warehouse-service/internal/app.Run\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/internal/app/app.go:44\nmain.main\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/main.go:8\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:250"}
{"level":"warn","ts":1687840762.033337,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"info","ts":1687840762.16106,"caller":"server/server.go:47","msg":"http server started on http://localhost:80"}
{"level":"warn","ts":1687841908.965406,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"error","ts":1687841909.04991,"caller":"app/app.go:44","msg":"ERR_INIT_REPOSITORY","error":"migration failed: syntax error at or near \"UUID\" (column 20) in line 74: BEGIN;\n\n-- EXTENSIONS --\nCREATE EXTENSION IF NOT EXISTS pgcrypto;\n\n-- TABLES --\nCREATE TABLE IF NOT EXISTS countries (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    name        VARCHAR NOT NULL UNIQUE\n);\n\nCREATE TABLE IF NOT EXISTS cities (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n\tcountry_id  UUID NOT NULL,\n    name        VARCHAR NOT NULL UNIQUE,\n    geocenter   NUMERIC NOT NULL,\n    FOREIGN KEY (country_id) REFERENCES countries (id)\n);\n\nCREATE TABLE IF NOT EXISTS currencies (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    country_id  UUID NOT NULL,\n    sign        VARCHAR NOT NULL UNIQUE,\n    decimals    INTEGER NOT NULL,\n    prefix      BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (country_id) REFERENCES cities (id)\n);\n\n\nCREATE TABLE IF NOT EXISTS stores (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    merchant_id VARCHAR NOT NULL,\n    city_id     UUID NOT NULL,\n    name        VARCHAR NOT NULL,\n\taddress     VARCHAR NOT NULL,\n    location    VARCHAR NOT NULL,\n\trating      NUMERIC NOT NULL DEFAULT 0,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (city_id) REFERENCES cities (id)\n\n);\n\nCREATE TABLE IF NOT EXISTS schedules (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    store_id    UUID NOT NULL UNIQUE,\n    periods     JSONB NOT NULL,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (store_id) REFERENCES stores (id)\n);\n\nCREATE TABLE IF NOT EXISTS deliveries (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    store_id    UUID NOT NULL UNIQUE,\n    periods     JSONB NOT NULL,\n    areas       JSONB NOT NULL,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (store_id) REFERENCES stores (id)\n);\n\n-- DATA --\n\nDECLARE country_id UUID;\nINSERT INTO countries (name) VALUES ('Kazakhstan') RETURNING id INTO country_id;\n\nDECLARE city_id UUID;\nINSERT INTO cities (country_id, name, geocenter) VALUES (country_id, 'Almaty', '43.238949, 76.889709') RETURNING id into city_id;\n\nINSERT INTO currencies (country_id, sign, decimals, prefix) VALUES (country_id, '₸', 0, FALSE);\n\nCOMMIT; (details: pq: syntax error at or near \"UUID\")","stacktrace":"warehouse-service/internal/app.Run\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/internal/app/app.go:44\nmain.main\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/main.go:8\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:250"}
{"level":"warn","ts":1687842089.998006,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"error","ts":1687842090.087513,"caller":"app/app.go:44","msg":"ERR_INIT_REPOSITORY","error":"Dirty database version 1. Fix and force version.","stacktrace":"warehouse-service/internal/app.Run\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/internal/app/app.go:44\nmain.main\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/main.go:8\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:250"}
{"level":"warn","ts":1687842110.8620071,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"error","ts":1687842110.976029,"caller":"app/app.go:44","msg":"ERR_INIT_REPOSITORY","error":"migration failed: syntax error at or near \"UUID\" (column 20) in line 1: DECLARE country_id UUID;\nDECLARE city_id UUID;\n\nBEGIN;\n\n-- EXTENSIONS --\nCREATE EXTENSION IF NOT EXISTS pgcrypto;\n\n-- TABLES --\nCREATE TABLE IF NOT EXISTS countries (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    name        VARCHAR NOT NULL UNIQUE\n);\n\nCREATE TABLE IF NOT EXISTS cities (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n\tcountry_id  UUID NOT NULL,\n    name        VARCHAR NOT NULL UNIQUE,\n    geocenter   NUMERIC NOT NULL,\n    FOREIGN KEY (country_id) REFERENCES countries (id)\n);\n\nCREATE TABLE IF NOT EXISTS currencies (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    country_id  UUID NOT NULL,\n    sign        VARCHAR NOT NULL UNIQUE,\n    decimals    INTEGER NOT NULL,\n    prefix      BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (country_id) REFERENCES cities (id)\n);\n\n\nCREATE TABLE IF NOT EXISTS stores (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    merchant_id VARCHAR NOT NULL,\n    city_id     UUID NOT NULL,\n    name        VARCHAR NOT NULL,\n\taddress     VARCHAR NOT NULL,\n    location    VARCHAR NOT NULL,\n\trating      NUMERIC NOT NULL DEFAULT 0,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (city_id) REFERENCES cities (id)\n\n);\n\nCREATE TABLE IF NOT EXISTS schedules (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    store_id    UUID NOT NULL UNIQUE,\n    periods     JSONB NOT NULL,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (store_id) REFERENCES stores (id)\n);\n\nCREATE TABLE IF NOT EXISTS deliveries (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    store_id    UUID NOT NULL UNIQUE,\n    periods     JSONB NOT NULL,\n    areas       JSONB NOT NULL,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (store_id) REFERENCES stores (id)\n);\n\n-- DATA --\n\n\nINSERT INTO countries (name) VALUES ('Kazakhstan') RETURNING id INTO country_id;\n\nINSERT INTO cities (country_id, name, geocenter) VALUES (country_id, 'Almaty', '43.238949, 76.889709') RETURNING id into city_id;\n\nINSERT INTO currencies (country_id, sign, decimals, prefix) VALUES (country_id, '₸', 0, FALSE);\n\nCOMMIT; (details: pq: syntax error at or near \"UUID\")","stacktrace":"warehouse-service/internal/app.Run\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/internal/app/app.go:44\nmain.main\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/main.go:8\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:250"}
{"level":"warn","ts":1687842255.701809,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"error","ts":1687842255.7617831,"caller":"app/app.go:44","msg":"ERR_INIT_REPOSITORY","error":"migration failed: syntax error at or near \"UUID\" (column 20) in line 74: BEGIN;\n\n-- EXTENSIONS --\nCREATE EXTENSION IF NOT EXISTS pgcrypto;\n\n-- TABLES --\nCREATE TABLE IF NOT EXISTS countries (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    name        VARCHAR NOT NULL UNIQUE\n);\n\nCREATE TABLE IF NOT EXISTS cities (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n\tcountry_id  UUID NOT NULL,\n    name        VARCHAR NOT NULL UNIQUE,\n    geocenter   NUMERIC NOT NULL,\n    FOREIGN KEY (country_id) REFERENCES countries (id)\n);\n\nCREATE TABLE IF NOT EXISTS currencies (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    country_id  UUID NOT NULL,\n    sign        VARCHAR NOT NULL UNIQUE,\n    decimals    INTEGER NOT NULL,\n    prefix      BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (country_id) REFERENCES cities (id)\n);\n\n\nCREATE TABLE IF NOT EXISTS stores (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    merchant_id VARCHAR NOT NULL,\n    city_id     UUID NOT NULL,\n    name        VARCHAR NOT NULL,\n\taddress     VARCHAR NOT NULL,\n    location    VARCHAR NOT NULL,\n\trating      NUMERIC NOT NULL DEFAULT 0,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (city_id) REFERENCES cities (id)\n\n);\n\nCREATE TABLE IF NOT EXISTS schedules (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    store_id    UUID NOT NULL UNIQUE,\n    periods     JSONB NOT NULL,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (store_id) REFERENCES stores (id)\n);\n\nCREATE TABLE IF NOT EXISTS deliveries (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    store_id    UUID NOT NULL UNIQUE,\n    periods     JSONB NOT NULL,\n    areas       JSONB NOT NULL,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (store_id) REFERENCES stores (id)\n);\n\n-- DATA --\n\nDECLARE country_id UUID DEFAULT GEN_RANDOM_UUID();\nINSERT INTO countries (name) VALUES ('Kazakhstan') RETURNING id INTO country_id;\n\nDECLARE city_id UUID DEFAULT GEN_RANDOM_UUID();\nINSERT INTO cities (country_id, name, geocenter) VALUES (country_id, 'Almaty', '43.238949, 76.889709') RETURNING id into city_id;\n\nINSERT INTO currencies (country_id, sign, decimals, prefix) VALUES (country_id, '₸', 0, FALSE);\n\nCOMMIT; (details: pq: syntax error at or near \"UUID\")","stacktrace":"warehouse-service/internal/app.Run\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/internal/app/app.go:44\nmain.main\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/main.go:8\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:250"}
{"level":"warn","ts":1687842311.752363,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"error","ts":1687842311.858005,"caller":"app/app.go:44","msg":"ERR_INIT_REPOSITORY","error":"migration failed: syntax error at or near \"VARCHAR\" (column 20) in line 74: BEGIN;\n\n-- EXTENSIONS --\nCREATE EXTENSION IF NOT EXISTS pgcrypto;\n\n-- TABLES --\nCREATE TABLE IF NOT EXISTS countries (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    name        VARCHAR NOT NULL UNIQUE\n);\n\nCREATE TABLE IF NOT EXISTS cities (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n\tcountry_id  UUID NOT NULL,\n    name        VARCHAR NOT NULL UNIQUE,\n    geocenter   NUMERIC NOT NULL,\n    FOREIGN KEY (country_id) REFERENCES countries (id)\n);\n\nCREATE TABLE IF NOT EXISTS currencies (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    country_id  UUID NOT NULL,\n    sign        VARCHAR NOT NULL UNIQUE,\n    decimals    INTEGER NOT NULL,\n    prefix      BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (country_id) REFERENCES cities (id)\n);\n\n\nCREATE TABLE IF NOT EXISTS stores (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    merchant_id VARCHAR NOT NULL,\n    city_id     UUID NOT NULL,\n    name        VARCHAR NOT NULL,\n\taddress     VARCHAR NOT NULL,\n    location    VARCHAR NOT NULL,\n\trating      NUMERIC NOT NULL DEFAULT 0,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (city_id) REFERENCES cities (id)\n\n);\n\nCREATE TABLE IF NOT EXISTS schedules (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    store_id    UUID NOT NULL UNIQUE,\n    periods     JSONB NOT NULL,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (store_id) REFERENCES stores (id)\n);\n\nCREATE TABLE IF NOT EXISTS deliveries (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    store_id    UUID NOT NULL UNIQUE,\n    periods     JSONB NOT NULL,\n    areas       JSONB NOT NULL,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (store_id) REFERENCES stores (id)\n);\n\n-- DATA --\n\nDECLARE country_id VARCHAR;\nINSERT INTO countries (name) VALUES ('Kazakhstan') RETURNING id INTO country_id;\n\nDECLARE city_id VARCHAR;\nINSERT INTO cities (country_id, name, geocenter) VALUES (country_id, 'Almaty', '43.238949, 76.889709') RETURNING id into city_id;\n\nINSERT INTO currencies (country_id, sign, decimals, prefix) VALUES (country_id, '₸', 0, FALSE);\n\nCOMMIT; (details: pq: syntax error at or near \"VARCHAR\")","stacktrace":"warehouse-service/internal/app.Run\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/internal/app/app.go:44\nmain.main\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/main.go:8\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:250"}
{"level":"warn","ts":1687842570.853678,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"error","ts":1687842570.952489,"caller":"app/app.go:44","msg":"ERR_INIT_REPOSITORY","error":"migration failed: syntax error at or near \"UUID\" (column 20) in line 74: BEGIN;\n\n-- EXTENSIONS --\nCREATE EXTENSION IF NOT EXISTS pgcrypto;\n\n-- TABLES --\nCREATE TABLE IF NOT EXISTS countries (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    name        VARCHAR NOT NULL UNIQUE\n);\n\nCREATE TABLE IF NOT EXISTS cities (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n\tcountry_id  UUID NOT NULL,\n    name        VARCHAR NOT NULL UNIQUE,\n    geocenter   NUMERIC NOT NULL,\n    FOREIGN KEY (country_id) REFERENCES countries (id)\n);\n\nCREATE TABLE IF NOT EXISTS currencies (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    country_id  UUID NOT NULL,\n    sign        VARCHAR NOT NULL UNIQUE,\n    decimals    INTEGER NOT NULL,\n    prefix      BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (country_id) REFERENCES cities (id)\n);\n\n\nCREATE TABLE IF NOT EXISTS stores (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    merchant_id VARCHAR NOT NULL,\n    city_id     UUID NOT NULL,\n    name        VARCHAR NOT NULL,\n\taddress     VARCHAR NOT NULL,\n    location    VARCHAR NOT NULL,\n\trating      NUMERIC NOT NULL DEFAULT 0,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (city_id) REFERENCES cities (id)\n\n);\n\nCREATE TABLE IF NOT EXISTS schedules (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    store_id    UUID NOT NULL UNIQUE,\n    periods     JSONB NOT NULL,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (store_id) REFERENCES stores (id)\n);\n\nCREATE TABLE IF NOT EXISTS deliveries (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    store_id    UUID NOT NULL UNIQUE,\n    periods     JSONB NOT NULL,\n    areas       JSONB NOT NULL,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (store_id) REFERENCES stores (id)\n);\n\n-- DATA --\n\nWITH country_id(id UUID) AS (\n    INSERT INTO countries (name)\n    VALUES ('Kazakhstan')\n    RETURNING id;\n)\n\nINSERT INTO cities (country_id, name, geocenter)\nVALUES (country_id, 'Almaty', '43.238949, 76.889709');\n\nINSERT INTO currencies (country_id, sign, decimals, prefix)\nVALUES (country_id, '₸', 0, FALSE);\n\nCOMMIT; (details: pq: syntax error at or near \"UUID\")","stacktrace":"warehouse-service/internal/app.Run\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/internal/app/app.go:44\nmain.main\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/main.go:8\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:250"}
{"level":"warn","ts":1687842753.5442529,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"error","ts":1687842753.62755,"caller":"app/app.go:44","msg":"ERR_INIT_REPOSITORY","error":"migration failed: syntax error at or near \"UUID\" (column 21) in line 74: BEGIN;\n\n-- EXTENSIONS --\nCREATE EXTENSION IF NOT EXISTS pgcrypto;\n\n-- TABLES --\nCREATE TABLE IF NOT EXISTS countries (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    name        VARCHAR NOT NULL UNIQUE\n);\n\nCREATE TABLE IF NOT EXISTS cities (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n\tcountry_id  UUID NOT NULL,\n    name        VARCHAR NOT NULL UNIQUE,\n    geocenter   NUMERIC NOT NULL,\n    FOREIGN KEY (country_id) REFERENCES countries (id)\n);\n\nCREATE TABLE IF NOT EXISTS currencies (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    country_id  UUID NOT NULL,\n    sign        VARCHAR NOT NULL UNIQUE,\n    decimals    INTEGER NOT NULL,\n    prefix      BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (country_id) REFERENCES cities (id)\n);\n\n\nCREATE TABLE IF NOT EXISTS stores (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    merchant_id VARCHAR NOT NULL,\n    city_id     UUID NOT NULL,\n    name        VARCHAR NOT NULL,\n\taddress     VARCHAR NOT NULL,\n    location    VARCHAR NOT NULL,\n\trating      NUMERIC NOT NULL DEFAULT 0,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (city_id) REFERENCES cities (id)\n\n);\n\nCREATE TABLE IF NOT EXISTS schedules (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    store_id    UUID NOT NULL UNIQUE,\n    periods     JSONB NOT NULL,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (store_id) REFERENCES stores (id)\n);\n\nCREATE TABLE IF NOT EXISTS deliveries (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    store_id    UUID NOT NULL UNIQUE,\n    periods     JSONB NOT NULL,\n    areas       JSONB NOT NULL,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (store_id) REFERENCES stores (id)\n);\n\n-- DATA --\n\nWITH new_country(id UUID) AS (\n    INSERT INTO countries (name)\n    VALUES ('Kazakhstan')\n    RETURNING id;\n)\n\nINSERT INTO cities (id FROM new_country, name, geocenter)\nVALUES (country_id, 'Almaty', '43.238949, 76.889709');\n\nINSERT INTO currencies (country_id, sign, decimals, prefix)\nVALUES (country_id, '₸', 0, FALSE);\n\nCOMMIT; (details: pq: syntax error at or near \"UUID\")","stacktrace":"warehouse-service/internal/app.Run\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/internal/app/app.go:44\nmain.main\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/main.go:8\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:250"}
{"level":"warn","ts":1687842799.87595,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"error","ts":1687842799.952203,"caller":"app/app.go:44","msg":"ERR_INIT_REPOSITORY","error":"migration failed: syntax error at or near \"UUID\" (column 21) in line 74: BEGIN;\n\n-- EXTENSIONS --\nCREATE EXTENSION IF NOT EXISTS pgcrypto;\n\n-- TABLES --\nCREATE TABLE IF NOT EXISTS countries (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    name        VARCHAR NOT NULL UNIQUE\n);\n\nCREATE TABLE IF NOT EXISTS cities (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n\tcountry_id  UUID NOT NULL,\n    name        VARCHAR NOT NULL UNIQUE,\n    geocenter   NUMERIC NOT NULL,\n    FOREIGN KEY (country_id) REFERENCES countries (id)\n);\n\nCREATE TABLE IF NOT EXISTS currencies (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    country_id  UUID NOT NULL,\n    sign        VARCHAR NOT NULL UNIQUE,\n    decimals    INTEGER NOT NULL,\n    prefix      BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (country_id) REFERENCES cities (id)\n);\n\n\nCREATE TABLE IF NOT EXISTS stores (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    merchant_id VARCHAR NOT NULL,\n    city_id     UUID NOT NULL,\n    name        VARCHAR NOT NULL,\n\taddress     VARCHAR NOT NULL,\n    location    VARCHAR NOT NULL,\n\trating      NUMERIC NOT NULL DEFAULT 0,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (city_id) REFERENCES cities (id)\n\n);\n\nCREATE TABLE IF NOT EXISTS schedules (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    store_id    UUID NOT NULL UNIQUE,\n    periods     JSONB NOT NULL,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (store_id) REFERENCES stores (id)\n);\n\nCREATE TABLE IF NOT EXISTS deliveries (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    store_id    UUID NOT NULL UNIQUE,\n    periods     JSONB NOT NULL,\n    areas       JSONB NOT NULL,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (store_id) REFERENCES stores (id)\n);\n\n-- DATA --\n\nWITH new_country(id UUID) AS (\n    INSERT INTO countries (name)\n    VALUES ('Kazakhstan')\n    RETURNING id\n);\n\nINSERT INTO cities (id FROM new_country, name, geocenter)\nVALUES (country_id, 'Almaty', '43.238949, 76.889709');\n\nINSERT INTO currencies (country_id, sign, decimals, prefix)\nVALUES (country_id, '₸', 0, FALSE);\n\nCOMMIT; (details: pq: syntax error at or near \"UUID\")","stacktrace":"warehouse-service/internal/app.Run\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/internal/app/app.go:44\nmain.main\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/main.go:8\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:250"}
{"level":"warn","ts":1687842873.76299,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"error","ts":1687842873.8634748,"caller":"app/app.go:44","msg":"ERR_INIT_REPOSITORY","error":"migration failed: syntax error at or near \"VARCHAR\" (column 21) in line 74: BEGIN;\n\n-- EXTENSIONS --\nCREATE EXTENSION IF NOT EXISTS pgcrypto;\n\n-- TABLES --\nCREATE TABLE IF NOT EXISTS countries (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    name        VARCHAR NOT NULL UNIQUE\n);\n\nCREATE TABLE IF NOT EXISTS cities (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n\tcountry_id  UUID NOT NULL,\n    name        VARCHAR NOT NULL UNIQUE,\n    geocenter   NUMERIC NOT NULL,\n    FOREIGN KEY (country_id) REFERENCES countries (id)\n);\n\nCREATE TABLE IF NOT EXISTS currencies (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    country_id  UUID NOT NULL,\n    sign        VARCHAR NOT NULL UNIQUE,\n    decimals    INTEGER NOT NULL,\n    prefix      BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (country_id) REFERENCES cities (id)\n);\n\n\nCREATE TABLE IF NOT EXISTS stores (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    merchant_id VARCHAR NOT NULL,\n    city_id     UUID NOT NULL,\n    name        VARCHAR NOT NULL,\n\taddress     VARCHAR NOT NULL,\n    location    VARCHAR NOT NULL,\n\trating      NUMERIC NOT NULL DEFAULT 0,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (city_id) REFERENCES cities (id)\n\n);\n\nCREATE TABLE IF NOT EXISTS schedules (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    store_id    UUID NOT NULL UNIQUE,\n    periods     JSONB NOT NULL,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (store_id) REFERENCES stores (id)\n);\n\nCREATE TABLE IF NOT EXISTS deliveries (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    store_id    UUID NOT NULL UNIQUE,\n    periods     JSONB NOT NULL,\n    areas       JSONB NOT NULL,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (store_id) REFERENCES stores (id)\n);\n\n-- DATA --\n\nWITH new_country(id VARCHAR) AS (\n    INSERT INTO countries (name)\n    VALUES ('Kazakhstan')\n    RETURNING id\n);\n\nINSERT INTO cities (id FROM new_country, name, geocenter)\nVALUES (country_id, 'Almaty', '43.238949, 76.889709');\n\nINSERT INTO currencies (country_id, sign, decimals, prefix)\nVALUES (country_id, '₸', 0, FALSE);\n\nCOMMIT; (details: pq: syntax error at or near \"VARCHAR\")","stacktrace":"warehouse-service/internal/app.Run\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/internal/app/app.go:44\nmain.main\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/main.go:8\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:250"}
{"level":"warn","ts":1687843143.462344,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"error","ts":1687843143.562559,"caller":"app/app.go:44","msg":"ERR_INIT_REPOSITORY","error":"migration failed: syntax error at or near \";\" (column 47) in line 80: BEGIN;\n\n-- EXTENSIONS --\nCREATE EXTENSION IF NOT EXISTS pgcrypto;\n\n-- TABLES --\nCREATE TABLE IF NOT EXISTS countries (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    name        VARCHAR NOT NULL UNIQUE\n);\n\nCREATE TABLE IF NOT EXISTS cities (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n\tcountry_id  UUID NOT NULL,\n    name        VARCHAR NOT NULL UNIQUE,\n    geocenter   NUMERIC NOT NULL,\n    FOREIGN KEY (country_id) REFERENCES countries (id)\n);\n\nCREATE TABLE IF NOT EXISTS currencies (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    country_id  UUID NOT NULL,\n    sign        VARCHAR NOT NULL UNIQUE,\n    decimals    INTEGER NOT NULL,\n    prefix      BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (country_id) REFERENCES cities (id)\n);\n\n\nCREATE TABLE IF NOT EXISTS stores (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    merchant_id VARCHAR NOT NULL,\n    city_id     UUID NOT NULL,\n    name        VARCHAR NOT NULL,\n\taddress     VARCHAR NOT NULL,\n    location    VARCHAR NOT NULL,\n\trating      NUMERIC NOT NULL DEFAULT 0,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (city_id) REFERENCES cities (id)\n\n);\n\nCREATE TABLE IF NOT EXISTS schedules (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    store_id    UUID NOT NULL UNIQUE,\n    periods     JSONB NOT NULL,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (store_id) REFERENCES stores (id)\n);\n\nCREATE TABLE IF NOT EXISTS deliveries (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    store_id    UUID NOT NULL UNIQUE,\n    periods     JSONB NOT NULL,\n    areas       JSONB NOT NULL,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (store_id) REFERENCES stores (id)\n);\n\n-- DATA --\n\nWITH new_country AS (\n    INSERT INTO countries (name)\n    VALUES ('Kazakhstan')\n    RETURNING id\n)\n\nINSERT INTO cities (SELECT id FROM new_country;, name, geocenter)\nVALUES (country_id, 'Almaty', '43.238949, 76.889709');\n\nINSERT INTO currencies (country_id, sign, decimals, prefix)\nVALUES (country_id, '₸', 0, FALSE);\n\nCOMMIT; (details: pq: syntax error at or near \";\")","stacktrace":"warehouse-service/internal/app.Run\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/internal/app/app.go:44\nmain.main\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/main.go:8\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:250"}
{"level":"warn","ts":1687843166.747342,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"error","ts":1687843166.8488262,"caller":"app/app.go:44","msg":"ERR_INIT_REPOSITORY","error":"migration failed: syntax error at or near \"VALUES\" (column 1) in line 81: BEGIN;\n\n-- EXTENSIONS --\nCREATE EXTENSION IF NOT EXISTS pgcrypto;\n\n-- TABLES --\nCREATE TABLE IF NOT EXISTS countries (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    name        VARCHAR NOT NULL UNIQUE\n);\n\nCREATE TABLE IF NOT EXISTS cities (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n\tcountry_id  UUID NOT NULL,\n    name        VARCHAR NOT NULL UNIQUE,\n    geocenter   NUMERIC NOT NULL,\n    FOREIGN KEY (country_id) REFERENCES countries (id)\n);\n\nCREATE TABLE IF NOT EXISTS currencies (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    country_id  UUID NOT NULL,\n    sign        VARCHAR NOT NULL UNIQUE,\n    decimals    INTEGER NOT NULL,\n    prefix      BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (country_id) REFERENCES cities (id)\n);\n\n\nCREATE TABLE IF NOT EXISTS stores (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    merchant_id VARCHAR NOT NULL,\n    city_id     UUID NOT NULL,\n    name        VARCHAR NOT NULL,\n\taddress     VARCHAR NOT NULL,\n    location    VARCHAR NOT NULL,\n\trating      NUMERIC NOT NULL DEFAULT 0,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (city_id) REFERENCES cities (id)\n\n);\n\nCREATE TABLE IF NOT EXISTS schedules (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    store_id    UUID NOT NULL UNIQUE,\n    periods     JSONB NOT NULL,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (store_id) REFERENCES stores (id)\n);\n\nCREATE TABLE IF NOT EXISTS deliveries (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    store_id    UUID NOT NULL UNIQUE,\n    periods     JSONB NOT NULL,\n    areas       JSONB NOT NULL,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (store_id) REFERENCES stores (id)\n);\n\n-- DATA --\n\nWITH new_country AS (\n    INSERT INTO countries (name)\n    VALUES ('Kazakhstan')\n    RETURNING id\n)\n\nINSERT INTO cities (SELECT id FROM new_country, name, geocenter)\nVALUES (country_id, 'Almaty', '43.238949, 76.889709');\n\nINSERT INTO currencies (country_id, sign, decimals, prefix)\nVALUES (country_id, '₸', 0, FALSE);\n\nCOMMIT; (details: pq: syntax error at or near \"VALUES\")","stacktrace":"warehouse-service/internal/app.Run\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/internal/app/app.go:44\nmain.main\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/main.go:8\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:250"}
{"level":"warn","ts":1687843196.2768261,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"error","ts":1687843196.37677,"caller":"app/app.go:44","msg":"ERR_INIT_REPOSITORY","error":"migration failed: syntax error at or near \"SELECT\" (column 9) in line 81: BEGIN;\n\n-- EXTENSIONS --\nCREATE EXTENSION IF NOT EXISTS pgcrypto;\n\n-- TABLES --\nCREATE TABLE IF NOT EXISTS countries (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    name        VARCHAR NOT NULL UNIQUE\n);\n\nCREATE TABLE IF NOT EXISTS cities (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n\tcountry_id  UUID NOT NULL,\n    name        VARCHAR NOT NULL UNIQUE,\n    geocenter   NUMERIC NOT NULL,\n    FOREIGN KEY (country_id) REFERENCES countries (id)\n);\n\nCREATE TABLE IF NOT EXISTS currencies (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    country_id  UUID NOT NULL,\n    sign        VARCHAR NOT NULL UNIQUE,\n    decimals    INTEGER NOT NULL,\n    prefix      BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (country_id) REFERENCES cities (id)\n);\n\n\nCREATE TABLE IF NOT EXISTS stores (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    merchant_id VARCHAR NOT NULL,\n    city_id     UUID NOT NULL,\n    name        VARCHAR NOT NULL,\n\taddress     VARCHAR NOT NULL,\n    location    VARCHAR NOT NULL,\n\trating      NUMERIC NOT NULL DEFAULT 0,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (city_id) REFERENCES cities (id)\n\n);\n\nCREATE TABLE IF NOT EXISTS schedules (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    store_id    UUID NOT NULL UNIQUE,\n    periods     JSONB NOT NULL,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (store_id) REFERENCES stores (id)\n);\n\nCREATE TABLE IF NOT EXISTS deliveries (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    store_id    UUID NOT NULL UNIQUE,\n    periods     JSONB NOT NULL,\n    areas       JSONB NOT NULL,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (store_id) REFERENCES stores (id)\n);\n\n-- DATA --\n\nWITH new_country AS (\n    INSERT INTO countries (name)\n    VALUES ('Kazakhstan')\n    RETURNING id\n)\n\nINSERT INTO cities (country_id, name, geocenter)\nVALUES (SELECT id FROM new_country, 'Almaty', '43.238949, 76.889709');\n\nINSERT INTO currencies (country_id, sign, decimals, prefix)\nVALUES (country_id, '₸', 0, FALSE);\n\nCOMMIT; (details: pq: syntax error at or near \"SELECT\")","stacktrace":"warehouse-service/internal/app.Run\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/internal/app/app.go:44\nmain.main\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/main.go:8\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:250"}
{"level":"warn","ts":1687843222.4501498,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"error","ts":1687843222.553764,"caller":"app/app.go:44","msg":"ERR_INIT_REPOSITORY","error":"migration failed: syntax error at or near \"FROM\" (column 12) in line 81: BEGIN;\n\n-- EXTENSIONS --\nCREATE EXTENSION IF NOT EXISTS pgcrypto;\n\n-- TABLES --\nCREATE TABLE IF NOT EXISTS countries (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    name        VARCHAR NOT NULL UNIQUE\n);\n\nCREATE TABLE IF NOT EXISTS cities (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n\tcountry_id  UUID NOT NULL,\n    name        VARCHAR NOT NULL UNIQUE,\n    geocenter   NUMERIC NOT NULL,\n    FOREIGN KEY (country_id) REFERENCES countries (id)\n);\n\nCREATE TABLE IF NOT EXISTS currencies (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    country_id  UUID NOT NULL,\n    sign        VARCHAR NOT NULL UNIQUE,\n    decimals    INTEGER NOT NULL,\n    prefix      BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (country_id) REFERENCES cities (id)\n);\n\n\nCREATE TABLE IF NOT EXISTS stores (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    merchant_id VARCHAR NOT NULL,\n    city_id     UUID NOT NULL,\n    name        VARCHAR NOT NULL,\n\taddress     VARCHAR NOT NULL,\n    location    VARCHAR NOT NULL,\n\trating      NUMERIC NOT NULL DEFAULT 0,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (city_id) REFERENCES cities (id)\n\n);\n\nCREATE TABLE IF NOT EXISTS schedules (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    store_id    UUID NOT NULL UNIQUE,\n    periods     JSONB NOT NULL,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (store_id) REFERENCES stores (id)\n);\n\nCREATE TABLE IF NOT EXISTS deliveries (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    store_id    UUID NOT NULL UNIQUE,\n    periods     JSONB NOT NULL,\n    areas       JSONB NOT NULL,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (store_id) REFERENCES stores (id)\n);\n\n-- DATA --\n\nWITH new_country AS (\n    INSERT INTO countries (name)\n    VALUES ('Kazakhstan')\n    RETURNING id\n)\n\nINSERT INTO cities (country_id, name, geocenter)\nVALUES (id FROM new_country, 'Almaty', '43.238949, 76.889709');\n\nINSERT INTO currencies (country_id, sign, decimals, prefix)\nVALUES (country_id, '₸', 0, FALSE);\n\nCOMMIT; (details: pq: syntax error at or near \"FROM\")","stacktrace":"warehouse-service/internal/app.Run\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/internal/app/app.go:44\nmain.main\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/main.go:8\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:250"}
{"level":"warn","ts":1687843488.010724,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"error","ts":1687843488.101571,"caller":"app/app.go:44","msg":"ERR_INIT_REPOSITORY","error":"migration failed: syntax error at or near \"'Almaty'\" (column 29) in line 81: BEGIN;\n\n-- EXTENSIONS --\nCREATE EXTENSION IF NOT EXISTS pgcrypto;\n\n-- TABLES --\nCREATE TABLE IF NOT EXISTS countries (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    name        VARCHAR NOT NULL UNIQUE\n);\n\nCREATE TABLE IF NOT EXISTS cities (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n\tcountry_id  UUID NOT NULL,\n    name        VARCHAR NOT NULL UNIQUE,\n    geocenter   NUMERIC NOT NULL,\n    FOREIGN KEY (country_id) REFERENCES countries (id)\n);\n\nCREATE TABLE IF NOT EXISTS currencies (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    country_id  UUID NOT NULL,\n    sign        VARCHAR NOT NULL UNIQUE,\n    decimals    INTEGER NOT NULL,\n    prefix      BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (country_id) REFERENCES cities (id)\n);\n\n\nCREATE TABLE IF NOT EXISTS stores (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    merchant_id VARCHAR NOT NULL,\n    city_id     UUID NOT NULL,\n    name        VARCHAR NOT NULL,\n\taddress     VARCHAR NOT NULL,\n    location    VARCHAR NOT NULL,\n\trating      NUMERIC NOT NULL DEFAULT 0,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (city_id) REFERENCES cities (id)\n\n);\n\nCREATE TABLE IF NOT EXISTS schedules (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    store_id    UUID NOT NULL UNIQUE,\n    periods     JSONB NOT NULL,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (store_id) REFERENCES stores (id)\n);\n\nCREATE TABLE IF NOT EXISTS deliveries (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    store_id    UUID NOT NULL UNIQUE,\n    periods     JSONB NOT NULL,\n    areas       JSONB NOT NULL,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (store_id) REFERENCES stores (id)\n);\n\n-- DATA --\n\nWITH new_country AS (\n    INSERT INTO countries (name)\n    VALUES ('Kazakhstan')\n    RETURNING id\n)\n\nINSERT INTO cities (country_id, name, geocenter)\nSELECT id FROM new_country, 'Almaty', '43.238949, 76.889709';\n\nINSERT INTO currencies (country_id, sign, decimals, prefix)\nVALUES (country_id, '₸', 0, FALSE);\n\nCOMMIT; (details: pq: syntax error at or near \"'Almaty'\")","stacktrace":"warehouse-service/internal/app.Run\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/internal/app/app.go:44\nmain.main\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/main.go:8\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:250"}
{"level":"warn","ts":1687843725.494825,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"error","ts":1687843725.621172,"caller":"app/app.go:44","msg":"ERR_INIT_REPOSITORY","error":"2 errors occurred:\n\t* migration failed: invalid input syntax for type numeric: \"43.238949, 76.889709\" (column 22) in line 81: BEGIN;\n\n-- EXTENSIONS --\nCREATE EXTENSION IF NOT EXISTS pgcrypto;\n\n-- TABLES --\nCREATE TABLE IF NOT EXISTS countries (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    name        VARCHAR NOT NULL UNIQUE\n);\n\nCREATE TABLE IF NOT EXISTS cities (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n\tcountry_id  UUID NOT NULL,\n    name        VARCHAR NOT NULL UNIQUE,\n    geocenter   NUMERIC NOT NULL,\n    FOREIGN KEY (country_id) REFERENCES countries (id)\n);\n\nCREATE TABLE IF NOT EXISTS currencies (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    country_id  UUID NOT NULL,\n    sign        VARCHAR NOT NULL UNIQUE,\n    decimals    INTEGER NOT NULL,\n    prefix      BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (country_id) REFERENCES cities (id)\n);\n\n\nCREATE TABLE IF NOT EXISTS stores (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    merchant_id VARCHAR NOT NULL,\n    city_id     UUID NOT NULL,\n    name        VARCHAR NOT NULL,\n\taddress     VARCHAR NOT NULL,\n    location    VARCHAR NOT NULL,\n\trating      NUMERIC NOT NULL DEFAULT 0,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (city_id) REFERENCES cities (id)\n\n);\n\nCREATE TABLE IF NOT EXISTS schedules (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    store_id    UUID NOT NULL UNIQUE,\n    periods     JSONB NOT NULL,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (store_id) REFERENCES stores (id)\n);\n\nCREATE TABLE IF NOT EXISTS deliveries (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    store_id    UUID NOT NULL UNIQUE,\n    periods     JSONB NOT NULL,\n    areas       JSONB NOT NULL,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (store_id) REFERENCES stores (id)\n);\n\n-- DATA --\n\nWITH new_country AS (\n    INSERT INTO countries (name)\n    VALUES ('Kazakhstan')\n    RETURNING id\n)\n\nINSERT INTO cities (country_id, name, geocenter)\nSELECT id, 'Almaty', '43.238949, 76.889709' FROM new_country;\n\nINSERT INTO currencies (country_id, sign, decimals, prefix)\nVALUES (country_id, '₸', 0, FALSE);\n\nCOMMIT; (details: pq: invalid input syntax for type numeric: \"43.238949, 76.889709\")\n\t* pq: current transaction is aborted, commands ignored until end of transaction block in line 0: SELECT pg_advisory_unlock($1)\n\n","stacktrace":"warehouse-service/internal/app.Run\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/internal/app/app.go:44\nmain.main\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/main.go:8\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:250"}
{"level":"warn","ts":1687843766.3116171,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"error","ts":1687843766.4452748,"caller":"app/app.go:44","msg":"ERR_INIT_REPOSITORY","error":"2 errors occurred:\n\t* migration failed: column \"country_id\" does not exist (column 9) in line 84: BEGIN;\n\n-- EXTENSIONS --\nCREATE EXTENSION IF NOT EXISTS pgcrypto;\n\n-- TABLES --\nCREATE TABLE IF NOT EXISTS countries (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    name        VARCHAR NOT NULL UNIQUE\n);\n\nCREATE TABLE IF NOT EXISTS cities (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n\tcountry_id  UUID NOT NULL,\n    name        VARCHAR NOT NULL UNIQUE,\n    geocenter   VARCHAR NOT NULL,\n    FOREIGN KEY (country_id) REFERENCES countries (id)\n);\n\nCREATE TABLE IF NOT EXISTS currencies (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    country_id  UUID NOT NULL,\n    sign        VARCHAR NOT NULL UNIQUE,\n    decimals    INTEGER NOT NULL,\n    prefix      BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (country_id) REFERENCES cities (id)\n);\n\n\nCREATE TABLE IF NOT EXISTS stores (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    merchant_id VARCHAR NOT NULL,\n    city_id     UUID NOT NULL,\n    name        VARCHAR NOT NULL,\n\taddress     VARCHAR NOT NULL,\n    location    VARCHAR NOT NULL,\n\trating      NUMERIC NOT NULL DEFAULT 0,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (city_id) REFERENCES cities (id)\n\n);\n\nCREATE TABLE IF NOT EXISTS schedules (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    store_id    UUID NOT NULL UNIQUE,\n    periods     JSONB NOT NULL,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (store_id) REFERENCES stores (id)\n);\n\nCREATE TABLE IF NOT EXISTS deliveries (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    store_id    UUID NOT NULL UNIQUE,\n    periods     JSONB NOT NULL,\n    areas       JSONB NOT NULL,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (store_id) REFERENCES stores (id)\n);\n\n-- DATA --\n\nWITH new_country AS (\n    INSERT INTO countries (name)\n    VALUES ('Kazakhstan')\n    RETURNING id\n)\n\nINSERT INTO cities (country_id, name, geocenter)\nSELECT id, 'Almaty', '43.238949, 76.889709' FROM new_country;\n\nINSERT INTO currencies (country_id, sign, decimals, prefix)\nVALUES (country_id, '₸', 0, FALSE);\n\nCOMMIT; (details: pq: column \"country_id\" does not exist)\n\t* pq: current transaction is aborted, commands ignored until end of transaction block in line 0: SELECT pg_advisory_unlock($1)\n\n","stacktrace":"warehouse-service/internal/app.Run\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/internal/app/app.go:44\nmain.main\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/main.go:8\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:250"}
{"level":"warn","ts":1687843819.006646,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"error","ts":1687843819.132176,"caller":"app/app.go:44","msg":"ERR_INIT_REPOSITORY","error":"2 errors occurred:\n\t* migration failed: relation \"new_country\" does not exist (column 31) in line 84: BEGIN;\n\n-- EXTENSIONS --\nCREATE EXTENSION IF NOT EXISTS pgcrypto;\n\n-- TABLES --\nCREATE TABLE IF NOT EXISTS countries (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    name        VARCHAR NOT NULL UNIQUE\n);\n\nCREATE TABLE IF NOT EXISTS cities (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n\tcountry_id  UUID NOT NULL,\n    name        VARCHAR NOT NULL UNIQUE,\n    geocenter   VARCHAR NOT NULL,\n    FOREIGN KEY (country_id) REFERENCES countries (id)\n);\n\nCREATE TABLE IF NOT EXISTS currencies (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    country_id  UUID NOT NULL,\n    sign        VARCHAR NOT NULL UNIQUE,\n    decimals    INTEGER NOT NULL,\n    prefix      BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (country_id) REFERENCES cities (id)\n);\n\n\nCREATE TABLE IF NOT EXISTS stores (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    merchant_id VARCHAR NOT NULL,\n    city_id     UUID NOT NULL,\n    name        VARCHAR NOT NULL,\n\taddress     VARCHAR NOT NULL,\n    location    VARCHAR NOT NULL,\n\trating      NUMERIC NOT NULL DEFAULT 0,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (city_id) REFERENCES cities (id)\n\n);\n\nCREATE TABLE IF NOT EXISTS schedules (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    store_id    UUID NOT NULL UNIQUE,\n    periods     JSONB NOT NULL,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (store_id) REFERENCES stores (id)\n);\n\nCREATE TABLE IF NOT EXISTS deliveries (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    store_id    UUID NOT NULL UNIQUE,\n    periods     JSONB NOT NULL,\n    areas       JSONB NOT NULL,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (store_id) REFERENCES stores (id)\n);\n\n-- DATA --\n\nWITH new_country AS (\n    INSERT INTO countries (name)\n    VALUES ('Kazakhstan')\n    RETURNING id\n)\n\nINSERT INTO cities (country_id, name, geocenter)\nSELECT id, 'Almaty', '43.238949, 76.889709' FROM new_country;\n\nINSERT INTO currencies (country_id, sign, decimals, prefix)\nSELECT id, '₸', 0, FALSE FROM new_country;\n\nCOMMIT; (details: pq: relation \"new_country\" does not exist)\n\t* pq: current transaction is aborted, commands ignored until end of transaction block in line 0: SELECT pg_advisory_unlock($1)\n\n","stacktrace":"warehouse-service/internal/app.Run\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/internal/app/app.go:44\nmain.main\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/main.go:8\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:250"}
{"level":"warn","ts":1687843879.206503,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"error","ts":1687843879.2915132,"caller":"app/app.go:44","msg":"ERR_INIT_REPOSITORY","error":"migration failed: syntax error at or near \"INTO\" (column 8) in line 83: BEGIN;\n\n-- EXTENSIONS --\nCREATE EXTENSION IF NOT EXISTS pgcrypto;\n\n-- TABLES --\nCREATE TABLE IF NOT EXISTS countries (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    name        VARCHAR NOT NULL UNIQUE\n);\n\nCREATE TABLE IF NOT EXISTS cities (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n\tcountry_id  UUID NOT NULL,\n    name        VARCHAR NOT NULL UNIQUE,\n    geocenter   VARCHAR NOT NULL,\n    FOREIGN KEY (country_id) REFERENCES countries (id)\n);\n\nCREATE TABLE IF NOT EXISTS currencies (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    country_id  UUID NOT NULL,\n    sign        VARCHAR NOT NULL UNIQUE,\n    decimals    INTEGER NOT NULL,\n    prefix      BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (country_id) REFERENCES cities (id)\n);\n\n\nCREATE TABLE IF NOT EXISTS stores (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    merchant_id VARCHAR NOT NULL,\n    city_id     UUID NOT NULL,\n    name        VARCHAR NOT NULL,\n\taddress     VARCHAR NOT NULL,\n    location    VARCHAR NOT NULL,\n\trating      NUMERIC NOT NULL DEFAULT 0,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (city_id) REFERENCES cities (id)\n\n);\n\nCREATE TABLE IF NOT EXISTS schedules (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    store_id    UUID NOT NULL UNIQUE,\n    periods     JSONB NOT NULL,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (store_id) REFERENCES stores (id)\n);\n\nCREATE TABLE IF NOT EXISTS deliveries (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    store_id    UUID NOT NULL UNIQUE,\n    periods     JSONB NOT NULL,\n    areas       JSONB NOT NULL,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (store_id) REFERENCES stores (id)\n);\n\n-- DATA --\n\nWITH new_country AS (\n    INSERT INTO countries (name)\n    VALUES ('Kazakhstan')\n    RETURNING id\n)\n\nINSERT INTO cities (country_id, name, geocenter)\nSELECT id, 'Almaty', '43.238949, 76.889709' FROM new_country\n\nINSERT INTO currencies (country_id, sign, decimals, prefix)\nSELECT id, '₸', 0, FALSE FROM new_country;\n\nCOMMIT; (details: pq: syntax error at or near \"INTO\")","stacktrace":"warehouse-service/internal/app.Run\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/internal/app/app.go:44\nmain.main\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/main.go:8\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:250"}
{"level":"warn","ts":1687843970.542439,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"error","ts":1687843970.674947,"caller":"app/app.go:44","msg":"ERR_INIT_REPOSITORY","error":"2 errors occurred:\n\t* migration failed: relation \"new_country\" does not exist (column 31) in line 83: BEGIN;\n\n-- EXTENSIONS --\nCREATE EXTENSION IF NOT EXISTS pgcrypto;\n\n-- TABLES --\nCREATE TABLE IF NOT EXISTS countries (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    name        VARCHAR NOT NULL UNIQUE\n);\n\nCREATE TABLE IF NOT EXISTS cities (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n\tcountry_id  UUID NOT NULL,\n    name        VARCHAR NOT NULL UNIQUE,\n    geocenter   VARCHAR NOT NULL,\n    FOREIGN KEY (country_id) REFERENCES countries (id)\n);\n\nCREATE TABLE IF NOT EXISTS currencies (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    country_id  UUID NOT NULL,\n    sign        VARCHAR NOT NULL UNIQUE,\n    decimals    INTEGER NOT NULL,\n    prefix      BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (country_id) REFERENCES cities (id)\n);\n\n\nCREATE TABLE IF NOT EXISTS stores (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    merchant_id VARCHAR NOT NULL,\n    city_id     UUID NOT NULL,\n    name        VARCHAR NOT NULL,\n\taddress     VARCHAR NOT NULL,\n    location    VARCHAR NOT NULL,\n\trating      NUMERIC NOT NULL DEFAULT 0,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (city_id) REFERENCES cities (id)\n\n);\n\nCREATE TABLE IF NOT EXISTS schedules (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    store_id    UUID NOT NULL UNIQUE,\n    periods     JSONB NOT NULL,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (store_id) REFERENCES stores (id)\n);\n\nCREATE TABLE IF NOT EXISTS deliveries (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    store_id    UUID NOT NULL UNIQUE,\n    periods     JSONB NOT NULL,\n    areas       JSONB NOT NULL,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (store_id) REFERENCES stores (id)\n);\n\n-- DATA --\n\nWITH new_country AS (\n    INSERT INTO countries (name)\n    VALUES ('Kazakhstan')\n    RETURNING id\n)\nINSERT INTO cities (country_id, name, geocenter)\nSELECT id, 'Almaty', '43.238949, 76.889709' FROM new_country;\n\nINSERT INTO currencies (country_id, sign, decimals, prefix)\nSELECT id, '₸', 0, FALSE FROM new_country;\n\nCOMMIT; (details: pq: relation \"new_country\" does not exist)\n\t* pq: current transaction is aborted, commands ignored until end of transaction block in line 0: SELECT pg_advisory_unlock($1)\n\n","stacktrace":"warehouse-service/internal/app.Run\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/internal/app/app.go:44\nmain.main\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/main.go:8\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:250"}
{"level":"warn","ts":1687844195.6953778,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"error","ts":1687844195.7875462,"caller":"app/app.go:44","msg":"ERR_INIT_REPOSITORY","error":"migration failed: syntax error at or near \";\" (column 2) in line 78: BEGIN;\n\n-- EXTENSIONS --\nCREATE EXTENSION IF NOT EXISTS pgcrypto;\n\n-- TABLES --\nCREATE TABLE IF NOT EXISTS countries (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    name        VARCHAR NOT NULL UNIQUE\n);\n\nCREATE TABLE IF NOT EXISTS cities (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n\tcountry_id  UUID NOT NULL,\n    name        VARCHAR NOT NULL UNIQUE,\n    geocenter   VARCHAR NOT NULL,\n    FOREIGN KEY (country_id) REFERENCES countries (id)\n);\n\nCREATE TABLE IF NOT EXISTS currencies (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    country_id  UUID NOT NULL,\n    sign        VARCHAR NOT NULL UNIQUE,\n    decimals    INTEGER NOT NULL,\n    prefix      BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (country_id) REFERENCES cities (id)\n);\n\n\nCREATE TABLE IF NOT EXISTS stores (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    merchant_id VARCHAR NOT NULL,\n    city_id     UUID NOT NULL,\n    name        VARCHAR NOT NULL,\n\taddress     VARCHAR NOT NULL,\n    location    VARCHAR NOT NULL,\n\trating      NUMERIC NOT NULL DEFAULT 0,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (city_id) REFERENCES cities (id)\n\n);\n\nCREATE TABLE IF NOT EXISTS schedules (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    store_id    UUID NOT NULL UNIQUE,\n    periods     JSONB NOT NULL,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (store_id) REFERENCES stores (id)\n);\n\nCREATE TABLE IF NOT EXISTS deliveries (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    store_id    UUID NOT NULL UNIQUE,\n    periods     JSONB NOT NULL,\n    areas       JSONB NOT NULL,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (store_id) REFERENCES stores (id)\n);\n\n-- DATA --\n\nWITH new_country AS (\n    INSERT INTO countries (name)\n    VALUES ('Kazakhstan')\n    RETURNING id\n);\n\nINSERT INTO cities (country_id, name, geocenter)\nSELECT id, 'Almaty', '43.238949, 76.889709' FROM new_country;\n\nINSERT INTO currencies (country_id, sign, decimals, prefix)\nSELECT id, '₸', 0, FALSE FROM new_country;\n\nCOMMIT; (details: pq: syntax error at or near \";\")","stacktrace":"warehouse-service/internal/app.Run\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/internal/app/app.go:44\nmain.main\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/main.go:8\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:250"}
{"level":"warn","ts":1687844215.556761,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"error","ts":1687844215.6374369,"caller":"app/app.go:44","msg":"ERR_INIT_REPOSITORY","error":"migration failed: syntax error at or near \";\" (column 1) in line 79: BEGIN;\n\n-- EXTENSIONS --\nCREATE EXTENSION IF NOT EXISTS pgcrypto;\n\n-- TABLES --\nCREATE TABLE IF NOT EXISTS countries (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    name        VARCHAR NOT NULL UNIQUE\n);\n\nCREATE TABLE IF NOT EXISTS cities (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n\tcountry_id  UUID NOT NULL,\n    name        VARCHAR NOT NULL UNIQUE,\n    geocenter   VARCHAR NOT NULL,\n    FOREIGN KEY (country_id) REFERENCES countries (id)\n);\n\nCREATE TABLE IF NOT EXISTS currencies (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    country_id  UUID NOT NULL,\n    sign        VARCHAR NOT NULL UNIQUE,\n    decimals    INTEGER NOT NULL,\n    prefix      BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (country_id) REFERENCES cities (id)\n);\n\n\nCREATE TABLE IF NOT EXISTS stores (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    merchant_id VARCHAR NOT NULL,\n    city_id     UUID NOT NULL,\n    name        VARCHAR NOT NULL,\n\taddress     VARCHAR NOT NULL,\n    location    VARCHAR NOT NULL,\n\trating      NUMERIC NOT NULL DEFAULT 0,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (city_id) REFERENCES cities (id)\n\n);\n\nCREATE TABLE IF NOT EXISTS schedules (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    store_id    UUID NOT NULL UNIQUE,\n    periods     JSONB NOT NULL,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (store_id) REFERENCES stores (id)\n);\n\nCREATE TABLE IF NOT EXISTS deliveries (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    store_id    UUID NOT NULL UNIQUE,\n    periods     JSONB NOT NULL,\n    areas       JSONB NOT NULL,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (store_id) REFERENCES stores (id)\n);\n\n-- DATA --\n\nWITH new_country AS (\n    INSERT INTO countries (name)\n    VALUES ('Kazakhstan')\n    RETURNING id\n)\n;\n\nINSERT INTO cities (country_id, name, geocenter)\nSELECT id, 'Almaty', '43.238949, 76.889709' FROM new_country;\n\nINSERT INTO currencies (country_id, sign, decimals, prefix)\nSELECT id, '₸', 0, FALSE FROM new_country;\n\nCOMMIT; (details: pq: syntax error at or near \";\")","stacktrace":"warehouse-service/internal/app.Run\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/internal/app/app.go:44\nmain.main\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/main.go:8\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:250"}
{"level":"warn","ts":1687844334.449972,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"error","ts":1687844334.5401878,"caller":"app/app.go:44","msg":"ERR_INIT_REPOSITORY","error":"migration failed: syntax error at or near \"INSERT\" (column 5) in line 74: BEGIN;\n\n-- EXTENSIONS --\nCREATE EXTENSION IF NOT EXISTS pgcrypto;\n\n-- TABLES --\nCREATE TABLE IF NOT EXISTS countries (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    name        VARCHAR NOT NULL UNIQUE\n);\n\nCREATE TABLE IF NOT EXISTS cities (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n\tcountry_id  UUID NOT NULL,\n    name        VARCHAR NOT NULL UNIQUE,\n    geocenter   VARCHAR NOT NULL,\n    FOREIGN KEY (country_id) REFERENCES countries (id)\n);\n\nCREATE TABLE IF NOT EXISTS currencies (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    country_id  UUID NOT NULL,\n    sign        VARCHAR NOT NULL UNIQUE,\n    decimals    INTEGER NOT NULL,\n    prefix      BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (country_id) REFERENCES cities (id)\n);\n\n\nCREATE TABLE IF NOT EXISTS stores (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    merchant_id VARCHAR NOT NULL,\n    city_id     UUID NOT NULL,\n    name        VARCHAR NOT NULL,\n\taddress     VARCHAR NOT NULL,\n    location    VARCHAR NOT NULL,\n\trating      NUMERIC NOT NULL DEFAULT 0,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (city_id) REFERENCES cities (id)\n\n);\n\nCREATE TABLE IF NOT EXISTS schedules (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    store_id    UUID NOT NULL UNIQUE,\n    periods     JSONB NOT NULL,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (store_id) REFERENCES stores (id)\n);\n\nCREATE TABLE IF NOT EXISTS deliveries (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    store_id    UUID NOT NULL UNIQUE,\n    periods     JSONB NOT NULL,\n    areas       JSONB NOT NULL,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (store_id) REFERENCES stores (id)\n);\n\n-- DATA --\nCREATE TEMPORARY TABLE new_country AS (\n    INSERT INTO countries (name)\n    VALUES ('Kazakhstan')\n    RETURNING id\n);\n\nINSERT INTO cities (country_id, name, geocenter)\nSELECT id, 'Almaty', '43.238949, 76.889709' FROM new_country;\n\nINSERT INTO currencies (country_id, sign, decimals, prefix)\nSELECT id, '₸', 0, FALSE FROM new_country;\n\n\nCOMMIT; (details: pq: syntax error at or near \"INSERT\")","stacktrace":"warehouse-service/internal/app.Run\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/internal/app/app.go:44\nmain.main\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/main.go:8\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:250"}
{"level":"warn","ts":1687844698.4579892,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"error","ts":1687844698.558846,"caller":"app/app.go:44","msg":"ERR_INIT_REPOSITORY","error":"migration failed: syntax error at or near \"countries\" (column 20) in line 73: BEGIN;\n\n-- EXTENSIONS --\nCREATE EXTENSION IF NOT EXISTS pgcrypto;\n\n-- TABLES --\nCREATE TABLE IF NOT EXISTS countries (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    name        VARCHAR NOT NULL UNIQUE\n);\n\nCREATE TABLE IF NOT EXISTS cities (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n\tcountry_id  UUID NOT NULL,\n    name        VARCHAR NOT NULL UNIQUE,\n    geocenter   VARCHAR NOT NULL,\n    FOREIGN KEY (country_id) REFERENCES countries (id)\n);\n\nCREATE TABLE IF NOT EXISTS currencies (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    country_id  UUID NOT NULL,\n    sign        VARCHAR NOT NULL UNIQUE,\n    decimals    INTEGER NOT NULL,\n    prefix      BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (country_id) REFERENCES cities (id)\n);\n\n\nCREATE TABLE IF NOT EXISTS stores (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    merchant_id VARCHAR NOT NULL,\n    city_id     UUID NOT NULL,\n    name        VARCHAR NOT NULL,\n\taddress     VARCHAR NOT NULL,\n    location    VARCHAR NOT NULL,\n\trating      NUMERIC NOT NULL DEFAULT 0,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (city_id) REFERENCES cities (id)\n\n);\n\nCREATE TABLE IF NOT EXISTS schedules (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    store_id    UUID NOT NULL UNIQUE,\n    periods     JSONB NOT NULL,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (store_id) REFERENCES stores (id)\n);\n\nCREATE TABLE IF NOT EXISTS deliveries (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    store_id    UUID NOT NULL UNIQUE,\n    periods     JSONB NOT NULL,\n    areas       JSONB NOT NULL,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (store_id) REFERENCES stores (id)\n);\n\n-- DATA --\nDECLARE country_id countries.id%TYPE;\n\nINSERT INTO countries (name)\nVALUES ('Kazakhstan')\nRETURNING id INTO country_id;\n\nINSERT INTO cities (country_id, name, geocenter)\nVALUES (country_id, 'Almaty', '43.238949, 76.889709');\n\nINSERT INTO currencies (country_id, sign, decimals, prefix)\nVALUES (country_id, '₸', 0, FALSE);\n\nCOMMIT; (details: pq: syntax error at or near \"countries\")","stacktrace":"warehouse-service/internal/app.Run\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/internal/app/app.go:44\nmain.main\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/main.go:8\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:250"}
{"level":"warn","ts":1687844897.3153,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"error","ts":1687844897.4112918,"caller":"app/app.go:44","msg":"ERR_INIT_REPOSITORY","error":"migration failed: syntax error at or near \"DECLARE\" (column 5) in line 78: DO $$\n\nBEGIN;\n\n-- EXTENSIONS --\nCREATE EXTENSION IF NOT EXISTS pgcrypto;\n\n-- TABLES --\nCREATE TABLE IF NOT EXISTS countries (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    name        VARCHAR NOT NULL UNIQUE\n);\n\nCREATE TABLE IF NOT EXISTS cities (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n\tcountry_id  UUID NOT NULL,\n    name        VARCHAR NOT NULL UNIQUE,\n    geocenter   VARCHAR NOT NULL,\n    FOREIGN KEY (country_id) REFERENCES countries (id)\n);\n\nCREATE TABLE IF NOT EXISTS currencies (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    country_id  UUID NOT NULL,\n    sign        VARCHAR NOT NULL UNIQUE,\n    decimals    INTEGER NOT NULL,\n    prefix      BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (country_id) REFERENCES cities (id)\n);\n\n\nCREATE TABLE IF NOT EXISTS stores (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    merchant_id VARCHAR NOT NULL,\n    city_id     UUID NOT NULL,\n    name        VARCHAR NOT NULL,\n\taddress     VARCHAR NOT NULL,\n    location    VARCHAR NOT NULL,\n\trating      NUMERIC NOT NULL DEFAULT 0,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (city_id) REFERENCES cities (id)\n\n);\n\nCREATE TABLE IF NOT EXISTS schedules (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    store_id    UUID NOT NULL UNIQUE,\n    periods     JSONB NOT NULL,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (store_id) REFERENCES stores (id)\n);\n\nCREATE TABLE IF NOT EXISTS deliveries (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    store_id    UUID NOT NULL UNIQUE,\n    periods     JSONB NOT NULL,\n    areas       JSONB NOT NULL,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (store_id) REFERENCES stores (id)\n);\n\nCOMMIT;\n\n-- DATA --\nDO $$\n    DECLARE country_id countries.id%TYPE;\n\nBEGIN\n    INSERT INTO countries (name)\n    VALUES ('Kazakhstan')\n    RETURNING id INTO country_id;\n\n    INSERT INTO cities (country_id, name, geocenter)\n    VALUES (country_id, 'Almaty', '43.238949, 76.889709');\n\n    INSERT INTO currencies (country_id, sign, decimals, prefix)\n    VALUES (country_id, '₸', 0, FALSE);\nEND $$ (details: pq: syntax error at or near \"DECLARE\")","stacktrace":"warehouse-service/internal/app.Run\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/internal/app/app.go:44\nmain.main\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/main.go:8\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:250"}
{"level":"warn","ts":1687844938.163042,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"error","ts":1687844938.265715,"caller":"app/app.go:44","msg":"ERR_INIT_REPOSITORY","error":"migration failed: syntax error at or near \"DECLARE\" (column 5) in line 78: DO $$\n\nBEGIN;\n\n-- EXTENSIONS --\nCREATE EXTENSION IF NOT EXISTS pgcrypto;\n\n-- TABLES --\nCREATE TABLE IF NOT EXISTS countries (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    name        VARCHAR NOT NULL UNIQUE\n);\n\nCREATE TABLE IF NOT EXISTS cities (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n\tcountry_id  UUID NOT NULL,\n    name        VARCHAR NOT NULL UNIQUE,\n    geocenter   VARCHAR NOT NULL,\n    FOREIGN KEY (country_id) REFERENCES countries (id)\n);\n\nCREATE TABLE IF NOT EXISTS currencies (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    country_id  UUID NOT NULL,\n    sign        VARCHAR NOT NULL UNIQUE,\n    decimals    INTEGER NOT NULL,\n    prefix      BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (country_id) REFERENCES cities (id)\n);\n\n\nCREATE TABLE IF NOT EXISTS stores (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    merchant_id VARCHAR NOT NULL,\n    city_id     UUID NOT NULL,\n    name        VARCHAR NOT NULL,\n\taddress     VARCHAR NOT NULL,\n    location    VARCHAR NOT NULL,\n\trating      NUMERIC NOT NULL DEFAULT 0,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (city_id) REFERENCES cities (id)\n\n);\n\nCREATE TABLE IF NOT EXISTS schedules (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    store_id    UUID NOT NULL UNIQUE,\n    periods     JSONB NOT NULL,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (store_id) REFERENCES stores (id)\n);\n\nCREATE TABLE IF NOT EXISTS deliveries (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    store_id    UUID NOT NULL UNIQUE,\n    periods     JSONB NOT NULL,\n    areas       JSONB NOT NULL,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (store_id) REFERENCES stores (id)\n);\n\nCOMMIT;\n\n-- DATA --\nDO $$\n    DECLARE country_id UUID;\n\nBEGIN\n    INSERT INTO countries (name)\n    VALUES ('Kazakhstan')\n    RETURNING id INTO country_id;\n\n    INSERT INTO cities (country_id, name, geocenter)\n    VALUES (country_id, 'Almaty', '43.238949, 76.889709');\n\n    INSERT INTO currencies (country_id, sign, decimals, prefix)\n    VALUES (country_id, '₸', 0, FALSE);\nEND $$ (details: pq: syntax error at or near \"DECLARE\")","stacktrace":"warehouse-service/internal/app.Run\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/internal/app/app.go:44\nmain.main\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/main.go:8\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:250"}
{"level":"warn","ts":1687845015.8616629,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"error","ts":1687845015.9476092,"caller":"app/app.go:44","msg":"ERR_INIT_REPOSITORY","error":"migration failed: unterminated dollar-quoted string at or near \"$$\n\nBEGIN;\n\n-- EXTENSIONS --\nCREATE EXTENSION IF NOT EXISTS pgcrypto;\n\n-- TABLES --\nCREATE TABLE IF NOT EXISTS countries (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    name        VARCHAR NOT NULL UNIQUE\n);\n\nCREATE TABLE IF NOT EXISTS cities (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n\tcountry_id  UUID NOT NULL,\n    name        VARCHAR NOT NULL UNIQUE,\n    geocenter   VARCHAR NOT NULL,\n    FOREIGN KEY (country_id) REFERENCES countries (id)\n);\n\nCREATE TABLE IF NOT EXISTS currencies (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    country_id  UUID NOT NULL,\n    sign        VARCHAR NOT NULL UNIQUE,\n    decimals    INTEGER NOT NULL,\n    prefix      BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (country_id) REFERENCES cities (id)\n);\n\n\nCREATE TABLE IF NOT EXISTS stores (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    merchant_id VARCHAR NOT NULL,\n    city_id     UUID NOT NULL,\n    name        VARCHAR NOT NULL,\n\taddress     VARCHAR NOT NULL,\n    location    VARCHAR NOT NULL,\n\trating      NUMERIC NOT NULL DEFAULT 0,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (city_id) REFERENCES cities (id)\n\n);\n\nCREATE TABLE IF NOT EXISTS schedules (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    store_id    UUID NOT NULL UNIQUE,\n    periods     JSONB NOT NULL,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (store_id) REFERENCES stores (id)\n);\n\nCREATE TABLE IF NOT EXISTS deliveries (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    store_id    UUID NOT NULL UNIQUE,\n    periods     JSONB NOT NULL,\n    areas       JSONB NOT NULL,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (store_id) REFERENCES stores (id)\n);\n\n-- DATA --\nINSERT INTO countries (name)\nVALUES ('Kazakhstan')\nRETURNING id INTO country_id;\n\nINSERT INTO cities (country_id, name, geocenter)\nVALUES (country_id, 'Almaty', '43.238949, 76.889709');\n\nINSERT INTO currencies (country_id, sign, decimals, prefix)\nVALUES (country_id, '₸', 0, FALSE);\n\nCOMMIT;\n\" (column 4) in line 1: DO $$\n\nBEGIN;\n\n-- EXTENSIONS --\nCREATE EXTENSION IF NOT EXISTS pgcrypto;\n\n-- TABLES --\nCREATE TABLE IF NOT EXISTS countries (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    name        VARCHAR NOT NULL UNIQUE\n);\n\nCREATE TABLE IF NOT EXISTS cities (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n\tcountry_id  UUID NOT NULL,\n    name        VARCHAR NOT NULL UNIQUE,\n    geocenter   VARCHAR NOT NULL,\n    FOREIGN KEY (country_id) REFERENCES countries (id)\n);\n\nCREATE TABLE IF NOT EXISTS currencies (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    country_id  UUID NOT NULL,\n    sign        VARCHAR NOT NULL UNIQUE,\n    decimals    INTEGER NOT NULL,\n    prefix      BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (country_id) REFERENCES cities (id)\n);\n\n\nCREATE TABLE IF NOT EXISTS stores (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    merchant_id VARCHAR NOT NULL,\n    city_id     UUID NOT NULL,\n    name        VARCHAR NOT NULL,\n\taddress     VARCHAR NOT NULL,\n    location    VARCHAR NOT NULL,\n\trating      NUMERIC NOT NULL DEFAULT 0,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (city_id) REFERENCES cities (id)\n\n);\n\nCREATE TABLE IF NOT EXISTS schedules (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    store_id    UUID NOT NULL UNIQUE,\n    periods     JSONB NOT NULL,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (store_id) REFERENCES stores (id)\n);\n\nCREATE TABLE IF NOT EXISTS deliveries (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    store_id    UUID NOT NULL UNIQUE,\n    periods     JSONB NOT NULL,\n    areas       JSONB NOT NULL,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (store_id) REFERENCES stores (id)\n);\n\n-- DATA --\nINSERT INTO countries (name)\nVALUES ('Kazakhstan')\nRETURNING id INTO country_id;\n\nINSERT INTO cities (country_id, name, geocenter)\nVALUES (country_id, 'Almaty', '43.238949, 76.889709');\n\nINSERT INTO currencies (country_id, sign, decimals, prefix)\nVALUES (country_id, '₸', 0, FALSE);\n\nCOMMIT;\n (details: pq: unterminated dollar-quoted string at or near \"$$\n\nBEGIN;\n\n-- EXTENSIONS --\nCREATE EXTENSION IF NOT EXISTS pgcrypto;\n\n-- TABLES --\nCREATE TABLE IF NOT EXISTS countries (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    name        VARCHAR NOT NULL UNIQUE\n);\n\nCREATE TABLE IF NOT EXISTS cities (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n\tcountry_id  UUID NOT NULL,\n    name        VARCHAR NOT NULL UNIQUE,\n    geocenter   VARCHAR NOT NULL,\n    FOREIGN KEY (country_id) REFERENCES countries (id)\n);\n\nCREATE TABLE IF NOT EXISTS currencies (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    country_id  UUID NOT NULL,\n    sign        VARCHAR NOT NULL UNIQUE,\n    decimals    INTEGER NOT NULL,\n    prefix      BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (country_id) REFERENCES cities (id)\n);\n\n\nCREATE TABLE IF NOT EXISTS stores (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    merchant_id VARCHAR NOT NULL,\n    city_id     UUID NOT NULL,\n    name        VARCHAR NOT NULL,\n\taddress     VARCHAR NOT NULL,\n    location    VARCHAR NOT NULL,\n\trating      NUMERIC NOT NULL DEFAULT 0,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (city_id) REFERENCES cities (id)\n\n);\n\nCREATE TABLE IF NOT EXISTS schedules (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    store_id    UUID NOT NULL UNIQUE,\n    periods     JSONB NOT NULL,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (store_id) REFERENCES stores (id)\n);\n\nCREATE TABLE IF NOT EXISTS deliveries (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    store_id    UUID NOT NULL UNIQUE,\n    periods     JSONB NOT NULL,\n    areas       JSONB NOT NULL,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (store_id) REFERENCES stores (id)\n);\n\n-- DATA --\nINSERT INTO countries (name)\nVALUES ('Kazakhstan')\nRETURNING id INTO country_id;\n\nINSERT INTO cities (country_id, name, geocenter)\nVALUES (country_id, 'Almaty', '43.238949, 76.889709');\n\nINSERT INTO currencies (country_id, sign, decimals, prefix)\nVALUES (country_id, '₸', 0, FALSE);\n\nCOMMIT;\n\")","stacktrace":"warehouse-service/internal/app.Run\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/internal/app/app.go:44\nmain.main\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/main.go:8\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:250"}
{"level":"warn","ts":1687845038.406552,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"error","ts":1687845038.5136268,"caller":"app/app.go:44","msg":"ERR_INIT_REPOSITORY","error":"migration failed: syntax error at or near \"INTO\" (column 14) in line 75: BEGIN;\n\n-- EXTENSIONS --\nCREATE EXTENSION IF NOT EXISTS pgcrypto;\n\n-- TABLES --\nCREATE TABLE IF NOT EXISTS countries (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    name        VARCHAR NOT NULL UNIQUE\n);\n\nCREATE TABLE IF NOT EXISTS cities (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n\tcountry_id  UUID NOT NULL,\n    name        VARCHAR NOT NULL UNIQUE,\n    geocenter   VARCHAR NOT NULL,\n    FOREIGN KEY (country_id) REFERENCES countries (id)\n);\n\nCREATE TABLE IF NOT EXISTS currencies (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    country_id  UUID NOT NULL,\n    sign        VARCHAR NOT NULL UNIQUE,\n    decimals    INTEGER NOT NULL,\n    prefix      BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (country_id) REFERENCES cities (id)\n);\n\n\nCREATE TABLE IF NOT EXISTS stores (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    merchant_id VARCHAR NOT NULL,\n    city_id     UUID NOT NULL,\n    name        VARCHAR NOT NULL,\n\taddress     VARCHAR NOT NULL,\n    location    VARCHAR NOT NULL,\n\trating      NUMERIC NOT NULL DEFAULT 0,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (city_id) REFERENCES cities (id)\n\n);\n\nCREATE TABLE IF NOT EXISTS schedules (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    store_id    UUID NOT NULL UNIQUE,\n    periods     JSONB NOT NULL,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (store_id) REFERENCES stores (id)\n);\n\nCREATE TABLE IF NOT EXISTS deliveries (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    store_id    UUID NOT NULL UNIQUE,\n    periods     JSONB NOT NULL,\n    areas       JSONB NOT NULL,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (store_id) REFERENCES stores (id)\n);\n\n-- DATA --\nINSERT INTO countries (name)\nVALUES ('Kazakhstan')\nRETURNING id INTO country_id;\n\nINSERT INTO cities (country_id, name, geocenter)\nVALUES (country_id, 'Almaty', '43.238949, 76.889709');\n\nINSERT INTO currencies (country_id, sign, decimals, prefix)\nVALUES (country_id, '₸', 0, FALSE);\n\nCOMMIT;\n (details: pq: syntax error at or near \"INTO\")","stacktrace":"warehouse-service/internal/app.Run\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/internal/app/app.go:44\nmain.main\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/main.go:8\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:250"}
{"level":"warn","ts":1687845221.425384,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"error","ts":1687845221.513813,"caller":"app/app.go:44","msg":"ERR_INIT_REPOSITORY","error":"migration failed: syntax error at or near \"(\" (column 38) in line 73: BEGIN;\n\n-- EXTENSIONS --\nCREATE EXTENSION IF NOT EXISTS pgcrypto;\n\n-- TABLES --\nCREATE TABLE IF NOT EXISTS countries (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    name        VARCHAR NOT NULL UNIQUE\n);\n\nCREATE TABLE IF NOT EXISTS cities (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n\tcountry_id  UUID NOT NULL,\n    name        VARCHAR NOT NULL UNIQUE,\n    geocenter   VARCHAR NOT NULL,\n    FOREIGN KEY (country_id) REFERENCES countries (id)\n);\n\nCREATE TABLE IF NOT EXISTS currencies (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    country_id  UUID NOT NULL,\n    sign        VARCHAR NOT NULL UNIQUE,\n    decimals    INTEGER NOT NULL,\n    prefix      BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (country_id) REFERENCES cities (id)\n);\n\n\nCREATE TABLE IF NOT EXISTS stores (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    merchant_id VARCHAR NOT NULL,\n    city_id     UUID NOT NULL,\n    name        VARCHAR NOT NULL,\n\taddress     VARCHAR NOT NULL,\n    location    VARCHAR NOT NULL,\n\trating      NUMERIC NOT NULL DEFAULT 0,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (city_id) REFERENCES cities (id)\n\n);\n\nCREATE TABLE IF NOT EXISTS schedules (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    store_id    UUID NOT NULL UNIQUE,\n    periods     JSONB NOT NULL,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (store_id) REFERENCES stores (id)\n);\n\nCREATE TABLE IF NOT EXISTS deliveries (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    store_id    UUID NOT NULL UNIQUE,\n    periods     JSONB NOT NULL,\n    areas       JSONB NOT NULL,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (store_id) REFERENCES stores (id)\n);\n\n-- DATA --\nSET vars.country_id = GEN_RANDOM_UUID();\n\nINSERT INTO countries (id, name)\nVALUES (current_setting('vars.country_id'), 'Kazakhstan');\n\nINSERT INTO cities (country_id, name, geocenter)\nVALUES (current_setting('vars.country_id'), 'Almaty', '43.238949, 76.889709');\n\nINSERT INTO currencies (country_id, sign, decimals, prefix)\nVALUES (current_setting('vars.country_id'), '₸', 0, FALSE);\n\nCOMMIT;\n (details: pq: syntax error at or near \"(\")","stacktrace":"warehouse-service/internal/app.Run\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/internal/app/app.go:44\nmain.main\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/main.go:8\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:250"}
{"level":"warn","ts":1687845255.599442,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"error","ts":1687845255.729099,"caller":"app/app.go:44","msg":"ERR_INIT_REPOSITORY","error":"2 errors occurred:\n\t* migration failed: column \"id\" is of type uuid but expression is of type text (column 9) in line 76: BEGIN;\n\n-- EXTENSIONS --\nCREATE EXTENSION IF NOT EXISTS pgcrypto;\n\n-- TABLES --\nCREATE TABLE IF NOT EXISTS countries (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    name        VARCHAR NOT NULL UNIQUE\n);\n\nCREATE TABLE IF NOT EXISTS cities (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n\tcountry_id  UUID NOT NULL,\n    name        VARCHAR NOT NULL UNIQUE,\n    geocenter   VARCHAR NOT NULL,\n    FOREIGN KEY (country_id) REFERENCES countries (id)\n);\n\nCREATE TABLE IF NOT EXISTS currencies (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    country_id  UUID NOT NULL,\n    sign        VARCHAR NOT NULL UNIQUE,\n    decimals    INTEGER NOT NULL,\n    prefix      BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (country_id) REFERENCES cities (id)\n);\n\n\nCREATE TABLE IF NOT EXISTS stores (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    merchant_id VARCHAR NOT NULL,\n    city_id     UUID NOT NULL,\n    name        VARCHAR NOT NULL,\n\taddress     VARCHAR NOT NULL,\n    location    VARCHAR NOT NULL,\n\trating      NUMERIC NOT NULL DEFAULT 0,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (city_id) REFERENCES cities (id)\n\n);\n\nCREATE TABLE IF NOT EXISTS schedules (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    store_id    UUID NOT NULL UNIQUE,\n    periods     JSONB NOT NULL,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (store_id) REFERENCES stores (id)\n);\n\nCREATE TABLE IF NOT EXISTS deliveries (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    store_id    UUID NOT NULL UNIQUE,\n    periods     JSONB NOT NULL,\n    areas       JSONB NOT NULL,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (store_id) REFERENCES stores (id)\n);\n\n-- DATA --\nSET vars.country_id = GEN_RANDOM_UUID;\n\nINSERT INTO countries (id, name)\nVALUES (current_setting('vars.country_id'), 'Kazakhstan');\n\nINSERT INTO cities (country_id, name, geocenter)\nVALUES (current_setting('vars.country_id'), 'Almaty', '43.238949, 76.889709');\n\nINSERT INTO currencies (country_id, sign, decimals, prefix)\nVALUES (current_setting('vars.country_id'), '₸', 0, FALSE);\n\nCOMMIT;\n (details: pq: column \"id\" is of type uuid but expression is of type text)\n\t* pq: current transaction is aborted, commands ignored until end of transaction block in line 0: SELECT pg_advisory_unlock($1)\n\n","stacktrace":"warehouse-service/internal/app.Run\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/internal/app/app.go:44\nmain.main\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/main.go:8\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:250"}
{"level":"warn","ts":1687845364.264008,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"error","ts":1687845364.372981,"caller":"app/app.go:44","msg":"ERR_INIT_REPOSITORY","error":"migration failed: syntax error at or near \"UUID\" (column 21) in line 73: BEGIN;\n\n-- EXTENSIONS --\nCREATE EXTENSION IF NOT EXISTS pgcrypto;\n\n-- TABLES --\nCREATE TABLE IF NOT EXISTS countries (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    name        VARCHAR NOT NULL UNIQUE\n);\n\nCREATE TABLE IF NOT EXISTS cities (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n\tcountry_id  UUID NOT NULL,\n    name        VARCHAR NOT NULL UNIQUE,\n    geocenter   VARCHAR NOT NULL,\n    FOREIGN KEY (country_id) REFERENCES countries (id)\n);\n\nCREATE TABLE IF NOT EXISTS currencies (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    country_id  UUID NOT NULL,\n    sign        VARCHAR NOT NULL UNIQUE,\n    decimals    INTEGER NOT NULL,\n    prefix      BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (country_id) REFERENCES cities (id)\n);\n\n\nCREATE TABLE IF NOT EXISTS stores (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    merchant_id VARCHAR NOT NULL,\n    city_id     UUID NOT NULL,\n    name        VARCHAR NOT NULL,\n\taddress     VARCHAR NOT NULL,\n    location    VARCHAR NOT NULL,\n\trating      NUMERIC NOT NULL DEFAULT 0,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (city_id) REFERENCES cities (id)\n\n);\n\nCREATE TABLE IF NOT EXISTS schedules (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    store_id    UUID NOT NULL UNIQUE,\n    periods     JSONB NOT NULL,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (store_id) REFERENCES stores (id)\n);\n\nCREATE TABLE IF NOT EXISTS deliveries (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    store_id    UUID NOT NULL UNIQUE,\n    periods     JSONB NOT NULL,\n    areas       JSONB NOT NULL,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (store_id) REFERENCES stores (id)\n);\n\n-- DATA --\nSET vars.country_id UUID;\n\nINSERT INTO countries (name)\nVALUES ('Kazakhstan')\nRETURNING id INTO vars.country_id;\n\nINSERT INTO cities (country_id, name, geocenter)\nVALUES (current_setting('vars.country_id'), 'Almaty', '43.238949, 76.889709');\n\nINSERT INTO currencies (country_id, sign, decimals, prefix)\nVALUES (current_setting('vars.country_id'), '₸', 0, FALSE);\n\nCOMMIT;\n (details: pq: syntax error at or near \"UUID\")","stacktrace":"warehouse-service/internal/app.Run\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/internal/app/app.go:44\nmain.main\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/main.go:8\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:250"}
{"level":"warn","ts":1687845645.378146,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"error","ts":1687845645.483426,"caller":"app/app.go:44","msg":"ERR_INIT_REPOSITORY","error":"migration failed: syntax error at or near \"(\" (column 38) in line 73: BEGIN;\n\n-- EXTENSIONS --\nCREATE EXTENSION IF NOT EXISTS pgcrypto;\n\n-- TABLES --\nCREATE TABLE IF NOT EXISTS countries (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    name        VARCHAR NOT NULL UNIQUE\n);\n\nCREATE TABLE IF NOT EXISTS cities (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n\tcountry_id  UUID NOT NULL,\n    name        VARCHAR NOT NULL UNIQUE,\n    geocenter   VARCHAR NOT NULL,\n    FOREIGN KEY (country_id) REFERENCES countries (id)\n);\n\nCREATE TABLE IF NOT EXISTS currencies (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    country_id  UUID NOT NULL,\n    sign        VARCHAR NOT NULL UNIQUE,\n    decimals    INTEGER NOT NULL,\n    prefix      BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (country_id) REFERENCES cities (id)\n);\n\n\nCREATE TABLE IF NOT EXISTS stores (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    merchant_id VARCHAR NOT NULL,\n    city_id     UUID NOT NULL,\n    name        VARCHAR NOT NULL,\n\taddress     VARCHAR NOT NULL,\n    location    VARCHAR NOT NULL,\n\trating      NUMERIC NOT NULL DEFAULT 0,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (city_id) REFERENCES cities (id)\n\n);\n\nCREATE TABLE IF NOT EXISTS schedules (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    store_id    UUID NOT NULL UNIQUE,\n    periods     JSONB NOT NULL,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (store_id) REFERENCES stores (id)\n);\n\nCREATE TABLE IF NOT EXISTS deliveries (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    store_id    UUID NOT NULL UNIQUE,\n    periods     JSONB NOT NULL,\n    areas       JSONB NOT NULL,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (store_id) REFERENCES stores (id)\n);\n\n-- DATA --\nSET vars.country_id = GEN_RANDOM_UUID();\n\nINSERT INTO countries (name)\nVALUES ('Kazakhstan')\nRETURNING id INTO vars.country_id;\n\nINSERT INTO cities (country_id, name, geocenter)\nVALUES (vars.country_id, 'Almaty', '43.238949, 76.889709');\n\nINSERT INTO currencies (country_id, sign, decimals, prefix)\nVALUES (vars.country_id, '₸', 0, FALSE);\n\nCOMMIT;\n (details: pq: syntax error at or near \"(\")","stacktrace":"warehouse-service/internal/app.Run\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/internal/app/app.go:44\nmain.main\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/main.go:8\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:250"}
{"level":"warn","ts":1687845666.541641,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"error","ts":1687845666.635766,"caller":"app/app.go:44","msg":"ERR_INIT_REPOSITORY","error":"migration failed: syntax error at or near \"INTO\" (column 14) in line 77: BEGIN;\n\n-- EXTENSIONS --\nCREATE EXTENSION IF NOT EXISTS pgcrypto;\n\n-- TABLES --\nCREATE TABLE IF NOT EXISTS countries (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    name        VARCHAR NOT NULL UNIQUE\n);\n\nCREATE TABLE IF NOT EXISTS cities (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n\tcountry_id  UUID NOT NULL,\n    name        VARCHAR NOT NULL UNIQUE,\n    geocenter   VARCHAR NOT NULL,\n    FOREIGN KEY (country_id) REFERENCES countries (id)\n);\n\nCREATE TABLE IF NOT EXISTS currencies (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    country_id  UUID NOT NULL,\n    sign        VARCHAR NOT NULL UNIQUE,\n    decimals    INTEGER NOT NULL,\n    prefix      BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (country_id) REFERENCES cities (id)\n);\n\n\nCREATE TABLE IF NOT EXISTS stores (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    merchant_id VARCHAR NOT NULL,\n    city_id     UUID NOT NULL,\n    name        VARCHAR NOT NULL,\n\taddress     VARCHAR NOT NULL,\n    location    VARCHAR NOT NULL,\n\trating      NUMERIC NOT NULL DEFAULT 0,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (city_id) REFERENCES cities (id)\n\n);\n\nCREATE TABLE IF NOT EXISTS schedules (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    store_id    UUID NOT NULL UNIQUE,\n    periods     JSONB NOT NULL,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (store_id) REFERENCES stores (id)\n);\n\nCREATE TABLE IF NOT EXISTS deliveries (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    store_id    UUID NOT NULL UNIQUE,\n    periods     JSONB NOT NULL,\n    areas       JSONB NOT NULL,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (store_id) REFERENCES stores (id)\n);\n\n-- DATA --\nSET vars.country_id = GEN_RANDOM_UUID;\n\nINSERT INTO countries (name)\nVALUES ('Kazakhstan')\nRETURNING id INTO vars.country_id;\n\nINSERT INTO cities (country_id, name, geocenter)\nVALUES (vars.country_id, 'Almaty', '43.238949, 76.889709');\n\nINSERT INTO currencies (country_id, sign, decimals, prefix)\nVALUES (vars.country_id, '₸', 0, FALSE);\n\nCOMMIT;\n (details: pq: syntax error at or near \"INTO\")","stacktrace":"warehouse-service/internal/app.Run\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/internal/app/app.go:44\nmain.main\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/main.go:8\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:250"}
{"level":"warn","ts":1687846049.888721,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"error","ts":1687846049.9785962,"caller":"app/app.go:44","msg":"ERR_INIT_REPOSITORY","error":"migration failed: syntax error at or near \"countries\" (column 20) in line 73: BEGIN;\n\n-- EXTENSIONS --\nCREATE EXTENSION IF NOT EXISTS pgcrypto;\n\n-- TABLES --\nCREATE TABLE IF NOT EXISTS countries (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    name        VARCHAR NOT NULL UNIQUE\n);\n\nCREATE TABLE IF NOT EXISTS cities (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n\tcountry_id  UUID NOT NULL,\n    name        VARCHAR NOT NULL UNIQUE,\n    geocenter   VARCHAR NOT NULL,\n    FOREIGN KEY (country_id) REFERENCES countries (id)\n);\n\nCREATE TABLE IF NOT EXISTS currencies (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    country_id  UUID NOT NULL,\n    sign        VARCHAR NOT NULL UNIQUE,\n    decimals    INTEGER NOT NULL,\n    prefix      BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (country_id) REFERENCES cities (id)\n);\n\n\nCREATE TABLE IF NOT EXISTS stores (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    merchant_id VARCHAR NOT NULL,\n    city_id     UUID NOT NULL,\n    name        VARCHAR NOT NULL,\n\taddress     VARCHAR NOT NULL,\n    location    VARCHAR NOT NULL,\n\trating      NUMERIC NOT NULL DEFAULT 0,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (city_id) REFERENCES cities (id)\n\n);\n\nCREATE TABLE IF NOT EXISTS schedules (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    store_id    UUID NOT NULL UNIQUE,\n    periods     JSONB NOT NULL,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (store_id) REFERENCES stores (id)\n);\n\nCREATE TABLE IF NOT EXISTS deliveries (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    store_id    UUID NOT NULL UNIQUE,\n    periods     JSONB NOT NULL,\n    areas       JSONB NOT NULL,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (store_id) REFERENCES stores (id)\n);\n\n-- DATA --\nDECLARE country_id countries.id%TYPE;\n\nINSERT INTO countries (name)\nVALUES ('Kazakhstan')\nRETURNING id INTO country_id;\n\nINSERT INTO cities (country_id, name, geocenter)\nVALUES (country_id, 'Almaty', '43.238949, 76.889709');\n\nINSERT INTO currencies (country_id, sign, decimals, prefix)\nVALUES (country_id, '₸', 0, FALSE);\n\nCOMMIT;\n (details: pq: syntax error at or near \"countries\")","stacktrace":"warehouse-service/internal/app.Run\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/internal/app/app.go:44\nmain.main\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/main.go:8\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:250"}
{"level":"warn","ts":1687846093.030019,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"error","ts":1687846093.128448,"caller":"app/app.go:44","msg":"ERR_INIT_REPOSITORY","error":"migration failed: syntax error at or near \"warehouse\" (column 20) in line 73: BEGIN;\n\n-- EXTENSIONS --\nCREATE EXTENSION IF NOT EXISTS pgcrypto;\n\n-- TABLES --\nCREATE TABLE IF NOT EXISTS countries (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    name        VARCHAR NOT NULL UNIQUE\n);\n\nCREATE TABLE IF NOT EXISTS cities (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n\tcountry_id  UUID NOT NULL,\n    name        VARCHAR NOT NULL UNIQUE,\n    geocenter   VARCHAR NOT NULL,\n    FOREIGN KEY (country_id) REFERENCES countries (id)\n);\n\nCREATE TABLE IF NOT EXISTS currencies (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    country_id  UUID NOT NULL,\n    sign        VARCHAR NOT NULL UNIQUE,\n    decimals    INTEGER NOT NULL,\n    prefix      BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (country_id) REFERENCES cities (id)\n);\n\n\nCREATE TABLE IF NOT EXISTS stores (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    merchant_id VARCHAR NOT NULL,\n    city_id     UUID NOT NULL,\n    name        VARCHAR NOT NULL,\n\taddress     VARCHAR NOT NULL,\n    location    VARCHAR NOT NULL,\n\trating      NUMERIC NOT NULL DEFAULT 0,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (city_id) REFERENCES cities (id)\n\n);\n\nCREATE TABLE IF NOT EXISTS schedules (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    store_id    UUID NOT NULL UNIQUE,\n    periods     JSONB NOT NULL,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (store_id) REFERENCES stores (id)\n);\n\nCREATE TABLE IF NOT EXISTS deliveries (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    store_id    UUID NOT NULL UNIQUE,\n    periods     JSONB NOT NULL,\n    areas       JSONB NOT NULL,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (store_id) REFERENCES stores (id)\n);\n\n-- DATA --\nDECLARE country_id warehouse.countries.id%TYPE;\n\nINSERT INTO countries (name)\nVALUES ('Kazakhstan')\nRETURNING id INTO country_id;\n\nINSERT INTO cities (country_id, name, geocenter)\nVALUES (country_id, 'Almaty', '43.238949, 76.889709');\n\nINSERT INTO currencies (country_id, sign, decimals, prefix)\nVALUES (country_id, '₸', 0, FALSE);\n\nCOMMIT;\n (details: pq: syntax error at or near \"warehouse\")","stacktrace":"warehouse-service/internal/app.Run\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/internal/app/app.go:44\nmain.main\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/main.go:8\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:250"}
{"level":"warn","ts":1687846173.809679,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"error","ts":1687846173.904643,"caller":"app/app.go:44","msg":"ERR_INIT_REPOSITORY","error":"migration failed: syntax error at or near \"DECLARE\" (column 5) in line 76: BEGIN;\n\n-- EXTENSIONS --\nCREATE EXTENSION IF NOT EXISTS pgcrypto;\n\n-- TABLES --\nCREATE TABLE IF NOT EXISTS countries (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    name        VARCHAR NOT NULL UNIQUE\n);\n\nCREATE TABLE IF NOT EXISTS cities (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n\tcountry_id  UUID NOT NULL,\n    name        VARCHAR NOT NULL UNIQUE,\n    geocenter   VARCHAR NOT NULL,\n    FOREIGN KEY (country_id) REFERENCES countries (id)\n);\n\nCREATE TABLE IF NOT EXISTS currencies (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    country_id  UUID NOT NULL,\n    sign        VARCHAR NOT NULL UNIQUE,\n    decimals    INTEGER NOT NULL,\n    prefix      BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (country_id) REFERENCES cities (id)\n);\n\n\nCREATE TABLE IF NOT EXISTS stores (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    merchant_id VARCHAR NOT NULL,\n    city_id     UUID NOT NULL,\n    name        VARCHAR NOT NULL,\n\taddress     VARCHAR NOT NULL,\n    location    VARCHAR NOT NULL,\n\trating      NUMERIC NOT NULL DEFAULT 0,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (city_id) REFERENCES cities (id)\n\n);\n\nCREATE TABLE IF NOT EXISTS schedules (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    store_id    UUID NOT NULL UNIQUE,\n    periods     JSONB NOT NULL,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (store_id) REFERENCES stores (id)\n);\n\nCREATE TABLE IF NOT EXISTS deliveries (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    store_id    UUID NOT NULL UNIQUE,\n    periods     JSONB NOT NULL,\n    areas       JSONB NOT NULL,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (store_id) REFERENCES stores (id)\n);\n\nCOMMIT;\n\n-- DATA --\nDO\n    DECLARE country_id countries.id%TYPE;\n\nBEGIN\n    INSERT INTO countries (name)\n    VALUES ('Kazakhstan')\n    RETURNING id INTO country_id;\n\n    INSERT INTO cities (country_id, name, geocenter)\n    VALUES (country_id, 'Almaty', '43.238949, 76.889709');\n\n    INSERT INTO currencies (country_id, sign, decimals, prefix)\n    VALUES (country_id, '₸', 0, FALSE);\nEND (details: pq: syntax error at or near \"DECLARE\")","stacktrace":"warehouse-service/internal/app.Run\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/internal/app/app.go:44\nmain.main\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/main.go:8\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:250"}
{"level":"warn","ts":1687846211.844939,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"error","ts":1687846211.928745,"caller":"app/app.go:44","msg":"ERR_INIT_REPOSITORY","error":"migration failed: syntax error at or near \"DECLARE\" (column 1) in line 76: BEGIN;\n\n-- EXTENSIONS --\nCREATE EXTENSION IF NOT EXISTS pgcrypto;\n\n-- TABLES --\nCREATE TABLE IF NOT EXISTS countries (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    name        VARCHAR NOT NULL UNIQUE\n);\n\nCREATE TABLE IF NOT EXISTS cities (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n\tcountry_id  UUID NOT NULL,\n    name        VARCHAR NOT NULL UNIQUE,\n    geocenter   VARCHAR NOT NULL,\n    FOREIGN KEY (country_id) REFERENCES countries (id)\n);\n\nCREATE TABLE IF NOT EXISTS currencies (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    country_id  UUID NOT NULL,\n    sign        VARCHAR NOT NULL UNIQUE,\n    decimals    INTEGER NOT NULL,\n    prefix      BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (country_id) REFERENCES cities (id)\n);\n\n\nCREATE TABLE IF NOT EXISTS stores (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    merchant_id VARCHAR NOT NULL,\n    city_id     UUID NOT NULL,\n    name        VARCHAR NOT NULL,\n\taddress     VARCHAR NOT NULL,\n    location    VARCHAR NOT NULL,\n\trating      NUMERIC NOT NULL DEFAULT 0,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (city_id) REFERENCES cities (id)\n\n);\n\nCREATE TABLE IF NOT EXISTS schedules (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    store_id    UUID NOT NULL UNIQUE,\n    periods     JSONB NOT NULL,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (store_id) REFERENCES stores (id)\n);\n\nCREATE TABLE IF NOT EXISTS deliveries (\n    created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n    store_id    UUID NOT NULL UNIQUE,\n    periods     JSONB NOT NULL,\n    areas       JSONB NOT NULL,\n    is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n    FOREIGN KEY (store_id) REFERENCES stores (id)\n);\n\nCOMMIT;\n\n-- DATA --\nDO\nDECLARE\n    country_id countries.id%TYPE;\nBEGIN\n    INSERT INTO countries (name)\n    VALUES ('Kazakhstan')\n    RETURNING id INTO country_id;\n\n    INSERT INTO cities (country_id, name, geocenter)\n    VALUES (country_id, 'Almaty', '43.238949, 76.889709');\n\n    INSERT INTO currencies (country_id, sign, decimals, prefix)\n    VALUES (country_id, '₸', 0, FALSE);\nEND (details: pq: syntax error at or near \"DECLARE\")","stacktrace":"warehouse-service/internal/app.Run\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/internal/app/app.go:44\nmain.main\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/main.go:8\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:250"}
{"level":"warn","ts":1687847764.687925,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"error","ts":1687847764.779187,"caller":"app/app.go:44","msg":"ERR_INIT_REPOSITORY","error":"Dirty database version 1. Fix and force version.","stacktrace":"warehouse-service/internal/app.Run\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/internal/app/app.go:44\nmain.main\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/main.go:8\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:250"}
{"level":"warn","ts":1687847784.8831282,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"error","ts":1687847785.0259168,"caller":"app/app.go:44","msg":"ERR_INIT_REPOSITORY","error":"2 errors occurred:\n\t* transaction start failed in line 0:  (details: pq: unexpected transaction status idle in transaction)\n\t* driver: bad connection in line 0: SELECT pg_advisory_unlock($1)\n\n","stacktrace":"warehouse-service/internal/app.Run\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/internal/app/app.go:44\nmain.main\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/main.go:8\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:250"}
{"level":"warn","ts":1687848095.61153,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"info","ts":1687848095.7607129,"caller":"server/server.go:47","msg":"http server started on http://localhost:80"}
{"level":"warn","ts":1687848735.542858,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"info","ts":1687848735.634241,"caller":"server/server.go:47","msg":"http server started on http://localhost:80"}
{"level":"warn","ts":1687849298.2759092,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"info","ts":1687849298.3800561,"caller":"server/server.go:47","msg":"http server started on http://localhost:80"}
{"level":"warn","ts":1687849340.519704,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"info","ts":1687849340.620283,"caller":"server/server.go:47","msg":"http server started on http://localhost:80"}
{"level":"warn","ts":1687849462.742632,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"info","ts":1687849462.907278,"caller":"server/server.go:47","msg":"http server started on http://localhost:80"}
{"level":"warn","ts":1687849612.620736,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"info","ts":1687849612.6908119,"caller":"server/server.go:47","msg":"http server started on http://localhost:80"}
{"level":"warn","ts":1687849679.289414,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"info","ts":1687849679.373796,"caller":"server/server.go:47","msg":"http server started on http://localhost:80"}
{"level":"warn","ts":1687849730.273941,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"info","ts":1687849730.340616,"caller":"server/server.go:47","msg":"http server started on http://localhost:80"}
{"level":"warn","ts":1687849842.143563,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"info","ts":1687849842.237129,"caller":"server/server.go:47","msg":"http server started on http://localhost:80"}
{"level":"warn","ts":1687849966.935661,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"info","ts":1687849967.0389068,"caller":"server/server.go:47","msg":"http server started on http://localhost:80"}
{"level":"warn","ts":1687850411.3394701,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"info","ts":1687850411.438258,"caller":"server/server.go:47","msg":"http server started on http://localhost:80"}
{"level":"warn","ts":1687850486.457504,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"info","ts":1687850486.554805,"caller":"server/server.go:47","msg":"http server started on http://localhost:80"}
{"level":"warn","ts":1687850511.738243,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"info","ts":1687850511.828869,"caller":"server/server.go:47","msg":"http server started on http://localhost:80"}
{"level":"warn","ts":1687850569.221667,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"info","ts":1687850569.318559,"caller":"server/server.go:47","msg":"http server started on http://localhost:80"}
{"level":"warn","ts":1687850592.808409,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"info","ts":1687850592.897921,"caller":"server/server.go:47","msg":"http server started on http://localhost:80"}
{"level":"warn","ts":1687850596.894418,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"info","ts":1687850596.969205,"caller":"server/server.go:47","msg":"http server started on http://localhost:80"}
{"level":"warn","ts":1687853778.291462,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"info","ts":1687853778.363232,"caller":"server/server.go:47","msg":"http server started on http://localhost:80"}
{"level":"warn","ts":1687853846.136405,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"info","ts":1687853846.189482,"caller":"server/server.go:47","msg":"http server started on http://localhost:80"}
{"level":"warn","ts":1687856472.722982,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"error","ts":1687856472.871485,"caller":"app/app.go:44","msg":"ERR_INIT_REPOSITORY","error":"migration failed: column \"store_id\" of relation \"cities\" does not exist in line 0: DO $$\n  DECLARE country_id UUID;\n\n  BEGIN\n    -- EXTENSIONS --\n    CREATE EXTENSION IF NOT EXISTS pgcrypto;\n    \n    -- TABLES --\n    CREATE TABLE IF NOT EXISTS countries (\n        created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n        name        VARCHAR NOT NULL UNIQUE\n    );\n    \n    CREATE TABLE IF NOT EXISTS cities (\n        created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n        country_id  UUID NOT NULL,\n        name        VARCHAR NOT NULL UNIQUE,\n        geocenter   VARCHAR NOT NULL,\n        FOREIGN KEY (country_id) REFERENCES countries (id)\n    );\n    \n    CREATE TABLE IF NOT EXISTS currencies (\n        created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n        country_id  UUID NOT NULL,\n        sign        VARCHAR NOT NULL UNIQUE,\n        decimals    INTEGER NOT NULL,\n        prefix      BOOLEAN NOT NULL DEFAULT FALSE,\n        FOREIGN KEY (country_id) REFERENCES countries (id)\n    );\n    \n    \n    CREATE TABLE IF NOT EXISTS stores (\n        created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n        merchant_id VARCHAR NOT NULL,\n        city_id     UUID NOT NULL,\n        name        VARCHAR NOT NULL,\n        address     VARCHAR NOT NULL,\n        location    VARCHAR NOT NULL,\n        rating      NUMERIC NOT NULL DEFAULT 0,\n        is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n        FOREIGN KEY (city_id) REFERENCES cities (id)\n    \n    );\n    \n    CREATE TABLE IF NOT EXISTS schedules (\n        created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n        store_id    UUID NOT NULL UNIQUE,\n        periods     JSONB NOT NULL,\n        is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n        FOREIGN KEY (store_id) REFERENCES stores (id)\n    );\n    \n    CREATE TABLE IF NOT EXISTS deliveries (\n        created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n        store_id    UUID NOT NULL UNIQUE,\n        periods     JSONB NOT NULL,\n        areas       JSONB NOT NULL,\n        is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n        FOREIGN KEY (store_id) REFERENCES stores (id)\n    );\n    \n    -- DATA --\n    INSERT INTO countries (name)\n    VALUES ('Kazakhstan')\n    RETURNING id INTO country_id;\n    \n    INSERT INTO cities (country_id, name, geocenter)\n    VALUES (country_id, 'Almaty', '43.238949, 76.889709');\n    \n    INSERT INTO currencies (country_id, sign, decimals, prefix)\n    VALUES (country_id, '₸', 0, FALSE);\n\n    INSERT INTO cities (store_id, periods, is_active)\n    VALUES (store_id, 'Monday,10:00,23:00', true);\n\n\n    INSERT INTO cities (store_id, periods, areas,is_active)\n    VALUES (store_id, 'Monday,10:00,23:00', '43.23, 76.889',true);\n\n  \n  COMMIT;\nEND $$; (details: pq: column \"store_id\" of relation \"cities\" does not exist)","stacktrace":"warehouse-service/internal/app.Run\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/internal/app/app.go:44\nmain.main\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/main.go:8\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:250"}
{"level":"warn","ts":1687856544.385783,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"error","ts":1687856544.5201018,"caller":"app/app.go:44","msg":"ERR_INIT_REPOSITORY","error":"migration failed: column \"store_id\" does not exist in line 0: DO $$\n  DECLARE country_id UUID;\n\n  BEGIN\n    -- EXTENSIONS --\n    CREATE EXTENSION IF NOT EXISTS pgcrypto;\n    \n    -- TABLES --\n    CREATE TABLE IF NOT EXISTS countries (\n        created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n        name        VARCHAR NOT NULL UNIQUE\n    );\n    \n    CREATE TABLE IF NOT EXISTS cities (\n        created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n        country_id  UUID NOT NULL,\n        name        VARCHAR NOT NULL UNIQUE,\n        geocenter   VARCHAR NOT NULL,\n        FOREIGN KEY (country_id) REFERENCES countries (id)\n    );\n    \n    CREATE TABLE IF NOT EXISTS currencies (\n        created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n        country_id  UUID NOT NULL,\n        sign        VARCHAR NOT NULL UNIQUE,\n        decimals    INTEGER NOT NULL,\n        prefix      BOOLEAN NOT NULL DEFAULT FALSE,\n        FOREIGN KEY (country_id) REFERENCES countries (id)\n    );\n    \n    \n    CREATE TABLE IF NOT EXISTS stores (\n        created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n        merchant_id VARCHAR NOT NULL,\n        city_id     UUID NOT NULL,\n        name        VARCHAR NOT NULL,\n        address     VARCHAR NOT NULL,\n        location    VARCHAR NOT NULL,\n        rating      NUMERIC NOT NULL DEFAULT 0,\n        is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n        FOREIGN KEY (city_id) REFERENCES cities (id)\n    \n    );\n    \n    CREATE TABLE IF NOT EXISTS schedules (\n        created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n        store_id    UUID NOT NULL UNIQUE,\n        periods     JSONB NOT NULL,\n        is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n        FOREIGN KEY (store_id) REFERENCES stores (id)\n    );\n    \n    CREATE TABLE IF NOT EXISTS deliveries (\n        created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n        store_id    UUID NOT NULL UNIQUE,\n        periods     JSONB NOT NULL,\n        areas       JSONB NOT NULL,\n        is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n        FOREIGN KEY (store_id) REFERENCES stores (id)\n    );\n    \n    -- DATA --\n    INSERT INTO countries (name)\n    VALUES ('Kazakhstan')\n    RETURNING id INTO country_id;\n    \n    INSERT INTO cities (country_id, name, geocenter)\n    VALUES (country_id, 'Almaty', '43.238949, 76.889709');\n    \n    INSERT INTO currencies (country_id, sign, decimals, prefix)\n    VALUES (country_id, '₸', 0, FALSE);\n\n\n\n    INSERT INTO schedules (store_id, periods, is_active)\n    VALUES (store_id, 'Monday,10:00,23:00', true);\n\n    INSERT INTO deliveries (store_id, periods, areas,is_active)\n    VALUES (store_id, 'Monday,10:00,23:00', '43.23, 76.889',true);\n\n  \n  COMMIT;\nEND $$; (details: pq: column \"store_id\" does not exist)","stacktrace":"warehouse-service/internal/app.Run\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/internal/app/app.go:44\nmain.main\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/main.go:8\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:250"}
{"level":"warn","ts":1687856620.8188312,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"error","ts":1687856620.932708,"caller":"app/app.go:44","msg":"ERR_INIT_REPOSITORY","error":"migration failed: \"store_id\" is not a known variable (column 23) in line 89: DO $$\n  DECLARE country_id UUID;\n\n  BEGIN\n    -- EXTENSIONS --\n    CREATE EXTENSION IF NOT EXISTS pgcrypto;\n    \n    -- TABLES --\n    CREATE TABLE IF NOT EXISTS countries (\n        created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n        name        VARCHAR NOT NULL UNIQUE\n    );\n    \n    CREATE TABLE IF NOT EXISTS cities (\n        created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n        country_id  UUID NOT NULL,\n        name        VARCHAR NOT NULL UNIQUE,\n        geocenter   VARCHAR NOT NULL,\n        FOREIGN KEY (country_id) REFERENCES countries (id)\n    );\n    \n    CREATE TABLE IF NOT EXISTS currencies (\n        created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n        country_id  UUID NOT NULL,\n        sign        VARCHAR NOT NULL UNIQUE,\n        decimals    INTEGER NOT NULL,\n        prefix      BOOLEAN NOT NULL DEFAULT FALSE,\n        FOREIGN KEY (country_id) REFERENCES countries (id)\n    );\n    \n    \n    CREATE TABLE IF NOT EXISTS stores (\n        created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n        merchant_id VARCHAR NOT NULL,\n        city_id     UUID NOT NULL,\n        name        VARCHAR NOT NULL,\n        address     VARCHAR NOT NULL,\n        location    VARCHAR NOT NULL,\n        rating      NUMERIC NOT NULL DEFAULT 0,\n        is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n        FOREIGN KEY (city_id) REFERENCES cities (id)\n    \n    );\n    \n    CREATE TABLE IF NOT EXISTS schedules (\n        created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n        store_id    UUID NOT NULL UNIQUE,\n        periods     JSONB NOT NULL,\n        is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n        FOREIGN KEY (store_id) REFERENCES stores (id)\n    );\n    \n    CREATE TABLE IF NOT EXISTS deliveries (\n        created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n        store_id    UUID NOT NULL UNIQUE,\n        periods     JSONB NOT NULL,\n        areas       JSONB NOT NULL,\n        is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n        FOREIGN KEY (store_id) REFERENCES stores (id)\n    );\n    \n    -- DATA --\n    INSERT INTO countries (name)\n    VALUES ('Kazakhstan')\n    RETURNING id INTO country_id;\n    \n    INSERT INTO cities (country_id, name, geocenter)\n    VALUES (country_id, 'Almaty', '43.238949, 76.889709');\n    \n    INSERT INTO currencies (country_id, sign, decimals, prefix)\n    VALUES (country_id, '₸', 0, FALSE);\n\n\n\n    INSERT INTO schedules ( periods, is_active)\n    VALUES ( 'Monday,10:00,23:00', true);\n    RETURNING id INTO store_id;\n\n    INSERT INTO deliveries (store_id, periods, areas,is_active)\n    VALUES (store_id, 'Monday,10:00,23:00', '43.23, 76.889',true);\n\n  \n  COMMIT;\nEND $$; (details: pq: \"store_id\" is not a known variable)","stacktrace":"warehouse-service/internal/app.Run\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/internal/app/app.go:44\nmain.main\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/main.go:8\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:250"}
{"level":"warn","ts":1687856851.850409,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"error","ts":1687856851.953892,"caller":"app/app.go:44","msg":"ERR_INIT_REPOSITORY","error":"migration failed: \"store_id\" is not a known variable (column 23) in line 89: DO $$\n  DECLARE country_id UUID;\n\n  BEGIN\n    -- EXTENSIONS --\n    CREATE EXTENSION IF NOT EXISTS pgcrypto;\n    \n    -- TABLES --\n    CREATE TABLE IF NOT EXISTS countries (\n        created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n        name        VARCHAR NOT NULL UNIQUE\n    );\n    \n    CREATE TABLE IF NOT EXISTS cities (\n        created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n        country_id  UUID NOT NULL,\n        name        VARCHAR NOT NULL UNIQUE,\n        geocenter   VARCHAR NOT NULL,\n        FOREIGN KEY (country_id) REFERENCES countries (id)\n    );\n    \n    CREATE TABLE IF NOT EXISTS currencies (\n        created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n        country_id  UUID NOT NULL,\n        sign        VARCHAR NOT NULL UNIQUE,\n        decimals    INTEGER NOT NULL,\n        prefix      BOOLEAN NOT NULL DEFAULT FALSE,\n        FOREIGN KEY (country_id) REFERENCES countries (id)\n    );\n    \n    \n    CREATE TABLE IF NOT EXISTS stores (\n        created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n        merchant_id VARCHAR NOT NULL,\n        city_id     UUID NOT NULL,\n        name        VARCHAR NOT NULL,\n        address     VARCHAR NOT NULL,\n        location    VARCHAR NOT NULL,\n        rating      NUMERIC NOT NULL DEFAULT 0,\n        is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n        FOREIGN KEY (city_id) REFERENCES cities (id)\n    \n    );\n    \n    CREATE TABLE IF NOT EXISTS schedules (\n        created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n        store_id    UUID NOT NULL UNIQUE,\n        periods     JSONB NOT NULL,\n        is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n        FOREIGN KEY (store_id) REFERENCES stores (id)\n    );\n    \n    CREATE TABLE IF NOT EXISTS deliveries (\n        created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n        store_id    UUID NOT NULL UNIQUE,\n        periods     JSONB NOT NULL,\n        areas       JSONB NOT NULL,\n        is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n        FOREIGN KEY (store_id) REFERENCES stores (id)\n    );\n    \n    -- DATA --\n    INSERT INTO countries (name)\n    VALUES ('Kazakhstan')\n    RETURNING id INTO country_id;\n    \n    INSERT INTO cities (country_id, name, geocenter)\n    VALUES (country_id, 'Almaty', '43.238949, 76.889709');\n    \n    INSERT INTO currencies (country_id, sign, decimals, prefix)\n    VALUES (country_id, '₸', 0, FALSE);\n\n\n\n    INSERT INTO stores ( merchant_id)\n    VALUES ( '943fe9cf-6918-4d10-b6f5-ee911554017e');\n    RETURNING id INTO store_id;\n\n    INSERT INTO schedules ( store_id,periods, is_active)\n    VALUES ( store_id,'Monday,10:00,23:00', true);\n    RETURNING id INTO store_id;\n\n    INSERT INTO deliveries (store_id, periods, areas,is_active)\n    VALUES (store_id, 'Monday,10:00,23:00', '43.23, 76.889',true);\n\n  \n  COMMIT;\nEND $$; (details: pq: \"store_id\" is not a known variable)","stacktrace":"warehouse-service/internal/app.Run\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/internal/app/app.go:44\nmain.main\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/main.go:8\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:250"}
{"level":"warn","ts":1687856906.314639,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"error","ts":1687856906.4177449,"caller":"app/app.go:44","msg":"ERR_INIT_REPOSITORY","error":"migration failed: \"id\" is not a known variable (column 23) in line 89: DO $$\n  DECLARE country_id UUID;\n\n  BEGIN\n    -- EXTENSIONS --\n    CREATE EXTENSION IF NOT EXISTS pgcrypto;\n    \n    -- TABLES --\n    CREATE TABLE IF NOT EXISTS countries (\n        created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n        name        VARCHAR NOT NULL UNIQUE\n    );\n    \n    CREATE TABLE IF NOT EXISTS cities (\n        created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n        country_id  UUID NOT NULL,\n        name        VARCHAR NOT NULL UNIQUE,\n        geocenter   VARCHAR NOT NULL,\n        FOREIGN KEY (country_id) REFERENCES countries (id)\n    );\n    \n    CREATE TABLE IF NOT EXISTS currencies (\n        created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n        country_id  UUID NOT NULL,\n        sign        VARCHAR NOT NULL UNIQUE,\n        decimals    INTEGER NOT NULL,\n        prefix      BOOLEAN NOT NULL DEFAULT FALSE,\n        FOREIGN KEY (country_id) REFERENCES countries (id)\n    );\n    \n    \n    CREATE TABLE IF NOT EXISTS stores (\n        created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n        merchant_id VARCHAR NOT NULL,\n        city_id     UUID NOT NULL,\n        name        VARCHAR NOT NULL,\n        address     VARCHAR NOT NULL,\n        location    VARCHAR NOT NULL,\n        rating      NUMERIC NOT NULL DEFAULT 0,\n        is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n        FOREIGN KEY (city_id) REFERENCES cities (id)\n    \n    );\n    \n    CREATE TABLE IF NOT EXISTS schedules (\n        created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n        store_id    UUID NOT NULL UNIQUE,\n        periods     JSONB NOT NULL,\n        is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n        FOREIGN KEY (store_id) REFERENCES stores (id)\n    );\n    \n    CREATE TABLE IF NOT EXISTS deliveries (\n        created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n        store_id    UUID NOT NULL UNIQUE,\n        periods     JSONB NOT NULL,\n        areas       JSONB NOT NULL,\n        is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n        FOREIGN KEY (store_id) REFERENCES stores (id)\n    );\n    \n    -- DATA --\n    INSERT INTO countries (name)\n    VALUES ('Kazakhstan')\n    RETURNING id INTO country_id;\n    \n    INSERT INTO cities (country_id, name, geocenter)\n    VALUES (country_id, 'Almaty', '43.238949, 76.889709');\n    \n    INSERT INTO currencies (country_id, sign, decimals, prefix)\n    VALUES (country_id, '₸', 0, FALSE);\n\n\n\n    INSERT INTO stores ( merchant_id)\n    VALUES ( '943fe9cf-6918-4d10-b6f5-ee911554017e');\n    RETURNING id INTO id;\n\n    INSERT INTO schedules ( store_id,periods, is_active)\n    VALUES ( store_id,'Monday,10:00,23:00', true);\n    RETURNING id INTO store_id;\n\n    INSERT INTO deliveries (store_id, periods, areas,is_active)\n    VALUES (store_id, 'Monday,10:00,23:00', '43.23, 76.889',true);\n\n  \n  COMMIT;\nEND $$; (details: pq: \"id\" is not a known variable)","stacktrace":"warehouse-service/internal/app.Run\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/internal/app/app.go:44\nmain.main\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/main.go:8\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:250"}
{"level":"warn","ts":1687856996.824702,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"error","ts":1687856996.937184,"caller":"app/app.go:44","msg":"ERR_INIT_REPOSITORY","error":"migration failed: \"store_id\" is not a known variable (column 23) in line 89: DO $$\n  DECLARE country_id UUID;\n\n  BEGIN\n    -- EXTENSIONS --\n    CREATE EXTENSION IF NOT EXISTS pgcrypto;\n    \n    -- TABLES --\n    CREATE TABLE IF NOT EXISTS countries (\n        created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n        name        VARCHAR NOT NULL UNIQUE\n    );\n    \n    CREATE TABLE IF NOT EXISTS cities (\n        created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n        country_id  UUID NOT NULL,\n        name        VARCHAR NOT NULL UNIQUE,\n        geocenter   VARCHAR NOT NULL,\n        FOREIGN KEY (country_id) REFERENCES countries (id)\n    );\n    \n    CREATE TABLE IF NOT EXISTS currencies (\n        created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n        country_id  UUID NOT NULL,\n        sign        VARCHAR NOT NULL UNIQUE,\n        decimals    INTEGER NOT NULL,\n        prefix      BOOLEAN NOT NULL DEFAULT FALSE,\n        FOREIGN KEY (country_id) REFERENCES countries (id)\n    );\n    \n    \n    CREATE TABLE IF NOT EXISTS stores (\n        created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n        merchant_id VARCHAR NOT NULL,\n        city_id     UUID NOT NULL,\n        name        VARCHAR NOT NULL,\n        address     VARCHAR NOT NULL,\n        location    VARCHAR NOT NULL,\n        rating      NUMERIC NOT NULL DEFAULT 0,\n        is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n        FOREIGN KEY (city_id) REFERENCES cities (id)\n    \n    );\n    \n    CREATE TABLE IF NOT EXISTS schedules (\n        created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n        store_id    UUID NOT NULL UNIQUE,\n        periods     JSONB NOT NULL,\n        is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n        FOREIGN KEY (store_id) REFERENCES stores (id)\n    );\n    \n    CREATE TABLE IF NOT EXISTS deliveries (\n        created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n        store_id    UUID NOT NULL UNIQUE,\n        periods     JSONB NOT NULL,\n        areas       JSONB NOT NULL,\n        is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n        FOREIGN KEY (store_id) REFERENCES stores (id)\n    );\n    \n    -- DATA --\n    INSERT INTO countries (name)\n    VALUES ('Kazakhstan')\n    RETURNING id INTO country_id;\n    \n    INSERT INTO cities (country_id, name, geocenter)\n    VALUES (country_id, 'Almaty', '43.238949, 76.889709');\n    \n    INSERT INTO currencies (country_id, sign, decimals, prefix)\n    VALUES (country_id, '₸', 0, FALSE);\n\n\n\n    INSERT INTO stores ( merchant_id)\n    VALUES ( '943fe9cf-6918-4d10-b6f5-ee911554017e');\n    RETURNING id INTO store_id;\n\n    INSERT INTO schedules ( store_id,periods, is_active)\n    VALUES ( store_id,'Monday,10:00,23:00', true);\n\n    INSERT INTO deliveries (store_id, periods, areas,is_active)\n    VALUES (store_id, 'Monday,10:00,23:00', '43.23, 76.889',true);\n\n  \n  COMMIT;\nEND $$; (details: pq: \"store_id\" is not a known variable)","stacktrace":"warehouse-service/internal/app.Run\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/internal/app/app.go:44\nmain.main\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/main.go:8\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:250"}
{"level":"warn","ts":1687857097.2685142,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"error","ts":1687857097.358704,"caller":"app/app.go:44","msg":"ERR_INIT_REPOSITORY","error":"Dirty database version 1. Fix and force version.","stacktrace":"warehouse-service/internal/app.Run\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/internal/app/app.go:44\nmain.main\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/main.go:8\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:250"}
{"level":"warn","ts":1687857113.1173801,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"info","ts":1687857113.244919,"caller":"server/server.go:47","msg":"http server started on http://localhost:80"}
{"level":"warn","ts":1687857302.095403,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"info","ts":1687857302.175971,"caller":"server/server.go:47","msg":"http server started on http://localhost:80"}
{"level":"warn","ts":1687857453.967942,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"error","ts":1687857454.081053,"caller":"app/app.go:44","msg":"ERR_INIT_REPOSITORY","error":"migration failed: \"store_id\" is not a known variable (column 23) in line 90: DO $$\n  DECLARE country_id UUID;\n\n  BEGIN\n    -- EXTENSIONS --\n    CREATE EXTENSION IF NOT EXISTS pgcrypto;\n    \n    -- TABLES --\n    CREATE TABLE IF NOT EXISTS countries (\n        created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n        name        VARCHAR NOT NULL UNIQUE\n    );\n    \n    CREATE TABLE IF NOT EXISTS cities (\n        created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n        country_id  UUID NOT NULL,\n        name        VARCHAR NOT NULL UNIQUE,\n        geocenter   VARCHAR NOT NULL,\n        FOREIGN KEY (country_id) REFERENCES countries (id)\n    );\n    \n    CREATE TABLE IF NOT EXISTS currencies (\n        created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n        country_id  UUID NOT NULL,\n        sign        VARCHAR NOT NULL UNIQUE,\n        decimals    INTEGER NOT NULL,\n        prefix      BOOLEAN NOT NULL DEFAULT FALSE,\n        FOREIGN KEY (country_id) REFERENCES countries (id)\n    );\n    \n    \n    CREATE TABLE IF NOT EXISTS stores (\n        created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n        merchant_id VARCHAR NOT NULL,\n        city_id     UUID NOT NULL,\n        name        VARCHAR NOT NULL,\n        address     VARCHAR NOT NULL,\n        location    VARCHAR NOT NULL,\n        rating      NUMERIC NOT NULL DEFAULT 0,\n        is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n        FOREIGN KEY (city_id) REFERENCES cities (id)\n    \n    );\n    \n    CREATE TABLE IF NOT EXISTS schedules (\n        created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n        store_id    UUID NOT NULL UNIQUE,\n        periods     JSONB NOT NULL,\n        is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n        FOREIGN KEY (store_id) REFERENCES stores (id)\n    );\n    \n    CREATE TABLE IF NOT EXISTS deliveries (\n        created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n        store_id    UUID NOT NULL UNIQUE,\n        periods     JSONB NOT NULL,\n        areas       JSONB NOT NULL,\n        is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n        FOREIGN KEY (store_id) REFERENCES stores (id)\n    );\n    \n    -- DATA --\n    INSERT INTO countries (name)\n    VALUES ('Kazakhstan')\n    RETURNING id INTO country_id;\n    \n    INSERT INTO cities (country_id, name, geocenter)\n    VALUES (country_id, 'Almaty', '43.238949, 76.889709');\n    \n    INSERT INTO currencies (country_id, sign, decimals, prefix)\n    VALUES (country_id, '₸', 0, FALSE);\n\n\n\n\n    INSERT INTO schedules ( store_id,periods, is_active)\n    VALUES ( store_id,'Monday,10:00,23:00', true)\n    RETURNING id INTO store_id;\n\n    INSERT INTO deliveries (store_id, periods, areas,is_active)\n    VALUES (store_id, 'Monday,10:00,23:00', '43.23, 76.889',true);\n\n  \n  COMMIT;\nEND $$; (details: pq: \"store_id\" is not a known variable)","stacktrace":"warehouse-service/internal/app.Run\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/internal/app/app.go:44\nmain.main\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/main.go:8\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:250"}
{"level":"warn","ts":1687857562.170434,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"error","ts":1687857562.276453,"caller":"app/app.go:44","msg":"ERR_INIT_REPOSITORY","error":"migration failed: \"city_id\" is not a known variable (column 23) in line 90: DO $$\n  DECLARE country_id UUID;\n\n  BEGIN\n    -- EXTENSIONS --\n    CREATE EXTENSION IF NOT EXISTS pgcrypto;\n    \n    -- TABLES --\n    CREATE TABLE IF NOT EXISTS countries (\n        created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n        name        VARCHAR NOT NULL UNIQUE\n    );\n    \n    CREATE TABLE IF NOT EXISTS cities (\n        created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n        country_id  UUID NOT NULL,\n        name        VARCHAR NOT NULL UNIQUE,\n        geocenter   VARCHAR NOT NULL,\n        FOREIGN KEY (country_id) REFERENCES countries (id)\n    );\n    \n    CREATE TABLE IF NOT EXISTS currencies (\n        created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n        country_id  UUID NOT NULL,\n        sign        VARCHAR NOT NULL UNIQUE,\n        decimals    INTEGER NOT NULL,\n        prefix      BOOLEAN NOT NULL DEFAULT FALSE,\n        FOREIGN KEY (country_id) REFERENCES countries (id)\n    );\n    \n    \n    CREATE TABLE IF NOT EXISTS stores (\n        created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n        merchant_id VARCHAR NOT NULL,\n        city_id     UUID NOT NULL,\n        name        VARCHAR NOT NULL,\n        address     VARCHAR NOT NULL,\n        location    VARCHAR NOT NULL,\n        rating      NUMERIC NOT NULL DEFAULT 0,\n        is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n        FOREIGN KEY (city_id) REFERENCES cities (id)\n    \n    );\n    \n    CREATE TABLE IF NOT EXISTS schedules (\n        created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n        store_id    UUID NOT NULL UNIQUE,\n        periods     JSONB NOT NULL,\n        is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n        FOREIGN KEY (store_id) REFERENCES stores (id)\n    );\n    \n    CREATE TABLE IF NOT EXISTS deliveries (\n        created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n        store_id    UUID NOT NULL UNIQUE,\n        periods     JSONB NOT NULL,\n        areas       JSONB NOT NULL,\n        is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n        FOREIGN KEY (store_id) REFERENCES stores (id)\n    );\n    \n    -- DATA --\n    INSERT INTO countries (name)\n    VALUES ('Kazakhstan')\n    RETURNING id INTO country_id;\n    \n    INSERT INTO cities (country_id, name, geocenter)\n    VALUES (country_id, 'Almaty', '43.238949, 76.889709');\n    \n    INSERT INTO currencies (country_id, sign, decimals, prefix)\n    VALUES (country_id, '₸', 0, FALSE);\n\n\n\n\n    INSERT INTO schedules ( store_id,periods, is_active)\n    VALUES ( store_id,'Monday,10:00,23:00', true)\n    RETURNING id INTO city_id;\n\n    INSERT INTO deliveries (store_id, periods, areas,is_active)\n    VALUES (store_id, 'Monday,10:00,23:00', '43.23, 76.889',true);\n\n  \n  COMMIT;\nEND $$; (details: pq: \"city_id\" is not a known variable)","stacktrace":"warehouse-service/internal/app.Run\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/internal/app/app.go:44\nmain.main\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/main.go:8\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:250"}
{"level":"warn","ts":1687857591.3143811,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"error","ts":1687857591.4171588,"caller":"app/app.go:44","msg":"ERR_INIT_REPOSITORY","error":"migration failed: \"store_id\" is not a known variable (column 23) in line 90: DO $$\n  DECLARE country_id UUID;\n\n  BEGIN\n    -- EXTENSIONS --\n    CREATE EXTENSION IF NOT EXISTS pgcrypto;\n    \n    -- TABLES --\n    CREATE TABLE IF NOT EXISTS countries (\n        created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n        name        VARCHAR NOT NULL UNIQUE\n    );\n    \n    CREATE TABLE IF NOT EXISTS cities (\n        created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n        country_id  UUID NOT NULL,\n        name        VARCHAR NOT NULL UNIQUE,\n        geocenter   VARCHAR NOT NULL,\n        FOREIGN KEY (country_id) REFERENCES countries (id)\n    );\n    \n    CREATE TABLE IF NOT EXISTS currencies (\n        created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n        country_id  UUID NOT NULL,\n        sign        VARCHAR NOT NULL UNIQUE,\n        decimals    INTEGER NOT NULL,\n        prefix      BOOLEAN NOT NULL DEFAULT FALSE,\n        FOREIGN KEY (country_id) REFERENCES countries (id)\n    );\n    \n    \n    CREATE TABLE IF NOT EXISTS stores (\n        created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n        merchant_id VARCHAR NOT NULL,\n        city_id     UUID NOT NULL,\n        name        VARCHAR NOT NULL,\n        address     VARCHAR NOT NULL,\n        location    VARCHAR NOT NULL,\n        rating      NUMERIC NOT NULL DEFAULT 0,\n        is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n        FOREIGN KEY (city_id) REFERENCES cities (id)\n    \n    );\n    \n    CREATE TABLE IF NOT EXISTS schedules (\n        created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n        store_id    UUID NOT NULL UNIQUE,\n        periods     JSONB NOT NULL,\n        is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n        FOREIGN KEY (store_id) REFERENCES stores (id)\n    );\n    \n    CREATE TABLE IF NOT EXISTS deliveries (\n        created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n        store_id    UUID NOT NULL UNIQUE,\n        periods     JSONB NOT NULL,\n        areas       JSONB NOT NULL,\n        is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n        FOREIGN KEY (store_id) REFERENCES stores (id)\n    );\n    \n    -- DATA --\n    INSERT INTO countries (name)\n    VALUES ('Kazakhstan')\n    RETURNING id INTO country_id;\n    \n    INSERT INTO cities (country_id, name, geocenter)\n    VALUES (country_id, 'Almaty', '43.238949, 76.889709');\n    \n    INSERT INTO currencies (country_id, sign, decimals, prefix)\n    VALUES (country_id, '₸', 0, FALSE);\n\n\n\n\n    INSERT INTO schedules ( store_id,periods, is_active)\n    VALUES ( store_id,'Monday,10:00,23:00', true)\n    RETURNING id INTO store_id;\n\n    INSERT INTO deliveries (store_id, periods, areas,is_active)\n    VALUES (store_id, 'Monday,10:00,23:00', '43.23, 76.889',true);\n\n  \n  COMMIT;\nEND $$; (details: pq: \"store_id\" is not a known variable)","stacktrace":"warehouse-service/internal/app.Run\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/internal/app/app.go:44\nmain.main\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/main.go:8\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:250"}
{"level":"warn","ts":1687857803.8392801,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"error","ts":1687857803.939896,"caller":"app/app.go:44","msg":"ERR_INIT_REPOSITORY","error":"migration failed: \"store_id\" is not a known variable (column 19) in line 90: DO $$\n  DECLARE country_id UUID;\n\n  BEGIN\n    -- EXTENSIONS --\n    CREATE EXTENSION IF NOT EXISTS pgcrypto;\n    \n    -- TABLES --\n    CREATE TABLE IF NOT EXISTS countries (\n        created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n        name        VARCHAR NOT NULL UNIQUE\n    );\n    \n    CREATE TABLE IF NOT EXISTS cities (\n        created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n        country_id  UUID NOT NULL,\n        name        VARCHAR NOT NULL UNIQUE,\n        geocenter   VARCHAR NOT NULL,\n        FOREIGN KEY (country_id) REFERENCES countries (id)\n    );\n    \n    CREATE TABLE IF NOT EXISTS currencies (\n        created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n        country_id  UUID NOT NULL,\n        sign        VARCHAR NOT NULL UNIQUE,\n        decimals    INTEGER NOT NULL,\n        prefix      BOOLEAN NOT NULL DEFAULT FALSE,\n        FOREIGN KEY (country_id) REFERENCES countries (id)\n    );\n    \n    \n    CREATE TABLE IF NOT EXISTS stores (\n        created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n        merchant_id VARCHAR NOT NULL,\n        city_id     UUID NOT NULL,\n        name        VARCHAR NOT NULL,\n        address     VARCHAR NOT NULL,\n        location    VARCHAR NOT NULL,\n        rating      NUMERIC NOT NULL DEFAULT 0,\n        is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n        FOREIGN KEY (city_id) REFERENCES cities (id)\n    \n    );\n    \n    CREATE TABLE IF NOT EXISTS schedules (\n        created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n        store_id    UUID NOT NULL UNIQUE,\n        periods     JSONB NOT NULL,\n        is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n        FOREIGN KEY (store_id) REFERENCES stores (id)\n    );\n    \n    CREATE TABLE IF NOT EXISTS deliveries (\n        created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n        store_id    UUID NOT NULL UNIQUE,\n        periods     JSONB NOT NULL,\n        areas       JSONB NOT NULL,\n        is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n        FOREIGN KEY (store_id) REFERENCES stores (id)\n    );\n    \n    -- DATA --\n    INSERT INTO countries (name)\n    VALUES ('Kazakhstan')\n    RETURNING id INTO country_id;\n    \n    INSERT INTO cities (country_id, name, geocenter)\n    VALUES (country_id, 'Almaty', '43.238949, 76.889709');\n    \n    INSERT INTO currencies (country_id, sign, decimals, prefix)\n    VALUES (country_id, '₸', 0, FALSE);\n\n\n\n\nINSERT INTO stores (merchant_id, city_id, name, address, location, rating, is_active)\nVALUES ('943fe9cf-6918-4d10-b6f5-ee911554017e', '943fe9cf-6918-4d10-b6f5-ee911554017e', 'Store A', '123 Main St', 'Almaty', 0, FALSE)\nRETURNING id INTO store_id;\n\nINSERT INTO schedules (store_id, periods, is_active)\nVALUES (store_id, 'Monday,10:00,23:00', true);\n\nINSERT INTO deliveries (store_id, periods, areas, is_active)\nVALUES (store_id, 'Monday,10:00,23:00', '43.23, 76.889', true);\n\n  \n  COMMIT;\nEND $$; (details: pq: \"store_id\" is not a known variable)","stacktrace":"warehouse-service/internal/app.Run\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/internal/app/app.go:44\nmain.main\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/main.go:8\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:250"}
{"level":"warn","ts":1687857941.209641,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"error","ts":1687857941.3140101,"caller":"app/app.go:44","msg":"ERR_INIT_REPOSITORY","error":"migration failed: insert or update on table \"stores\" violates foreign key constraint \"stores_city_id_fkey\", Key (city_id)=(943fe9cf-6918-4d10-b6f5-ee911554017e) is not present in table \"cities\". in line 0: DO $$\n  DECLARE\n    country_id UUID;\n    store_id UUID;\n\n  BEGIN\n    -- EXTENSIONS --\n    CREATE EXTENSION IF NOT EXISTS pgcrypto;\n    \n    -- TABLES --\n    CREATE TABLE IF NOT EXISTS countries (\n        created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n        name        VARCHAR NOT NULL UNIQUE\n    );\n    \n    CREATE TABLE IF NOT EXISTS cities (\n        created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n        country_id  UUID NOT NULL,\n        name        VARCHAR NOT NULL UNIQUE,\n        geocenter   VARCHAR NOT NULL,\n        FOREIGN KEY (country_id) REFERENCES countries (id)\n    );\n    \n    CREATE TABLE IF NOT EXISTS currencies (\n        created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n        country_id  UUID NOT NULL,\n        sign        VARCHAR NOT NULL UNIQUE,\n        decimals    INTEGER NOT NULL,\n        prefix      BOOLEAN NOT NULL DEFAULT FALSE,\n        FOREIGN KEY (country_id) REFERENCES countries (id)\n    );\n    \n    \n    CREATE TABLE IF NOT EXISTS stores (\n        created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n        merchant_id VARCHAR NOT NULL,\n        city_id     UUID NOT NULL,\n        name        VARCHAR NOT NULL,\n        address     VARCHAR NOT NULL,\n        location    VARCHAR NOT NULL,\n        rating      NUMERIC NOT NULL DEFAULT 0,\n        is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n        FOREIGN KEY (city_id) REFERENCES cities (id)\n    \n    );\n    \n    CREATE TABLE IF NOT EXISTS schedules (\n        created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n        store_id    UUID NOT NULL UNIQUE,\n        periods     JSONB NOT NULL,\n        is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n        FOREIGN KEY (store_id) REFERENCES stores (id)\n    );\n    \n    CREATE TABLE IF NOT EXISTS deliveries (\n        created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n        store_id    UUID NOT NULL UNIQUE,\n        periods     JSONB NOT NULL,\n        areas       JSONB NOT NULL,\n        is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n        FOREIGN KEY (store_id) REFERENCES stores (id)\n    );\n    \n    -- DATA --\n    INSERT INTO countries (name)\n    VALUES ('Kazakhstan')\n    RETURNING id INTO country_id;\n    \n    INSERT INTO cities (country_id, name, geocenter)\n    VALUES (country_id, 'Almaty', '43.238949, 76.889709');\n    \n    INSERT INTO currencies (country_id, sign, decimals, prefix)\n    VALUES (country_id, '₸', 0, FALSE);\n\n\n\n\nINSERT INTO stores (merchant_id, city_id, name, address, location, rating, is_active)\nVALUES ('943fe9cf-6918-4d10-b6f5-ee911554017e', '943fe9cf-6918-4d10-b6f5-ee911554017e', 'Store A', '123 Main St', 'Almaty', 0, FALSE)\nRETURNING id INTO store_id;\n\nINSERT INTO schedules (store_id, periods, is_active)\nVALUES (store_id, 'Monday,10:00,23:00', true);\n\nINSERT INTO deliveries (store_id, periods, areas, is_active)\nVALUES (store_id, 'Monday,10:00,23:00', '43.23, 76.889', true);\n\n  \n  COMMIT;\nEND $$; (details: pq: insert or update on table \"stores\" violates foreign key constraint \"stores_city_id_fkey\")","stacktrace":"warehouse-service/internal/app.Run\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/internal/app/app.go:44\nmain.main\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/main.go:8\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:250"}
{"level":"warn","ts":1687857988.043199,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"error","ts":1687857988.1783402,"caller":"app/app.go:44","msg":"ERR_INIT_REPOSITORY","error":"migration failed: invalid input syntax for type json, Token \"Monday\" is invalid. in line 0: DO $$\n  DECLARE\n    country_id UUID;\n    store_id UUID;\n\n  BEGIN\n    -- EXTENSIONS --\n    CREATE EXTENSION IF NOT EXISTS pgcrypto;\n    \n    -- TABLES --\n    CREATE TABLE IF NOT EXISTS countries (\n        created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n        name        VARCHAR NOT NULL UNIQUE\n    );\n    \n    CREATE TABLE IF NOT EXISTS cities (\n        created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n        country_id  UUID NOT NULL,\n        name        VARCHAR NOT NULL UNIQUE,\n        geocenter   VARCHAR NOT NULL,\n        FOREIGN KEY (country_id) REFERENCES countries (id)\n    );\n    \n    CREATE TABLE IF NOT EXISTS currencies (\n        created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n        country_id  UUID NOT NULL,\n        sign        VARCHAR NOT NULL UNIQUE,\n        decimals    INTEGER NOT NULL,\n        prefix      BOOLEAN NOT NULL DEFAULT FALSE,\n        FOREIGN KEY (country_id) REFERENCES countries (id)\n    );\n    \n    \n    CREATE TABLE IF NOT EXISTS stores (\n        created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n        merchant_id VARCHAR NOT NULL,\n        city_id     UUID NOT NULL,\n        name        VARCHAR NOT NULL,\n        address     VARCHAR NOT NULL,\n        location    VARCHAR NOT NULL,\n        rating      NUMERIC NOT NULL DEFAULT 0,\n        is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n        FOREIGN KEY (city_id) REFERENCES cities (id)\n    \n    );\n    \n    CREATE TABLE IF NOT EXISTS schedules (\n        created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n        store_id    UUID NOT NULL UNIQUE,\n        periods     JSONB NOT NULL,\n        is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n        FOREIGN KEY (store_id) REFERENCES stores (id)\n    );\n    \n    CREATE TABLE IF NOT EXISTS deliveries (\n        created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n        store_id    UUID NOT NULL UNIQUE,\n        periods     JSONB NOT NULL,\n        areas       JSONB NOT NULL,\n        is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n        FOREIGN KEY (store_id) REFERENCES stores (id)\n    );\n    \n    -- DATA --\n    INSERT INTO countries (name)\n    VALUES ('Kazakhstan')\n    RETURNING id INTO country_id;\n    \n    INSERT INTO cities (country_id, name, geocenter)\n    VALUES (country_id, 'Almaty', '43.238949, 76.889709');\n    \n    INSERT INTO currencies (country_id, sign, decimals, prefix)\n    VALUES (country_id, '₸', 0, FALSE);\n\n\n\nINSERT INTO schedules (store_id, periods, is_active)\nVALUES (store_id, 'Monday,10:00,23:00', true)\nRETURNING id INTO store_id;\n\nINSERT INTO deliveries (store_id, periods, areas, is_active)\nVALUES (store_id, 'Monday,10:00,23:00', '43.23, 76.889', true);\n\n  \n  COMMIT;\nEND $$; (details: pq: invalid input syntax for type json)","stacktrace":"warehouse-service/internal/app.Run\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/internal/app/app.go:44\nmain.main\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/main.go:8\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:250"}
{"level":"warn","ts":1687858181.464702,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"error","ts":1687858181.60708,"caller":"app/app.go:44","msg":"ERR_INIT_REPOSITORY","error":"migration failed: null value in column \"store_id\" of relation \"schedules\" violates not-null constraint, Failing row contains (2023-06-27 09:29:41.573274, 2023-06-27 09:29:41.573274, 16c87290-35ce-466a-b349-c5efbab6c45f, null, [{\"day\": \"Monday\", \"end_time\": \"23:00\", \"start_time\": \"10:00\"}], t). in line 0: DO $$\n  DECLARE\n    country_id UUID;\n    store_id UUID;\n\n  BEGIN\n    -- EXTENSIONS --\n    CREATE EXTENSION IF NOT EXISTS pgcrypto;\n    \n    -- TABLES --\n    CREATE TABLE IF NOT EXISTS countries (\n        created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n        name        VARCHAR NOT NULL UNIQUE\n    );\n    \n    CREATE TABLE IF NOT EXISTS cities (\n        created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n        country_id  UUID NOT NULL,\n        name        VARCHAR NOT NULL UNIQUE,\n        geocenter   VARCHAR NOT NULL,\n        FOREIGN KEY (country_id) REFERENCES countries (id)\n    );\n    \n    CREATE TABLE IF NOT EXISTS currencies (\n        created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n        country_id  UUID NOT NULL,\n        sign        VARCHAR NOT NULL UNIQUE,\n        decimals    INTEGER NOT NULL,\n        prefix      BOOLEAN NOT NULL DEFAULT FALSE,\n        FOREIGN KEY (country_id) REFERENCES countries (id)\n    );\n    \n    \n    CREATE TABLE IF NOT EXISTS stores (\n        created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n        merchant_id VARCHAR NOT NULL,\n        city_id     UUID NOT NULL,\n        name        VARCHAR NOT NULL,\n        address     VARCHAR NOT NULL,\n        location    VARCHAR NOT NULL,\n        rating      NUMERIC NOT NULL DEFAULT 0,\n        is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n        FOREIGN KEY (city_id) REFERENCES cities (id)\n    \n    );\n    \n    CREATE TABLE IF NOT EXISTS schedules (\n        created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n        store_id    UUID NOT NULL UNIQUE,\n        periods     JSONB NOT NULL,\n        is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n        FOREIGN KEY (store_id) REFERENCES stores (id)\n    );\n    \n    CREATE TABLE IF NOT EXISTS deliveries (\n        created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n        store_id    UUID NOT NULL UNIQUE,\n        periods     JSONB NOT NULL,\n        areas       JSONB NOT NULL,\n        is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n        FOREIGN KEY (store_id) REFERENCES stores (id)\n    );\n    \n    -- DATA --\n    INSERT INTO countries (name)\n    VALUES ('Kazakhstan')\n    RETURNING id INTO country_id;\n    \n    INSERT INTO cities (country_id, name, geocenter)\n    VALUES (country_id, 'Almaty', '43.238949, 76.889709');\n    \n    INSERT INTO currencies (country_id, sign, decimals, prefix)\n    VALUES (country_id, '₸', 0, FALSE);\n\n\n\nINSERT INTO schedules (store_id, periods, is_active)\nVALUES (store_id, '[{\"day\":\"Monday\",\"start_time\":\"10:00\",\"end_time\":\"23:00\"}]', true)\nRETURNING id INTO store_id;\n\nINSERT INTO deliveries (store_id, periods, areas, is_active)\nVALUES (store_id, '[{\"day\":\"Monday\",\"start_time\":\"10:00\",\"end_time\":\"23:00\"}]', '43.23, 76.889', true);\n\n  \n  COMMIT;\nEND $$; (details: pq: null value in column \"store_id\" of relation \"schedules\" violates not-null constraint)","stacktrace":"warehouse-service/internal/app.Run\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/internal/app/app.go:44\nmain.main\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/main.go:8\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:250"}
{"level":"warn","ts":1687858244.802444,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"error","ts":1687858244.940904,"caller":"app/app.go:44","msg":"ERR_INIT_REPOSITORY","error":"migration failed: insert or update on table \"stores\" violates foreign key constraint \"stores_city_id_fkey\", Key (city_id)=(943fe9cf-6918-4d10-b6f5-ee911554017e) is not present in table \"cities\". in line 0: DO $$\n  DECLARE\n    country_id UUID;\n    store_id UUID;\n\n  BEGIN\n    -- EXTENSIONS --\n    CREATE EXTENSION IF NOT EXISTS pgcrypto;\n    \n    -- TABLES --\n    CREATE TABLE IF NOT EXISTS countries (\n        created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n        name        VARCHAR NOT NULL UNIQUE\n    );\n    \n    CREATE TABLE IF NOT EXISTS cities (\n        created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n        country_id  UUID NOT NULL,\n        name        VARCHAR NOT NULL UNIQUE,\n        geocenter   VARCHAR NOT NULL,\n        FOREIGN KEY (country_id) REFERENCES countries (id)\n    );\n    \n    CREATE TABLE IF NOT EXISTS currencies (\n        created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n        country_id  UUID NOT NULL,\n        sign        VARCHAR NOT NULL UNIQUE,\n        decimals    INTEGER NOT NULL,\n        prefix      BOOLEAN NOT NULL DEFAULT FALSE,\n        FOREIGN KEY (country_id) REFERENCES countries (id)\n    );\n    \n    \n    CREATE TABLE IF NOT EXISTS stores (\n        created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n        merchant_id VARCHAR NOT NULL,\n        city_id     UUID NOT NULL,\n        name        VARCHAR NOT NULL,\n        address     VARCHAR NOT NULL,\n        location    VARCHAR NOT NULL,\n        rating      NUMERIC NOT NULL DEFAULT 0,\n        is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n        FOREIGN KEY (city_id) REFERENCES cities (id)\n    \n    );\n    \n    CREATE TABLE IF NOT EXISTS schedules (\n        created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n        store_id    UUID NOT NULL UNIQUE,\n        periods     JSONB NOT NULL,\n        is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n        FOREIGN KEY (store_id) REFERENCES stores (id)\n    );\n    \n    CREATE TABLE IF NOT EXISTS deliveries (\n        created_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        updated_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        id          UUID PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),\n        store_id    UUID NOT NULL UNIQUE,\n        periods     JSONB NOT NULL,\n        areas       JSONB NOT NULL,\n        is_active   BOOLEAN NOT NULL DEFAULT FALSE,\n        FOREIGN KEY (store_id) REFERENCES stores (id)\n    );\n    \n    -- DATA --\n    INSERT INTO countries (name)\n    VALUES ('Kazakhstan')\n    RETURNING id INTO country_id;\n    \n    INSERT INTO cities (country_id, name, geocenter)\n    VALUES (country_id, 'Almaty', '43.238949, 76.889709');\n    \n    INSERT INTO currencies (country_id, sign, decimals, prefix)\n    VALUES (country_id, '₸', 0, FALSE);\n\n\n    INSERT INTO stores (merchant_id, city_id, name, address, location, rating, is_active)\n    VALUES ('943fe9cf-6918-4d10-b6f5-ee911554017e', '943fe9cf-6918-4d10-b6f5-ee911554017e', 'My Store', '123 Main St', '43.238949, 76.889709', 0, TRUE)\n    RETURNING id INTO store_id;\n\n    INSERT INTO schedules (store_id, periods, is_active)\n    VALUES (store_id, '[{\"day\":\"Monday\",\"start_time\":\"10:00\",\"end_time\":\"23:00\"}]', true);\n\n    INSERT INTO deliveries (store_id, periods, areas, is_active)\n    VALUES (store_id, '[{\"day\":\"Monday\",\"start_time\":\"10:00\",\"end_time\":\"23:00\"}]', '43.23, 76.889', true);\n\n  \n  COMMIT;\nEND $$; (details: pq: insert or update on table \"stores\" violates foreign key constraint \"stores_city_id_fkey\")","stacktrace":"warehouse-service/internal/app.Run\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/internal/app/app.go:44\nmain.main\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/main.go:8\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:250"}
{"level":"warn","ts":1687858707.905636,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"error","ts":1687858708.002614,"caller":"app/app.go:44","msg":"ERR_INIT_REPOSITORY","error":"Dirty database version 1. Fix and force version.","stacktrace":"warehouse-service/internal/app.Run\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/internal/app/app.go:44\nmain.main\n\t/Users/rakhmet_zhanserik/Projects/warehouse-service/main.go:8\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:250"}
{"level":"warn","ts":1687858719.510731,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"info","ts":1687858719.655288,"caller":"server/server.go:47","msg":"http server started on http://localhost:80"}
{"level":"warn","ts":1687858790.450277,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"info","ts":1687858790.518768,"caller":"server/server.go:47","msg":"http server started on http://localhost:80"}
{"level":"warn","ts":1687859515.559297,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"info","ts":1687859515.70648,"caller":"server/server.go:47","msg":"http server started on http://localhost:80"}
{"level":"warn","ts":1687859668.425545,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"info","ts":1687859668.5185301,"caller":"server/server.go:47","msg":"http server started on http://localhost:80"}
{"level":"warn","ts":1687859777.143032,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"info","ts":1687859777.222909,"caller":"server/server.go:47","msg":"http server started on http://localhost:80"}
{"level":"warn","ts":1687859847.393939,"caller":"log/log.go:37","msg":"Logger sync fail","error":"sync /dev/stdout: inappropriate ioctl for device"}
{"level":"info","ts":1687859847.4692621,"caller":"server/server.go:47","msg":"http server started on http://localhost:80"}
